<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>leetcode-355 - Design Twitter | 記事本</title>
<meta name=keywords content="Heap (Priority Queue),Design,Linked List,Hash Table"><meta name=description content="動機
原本以為很複雜，結果異常的簡單"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2021/08/leetcode-355-design-twitter/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="leetcode-355 - Design Twitter"><meta property="og:description" content="動機
原本以為很複雜，結果異常的簡單"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2021/08/leetcode-355-design-twitter/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-10T19:54:40+00:00"><meta property="article:modified_time" content="2021-08-10T19:54:40+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="leetcode-355 - Design Twitter"><meta name=twitter:description content="動機
原本以為很複雜，結果異常的簡單"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"leetcode-355 - Design Twitter","item":"https://littlebees.github.io/2021/08/leetcode-355-design-twitter/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"leetcode-355 - Design Twitter","name":"leetcode-355 - Design Twitter","description":"動機 原本以為很複雜，結果異常的簡單\n","keywords":["Heap (Priority Queue)","Design","Linked List","Hash Table"],"articleBody":"動機 原本以為很複雜，結果異常的簡單\nProblem Design a simplified version of Twitter where users can post tweets, follow/unfollow another user, and is able to see the 10 most recent tweets in the user's news feed.\nImplement the Twitter class:\ntTwitter() Initializes your twitter object.tvoid postTweet(int userId, int tweetId) Composes a new tweet with ID tweetId by the user userId. Each call to this function will be made with a unique tweetId.tList getNewsFeed(int userId) Retrieves the 10 most recent tweet IDs in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user themself. Tweets must be ordered from most recent to least recent.tvoid follow(int followerId, int followeeId) The user with ID followerId started following the user with ID followeeId.tvoid unfollow(int followerId, int followeeId) The user with ID followerId started unfollowing the user with ID followeeId. Example 1:\nInput[\"Twitter\", \"postTweet\", \"getNewsFeed\", \"follow\", \"postTweet\", \"getNewsFeed\", \"unfollow\", \"getNewsFeed\"][[], [1, 5], [1], [1, 2], [2, 6], [1], [1, 2], [1]]Output[Algorithm, Leetcode, null, [5], null, null, [6, 5], null, [5]]ExplanationTwitter twitter = new Twitter();twitter.postTweet(1, 5); // User 1 posts a new tweet (id = 5).twitter.getNewsFeed(1); // User 1's news feed should return a list with 1 tweet id -\u003e [5]. return [5]twitter.follow(1, 2); // User 1 follows user 2.twitter.postTweet(2, 6); // User 2 posts a new tweet (id = 6).twitter.getNewsFeed(1); // User 1's news feed should return a list with 2 tweet ids -\u003e [6, 5]. Tweet id 6 should precede tweet id 5 because it is posted after tweet id 5.twitter.unfollow(1, 2); // User 1 unfollows user 2.twitter.getNewsFeed(1); // User 1's news feed should return a list with 1 tweet id -\u003e [5], since user 1 is no longer following user 2. Constraints:\nt1 \u003c= userId, followerId, followeeId \u003c= 500t0 \u003c= tweetId \u003c= 104tAll the tweets have unique IDs.tAt most 3 * 104 calls will be made to postTweet, getNewsFeed, follow, and unfollow. Sol from sortedcontainers import SortedList class Twitter: def __init__(self): self.u2ps = defaultdict(list) self.u2us = defaultdict(set) self.tick = 10000 def getUser(self,userId): if userId not in self.u2us: self.u2us[userId].add(userId) return userId def postTweet(self, userId: int, tweetId: int) -\u003e None: self.u2ps[self.getUser(userId)].append((self.tick, tweetId)) self.tick -= 1 def getNewsFeed(self, userId: int) -\u003e List[int]: hq = SortedList() for u in self.u2us[userId]: u = self.u2ps[u] [hq.add(x) for x in u[max(len(u)-10,0):]] return [p[1] for p in hq[:10]] def follow(self, followerId: int, followeeId: int) -\u003e None: self.u2us[self.getUser(followerId)].add(self.getUser(followeeId)) def unfollow(self, followerId: int, followeeId: int) -\u003e None: self.u2us[self.getUser(followerId)].discard(self.getUser(followeeId)) ","wordCount":"404","inLanguage":"en","datePublished":"2021-08-10T19:54:40Z","dateModified":"2021-08-10T19:54:40Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2021/08/leetcode-355-design-twitter/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">leetcode-355 - Design Twitter</h1><div class=post-meta><span title='2021-08-10 19:54:40 +0000 UTC'>August 10, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%8b%95%e6%a9%9f aria-label=動機>動機</a></li><li><a href=#problem aria-label=Problem>Problem</a></li><li><a href=#sol aria-label=Sol>Sol</a></li></ul></div></details></div><div class=post-content><h2 id=動機>動機<a hidden class=anchor aria-hidden=true href=#動機>#</a></h2><p>原本以為很複雜，結果異常的簡單</p><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>Design a simplified version of Twitter where users can post tweets, follow/unfollow another user, and is able to see the <code>10</code> most recent tweets in the user's news feed.</p><p>Implement the <code>Twitter</code> class:</p><ul>t<li><code>Twitter()</code> Initializes your twitter object.</li>t<li><code>void postTweet(int userId, int tweetId)</code> Composes a new tweet with ID <code>tweetId</code> by the user <code>userId</code>. Each call to this function will be made with a unique <code>tweetId</code>.</li>t<li><code>List<integer> getNewsFeed(int userId)</code> Retrieves the <code>10</code> most recent tweet IDs in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user themself. Tweets must be <strong>ordered from most recent to least recent</strong>.</li>t<li><code>void follow(int followerId, int followeeId)</code> The user with ID <code>followerId</code> started following the user with ID <code>followeeId</code>.</li>t<li><code>void unfollow(int followerId, int followeeId)</code> The user with ID <code>followerId</code> started unfollowing the user with ID <code>followeeId</code>.</li></ul><p> </p><p><strong>Example 1:</strong></p><pre><strong>Input</strong>["Twitter", "postTweet", "getNewsFeed", "follow", "postTweet", "getNewsFeed", "unfollow", "getNewsFeed"][[], [1, 5], [1], [1, 2], [2, 6], [1], [1, 2], [1]]<strong>Output</strong>[Algorithm, Leetcode, null, [5], null, null, [6, 5], null, [5]]<strong>Explanation</strong>Twitter twitter = new Twitter();twitter.postTweet(1, 5); // User 1 posts a new tweet (id = 5).twitter.getNewsFeed(1);  // User 1's news feed should return a list with 1 tweet id -> [5]. return [5]twitter.follow(1, 2);    // User 1 follows user 2.twitter.postTweet(2, 6); // User 2 posts a new tweet (id = 6).twitter.getNewsFeed(1);  // User 1's news feed should return a list with 2 tweet ids -> [6, 5]. Tweet id 6 should precede tweet id 5 because it is posted after tweet id 5.twitter.unfollow(1, 2);  // User 1 unfollows user 2.twitter.getNewsFeed(1);  // User 1's news feed should return a list with 1 tweet id -> [5], since user 1 is no longer following user 2.</pre><p> </p><p><strong>Constraints:</strong></p><ul>t<li><code>1 <= userId, followerId, followeeId <= 500</code></li>t<li><code>0 <= tweetId <= 10<sup>4</sup></code></li>t<li>All the tweets have <strong>unique</strong> IDs.</li>t<li>At most <code>3 * 10<sup>4</sup></code> calls will be made to <code>postTweet</code>, <code>getNewsFeed</code>, <code>follow</code>, and <code>unfollow</code>.</li></ul><h2 id=sol>Sol<a hidden class=anchor aria-hidden=true href=#sol>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sortedcontainers</span> <span class=kn>import</span> <span class=n>SortedList</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Twitter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>u2ps</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>u2us</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tick</span> <span class=o>=</span> <span class=mi>10000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getUser</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>userId</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>userId</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>u2us</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>u2us</span><span class=p>[</span><span class=n>userId</span><span class=p>]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>userId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>userId</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>postTweet</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>userId</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>tweetId</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>u2ps</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>getUser</span><span class=p>(</span><span class=n>userId</span><span class=p>)]</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=bp>self</span><span class=o>.</span><span class=n>tick</span><span class=p>,</span> <span class=n>tweetId</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tick</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getNewsFeed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>userId</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>hq</span> <span class=o>=</span> <span class=n>SortedList</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>u</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>u2us</span><span class=p>[</span><span class=n>userId</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>u</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>u2ps</span><span class=p>[</span><span class=n>u</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=n>hq</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>u</span><span class=p>[</span><span class=nb>max</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>u</span><span class=p>)</span><span class=o>-</span><span class=mi>10</span><span class=p>,</span><span class=mi>0</span><span class=p>):]]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>hq</span><span class=p>[:</span><span class=mi>10</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>follow</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>followerId</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>followeeId</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>u2us</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>getUser</span><span class=p>(</span><span class=n>followerId</span><span class=p>)]</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>getUser</span><span class=p>(</span><span class=n>followeeId</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>unfollow</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>followerId</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>followeeId</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>u2us</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>getUser</span><span class=p>(</span><span class=n>followerId</span><span class=p>)]</span><span class=o>.</span><span class=n>discard</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>getUser</span><span class=p>(</span><span class=n>followeeId</span><span class=p>))</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/heap-priority-queue/>Heap (Priority Queue)</a></li><li><a href=https://littlebees.github.io/tags/design/>Design</a></li><li><a href=https://littlebees.github.io/tags/linked-list/>Linked List</a></li><li><a href=https://littlebees.github.io/tags/hash-table/>Hash Table</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2021/08/leetcode-525-contiguous-array/><span class=title>« Prev</span><br><span>leetcode-525 - Contiguous Array</span>
</a><a class=next href=https://littlebees.github.io/2021/08/leetcode-501-find-mode-in-binary-search-tree/><span class=title>Next »</span><br><span>leetcode-501 - Find Mode in Binary Search Tree</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>