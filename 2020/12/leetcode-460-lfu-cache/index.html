<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>leetcode-460 - LFU Cache | 記事本</title>
<meta name=keywords content="Doubly-Linked List,Design,Linked List,Hash Table,Top Interview Questions,Top 100 Liked Questions,CTCI-COMPLETE-LIST"><meta name=description content="動機
兩題很像，所以就一起寫"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2020/12/leetcode-460-lfu-cache/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="leetcode-460 - LFU Cache"><meta property="og:description" content="動機
兩題很像，所以就一起寫"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2020/12/leetcode-460-lfu-cache/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-12-28T01:48:56+00:00"><meta property="article:modified_time" content="2020-12-28T01:48:56+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="leetcode-460 - LFU Cache"><meta name=twitter:description content="動機
兩題很像，所以就一起寫"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"leetcode-460 - LFU Cache","item":"https://littlebees.github.io/2020/12/leetcode-460-lfu-cache/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"leetcode-460 - LFU Cache","name":"leetcode-460 - LFU Cache","description":"動機 兩題很像，所以就一起寫\n","keywords":["Doubly-Linked List","Design","Linked List","Hash Table","Top Interview Questions","Top 100 Liked Questions","CTCI-COMPLETE-LIST"],"articleBody":"動機 兩題很像，所以就一起寫\nProblem Design and implement a data structure for a Least Frequently Used (LFU) cache.\nImplement the LFUCache class:\nLFUCache(int capacity) Initializes the object with the capacity of the data structure.int get(int key) Gets the value of the key if the key exists in the cache. Otherwise, returns -1.void put(int key, int value) Update the value of the key if present, or inserts the key if not already present. When the cache reaches its capacity, it should invalidate and remove the least frequently used key before inserting a new item. For this problem, when there is a tie (i.e., two or more keys with the same frequency), the least recently used key would be invalidated.To determine the least frequently used key, a use counter is maintained for each key in the cache. The key with the smallest use counter is the least frequently used key.\nWhen a key is first inserted into the cache, its use counter is set to 1 (due to the put operation). The use counter for a key in the cache is incremented either a get or put operation is called on it.\nThe functions get and put must each run in O(1) average time complexity.\nExample 1:\nInput[LFUCache, put, put, get, put, get, get, put, get, get, get][[2], [1, 1], [2, 2], [1], [3, 3], [2], [3], [4, 4], [1], [3], [4]]Output[null, null, null, 1, null, -1, 3, null, -1, 3, 4]Explanation// cnt(x) = the use counter for key x// cache=[] will show the last used order for tiebreakers (leftmost element is most recent)LFUCache lfu = new LFUCache(2);lfu.put(1, 1); // cache=[1,_], cnt(1)=1lfu.put(2, 2); // cache=[2,1], cnt(2)=1, cnt(1)=1lfu.get(1); // return 1 // cache=[1,2], cnt(2)=1, cnt(1)=2lfu.put(3, 3); // 2 is the LFU key because cnt(2)=1 is the smallest, invalidate 2. // cache=[3,1], cnt(3)=1, cnt(1)=2lfu.get(2); // return -1 (not found)lfu.get(3); // return 3 // cache=[3,1], cnt(3)=2, cnt(1)=2lfu.put(4, 4); // Both 1 and 3 have the same cnt, but 1 is LRU, invalidate 1. // cache=[4,3], cnt(4)=1, cnt(3)=2lfu.get(1); // return -1 (not found)lfu.get(3); // return 3 // cache=[3,4], cnt(4)=1, cnt(3)=3lfu.get(4); // return 4 // cache=[3,4], cnt(4)=2, cnt(3)=3 Constraints:\n0 \u003c= capacity \u003c= 1040 \u003c= key \u003c= 1050 \u003c= value \u003c= 109At most 2 * 105 calls will be made to get and put. 460 LFU Cache 與146不同的是要想辦法記錄每個key的頻率，一定要嘛? 因為當頻率一樣時要變成LRU。\n這樣不能像146把所有key放在list中，所以用map紀錄次數，把key放到對應的list中。\n為了驅逐的速度上去，最後就是記下如果滿了的話，要驅逐哪一個次數的list的最後一個key\nclass LFUCache { private: unordered_map\u003cint,list\u003cint\u003e\u003e l; int c; unordered_map\u003cint, tuple\u003clist\u003cint\u003e::iterator, int, int\u003e\u003e m; // iter, value, times int last_frq = 1; public: // new empty list tuple\u003clist\u003cint\u003e::iterator, int, int\u003e\u0026 moveToTop(int key) { auto\u0026 tmp = m[key]; l[std::get\u003c2\u003e(tmp)].erase(std::get\u003c0\u003e(tmp)); l[std::get\u003c2\u003e(tmp)+1].push_front(key); if (l[std::get\u003c2\u003e(tmp)].empty() \u0026\u0026 last_frq == std::get\u003c2\u003e(tmp)) last_frq = std::get\u003c2\u003e(tmp)+1; auto ret = make_tuple(l[std::get\u003c2\u003e(tmp)+1].begin(), std::get\u003c1\u003e(tmp),std::get\u003c2\u003e(tmp)+1); m[key] = ret; return m[key]; } LFUCache(int capacity): c(capacity) { } int get(int key) { auto tmp = m.find(key); if(tmp != m.end()) { auto\u0026 tmp = moveToTop(key); return std::get\u003c1\u003e(tmp); } else { return -1; } } void put(int key, int value) { auto exist = m.find(key); if (exist != m.end()) { auto\u0026 tmp = moveToTop(key); m[key] = make_tuple(std::get\u003c0\u003e(tmp), value, std::get\u003c2\u003e(tmp)); } else { if(m.size() \u003e= c \u0026\u0026 m.size() \u003e 0) { int evict = l[last_frq].back(); m.erase(evict); l[last_frq].pop_back(); if (l[last_frq].empty()) { l.erase(last_frq); last_frq = l.begin()-\u003efirst; } //cout\u003c\u003c \"evict: \" \u003c\u003c evict \u003c\u003c'\\n'; } if (m.size() \u003c c) { l[1]; l[1].push_front(key); m[key] = make_tuple(l[1].begin(),value, 1); last_frq = 1; } } } }; ","wordCount":"544","inLanguage":"en","datePublished":"2020-12-28T01:48:56Z","dateModified":"2020-12-28T01:48:56Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2020/12/leetcode-460-lfu-cache/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">leetcode-460 - LFU Cache</h1><div class=post-meta><span title='2020-12-28 01:48:56 +0000 UTC'>December 28, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%8b%95%e6%a9%9f aria-label=動機>動機</a></li><li><a href=#problem aria-label=Problem>Problem</a></li><li><a href=#460-lfu-cache aria-label="460 LFU Cache">460 LFU Cache</a></li></ul></div></details></div><div class=post-content><h2 id=動機>動機<a hidden class=anchor aria-hidden=true href=#動機>#</a></h2><p>兩題很像，所以就一起寫</p><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>Design and implement a data structure for a <a href=https://en.wikipedia.org/wiki/Least_frequently_used target=_blank>Least Frequently Used (LFU)</a> cache.</p><p>Implement the <code>LFUCache</code> class:</p><ul><li><code>LFUCache(int capacity)</code> Initializes the object with the <code>capacity</code> of the data structure.</li><li><code>int get(int key)</code> Gets the value of the <code>key</code> if the <code>key</code> exists in the cache. Otherwise, returns <code>-1</code>.</li><li><code>void put(int key, int value)</code> Update the value of the <code>key</code> if present, or inserts the <code>key</code> if not already present. When the cache reaches its <code>capacity</code>, it should invalidate and remove the <strong>least frequently used</strong> key before inserting a new item. For this problem, when there is a <strong>tie</strong> (i.e., two or more keys with the same frequency), the <strong>least recently used</strong> <code>key</code> would be invalidated.</li></ul><p>To determine the least frequently used key, a <strong>use counter</strong> is maintained for each key in the cache. The key with the smallest <strong>use counter</strong> is the least frequently used key.</p><p>When a key is first inserted into the cache, its <strong>use counter</strong> is set to <code>1</code> (due to the <code>put</code> operation). The <strong>use counter</strong> for a key in the cache is incremented either a <code>get</code> or <code>put</code> operation is called on it.</p><p>The functions <code data-stringify-type=code>get</code> and <code data-stringify-type=code>put</code> must each run in <code>O(1)</code> average time complexity.</p><p> </p><p><strong>Example 1:</strong></p><pre><strong>Input</strong>[LFUCache, put, put, get, put, get, get, put, get, get, get][[2], [1, 1], [2, 2], [1], [3, 3], [2], [3], [4, 4], [1], [3], [4]]<strong>Output</strong>[null, null, null, 1, null, -1, 3, null, -1, 3, 4]<strong>Explanation</strong>// cnt(x) = the use counter for key x// cache=[] will show the last used order for tiebreakers (leftmost element is  most recent)LFUCache lfu = new LFUCache(2);lfu.put(1, 1);   // cache=[1,_], cnt(1)=1lfu.put(2, 2);   // cache=[2,1], cnt(2)=1, cnt(1)=1lfu.get(1);      // return 1                 // cache=[1,2], cnt(2)=1, cnt(1)=2lfu.put(3, 3);   // 2 is the LFU key because cnt(2)=1 is the smallest, invalidate 2.                 // cache=[3,1], cnt(3)=1, cnt(1)=2lfu.get(2);      // return -1 (not found)lfu.get(3);      // return 3                 // cache=[3,1], cnt(3)=2, cnt(1)=2lfu.put(4, 4);   // Both 1 and 3 have the same cnt, but 1 is LRU, invalidate 1.                 // cache=[4,3], cnt(4)=1, cnt(3)=2lfu.get(1);      // return -1 (not found)lfu.get(3);      // return 3                 // cache=[3,4], cnt(4)=1, cnt(3)=3lfu.get(4);      // return 4                 // cache=[3,4], cnt(4)=2, cnt(3)=3</pre><p> </p><p><strong>Constraints:</strong></p><ul><li><code>0 <= capacity <= 10<sup>4</sup></code></li><li><code>0 <= key <= 10<sup>5</sup></code></li><li><code>0 <= value <= 10<sup>9</sup></code></li><li>At most <code>2 * 10<sup>5</sup></code> calls will be made to <code>get</code> and <code>put</code>.</li></ul><p> </p><span style=display:none> </span><h2 id=460-lfu-cache>460 LFU Cache<a hidden class=anchor aria-hidden=true href=#460-lfu-cache>#</a></h2><p>與146不同的是要想辦法記錄每個key的頻率，一定要嘛?
因為當頻率一樣時要變成LRU。</p><p>這樣不能像146把所有key放在list中，所以用map紀錄次數，把key放到對應的list中。</p><p>為了驅逐的速度上去，最後就是記下如果滿了的話，要驅逐哪一個次數的list的最後一個key</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>LFUCache</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=n>list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>l</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=n>tuple</span><span class=o>&lt;</span><span class=n>list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;::</span><span class=n>iterator</span><span class=p>,</span> <span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&gt;</span> <span class=n>m</span><span class=p>;</span> <span class=c1>// iter, value, times
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>last_frq</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=c1>// new empty list
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>tuple</span><span class=o>&lt;</span><span class=n>list</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;::</span><span class=n>iterator</span><span class=p>,</span> <span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;&amp;</span> <span class=n>moveToTop</span><span class=p>(</span><span class=kt>int</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span><span class=o>&amp;</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>m</span><span class=p>[</span><span class=n>key</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span><span class=p>[</span><span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>)].</span><span class=n>erase</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>0</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=n>l</span><span class=p>[</span><span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>].</span><span class=n>push_front</span><span class=p>(</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>l</span><span class=p>[</span><span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>)].</span><span class=n>empty</span><span class=p>()</span> <span class=o>&amp;&amp;</span> <span class=n>last_frq</span> <span class=o>==</span> <span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>last_frq</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=n>ret</span> <span class=o>=</span> <span class=n>make_tuple</span><span class=p>(</span><span class=n>l</span><span class=p>[</span><span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span> <span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>1</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>),</span><span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>m</span><span class=p>[</span><span class=n>key</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>LFUCache</span><span class=p>(</span><span class=kt>int</span> <span class=n>capacity</span><span class=p>)</span><span class=o>:</span> <span class=n>c</span><span class=p>(</span><span class=n>capacity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>get</span><span class=p>(</span><span class=kt>int</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>m</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>tmp</span> <span class=o>!=</span> <span class=n>m</span><span class=p>.</span><span class=n>end</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>auto</span><span class=o>&amp;</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>moveToTop</span><span class=p>(</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>1</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>put</span><span class=p>(</span><span class=kt>int</span> <span class=n>key</span><span class=p>,</span> <span class=kt>int</span> <span class=n>value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>auto</span> <span class=n>exist</span> <span class=o>=</span> <span class=n>m</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>exist</span> <span class=o>!=</span> <span class=n>m</span><span class=p>.</span><span class=n>end</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>auto</span><span class=o>&amp;</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>moveToTop</span><span class=p>(</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>m</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>make_tuple</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>0</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>),</span> <span class=n>value</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>get</span><span class=o>&lt;</span><span class=mi>2</span><span class=o>&gt;</span><span class=p>(</span><span class=n>tmp</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>m</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&gt;=</span> <span class=n>c</span> <span class=o>&amp;&amp;</span> <span class=n>m</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kt>int</span> <span class=n>evict</span> <span class=o>=</span> <span class=n>l</span><span class=p>[</span><span class=n>last_frq</span><span class=p>].</span><span class=n>back</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>m</span><span class=p>.</span><span class=n>erase</span><span class=p>(</span><span class=n>evict</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>l</span><span class=p>[</span><span class=n>last_frq</span><span class=p>].</span><span class=n>pop_back</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>l</span><span class=p>[</span><span class=n>last_frq</span><span class=p>].</span><span class=n>empty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>l</span><span class=p>.</span><span class=n>erase</span><span class=p>(</span><span class=n>last_frq</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=n>last_frq</span> <span class=o>=</span> <span class=n>l</span><span class=p>.</span><span class=n>begin</span><span class=p>()</span><span class=o>-&gt;</span><span class=n>first</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=c1>//cout&lt;&lt; &#34;evict: &#34; &lt;&lt; evict &lt;&lt;&#39;\n&#39;;
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>m</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&lt;</span> <span class=n>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>l</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=n>l</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>push_front</span><span class=p>(</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>m</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>make_tuple</span><span class=p>(</span><span class=n>l</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span><span class=n>value</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=n>last_frq</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/doubly-linked-list/>Doubly-Linked List</a></li><li><a href=https://littlebees.github.io/tags/design/>Design</a></li><li><a href=https://littlebees.github.io/tags/linked-list/>Linked List</a></li><li><a href=https://littlebees.github.io/tags/hash-table/>Hash Table</a></li><li><a href=https://littlebees.github.io/tags/top-interview-questions/>Top Interview Questions</a></li><li><a href=https://littlebees.github.io/tags/top-100-liked-questions/>Top 100 Liked Questions</a></li><li><a href=https://littlebees.github.io/tags/ctci-complete-list/>CTCI-COMPLETE-LIST</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2020/12/leetcode-146-lru-cache/><span class=title>« Prev</span><br><span>leetcode-146 - LRU Cache</span>
</a><a class=next href=https://littlebees.github.io/2020/12/cpp%E7%9A%84value-categories/><span class=title>Next »</span><br><span>cpp的Value Categories</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>