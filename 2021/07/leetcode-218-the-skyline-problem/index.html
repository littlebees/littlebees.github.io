<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>leetcode-218 - The Skyline Problem | 記事本</title>
<meta name=keywords content="Ordered Set,Heap (Priority Queue),Line Sweep,Segment Tree,Binary Indexed Tree,Divide and Conquer,Array,Top Interview Questions"><meta name=description content="動機
被這題搞了兩天，所以要記錄下來
以前沒有看線段合併的Divide and Conquer，所以要記錄下來 (還債)
以前沒有看Segment tree，所以要記錄下來 (還債)"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2021/07/leetcode-218-the-skyline-problem/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="leetcode-218 - The Skyline Problem"><meta property="og:description" content="動機
被這題搞了兩天，所以要記錄下來
以前沒有看線段合併的Divide and Conquer，所以要記錄下來 (還債)
以前沒有看Segment tree，所以要記錄下來 (還債)"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2021/07/leetcode-218-the-skyline-problem/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-28T19:27:53+00:00"><meta property="article:modified_time" content="2021-07-28T19:27:53+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="leetcode-218 - The Skyline Problem"><meta name=twitter:description content="動機
被這題搞了兩天，所以要記錄下來
以前沒有看線段合併的Divide and Conquer，所以要記錄下來 (還債)
以前沒有看Segment tree，所以要記錄下來 (還債)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"leetcode-218 - The Skyline Problem","item":"https://littlebees.github.io/2021/07/leetcode-218-the-skyline-problem/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"leetcode-218 - The Skyline Problem","name":"leetcode-218 - The Skyline Problem","description":"動機 被這題搞了兩天，所以要記錄下來 以前沒有看線段合併的Divide and Conquer，所以要記錄下來 (還債) 以前沒有看Segment tree，所以要記錄下來 (還債)\n","keywords":["Ordered Set","Heap (Priority Queue)","Line Sweep","Segment Tree","Binary Indexed Tree","Divide and Conquer","Array","Top Interview Questions"],"articleBody":"動機 被這題搞了兩天，所以要記錄下來 以前沒有看線段合併的Divide and Conquer，所以要記錄下來 (還債) 以前沒有看Segment tree，所以要記錄下來 (還債)\nProblem A city's skyline is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance. Given the locations and heights of all the buildings, return the skyline formed by these buildings collectively.\nThe geometric information of each building is given in the array buildings where buildings[i] = [lefti, righti, heighti]:\nlefti is the x coordinate of the left edge of the ith building.righti is the x coordinate of the right edge of the ith building.heighti is the height of the ith building.You may assume all buildings are perfect rectangles grounded on an absolutely flat surface at height 0.\nThe skyline should be represented as a list of key points sorted by their x-coordinate in the form [[x1,y1],[x2,y2],...]. Each key point is the left endpoint of some horizontal segment in the skyline except the last point in the list, which always has a y-coordinate 0 and is used to mark the skyline's termination where the rightmost building ends. Any ground between the leftmost and rightmost buildings should be part of the skyline's contour.\nNote: There must be no consecutive horizontal lines of equal height in the output skyline. For instance, [...,[2 3],[4 5],[7 5],[11 5],[12 7],...] is not acceptable; the three lines of height 5 should be merged into one in the final output as such: [...,[2 3],[4 5],[12 7],...]\nExample 1:\nInput: buildings = [[2,9,10],[3,7,15],[5,12,12],[15,20,10],[19,24,8]]Output: [[2,10],[3,15],[7,12],[12,0],[15,10],[20,8],[24,0]]Explanation:Figure A shows the buildings of the input.Figure B shows the skyline formed by those buildings. The red points in figure B represent the key points in the output list.Example 2:\nInput: buildings = [[0,2,3],[2,5,3]]Output: [[0,3],[5,0]] Constraints:\n1 \u003c= buildings.length \u003c= 1040 \u003c= lefti \u003c righti \u003c= 231 - 11 \u003c= heighti \u003c= 231 - 1buildings is sorted by lefti in non-decreasing order. Ver1: Stack (many WA) def retAppend(ret,p): #if not ret or ret[-1][1] != p[1]: ret.append(p) def fg(stk,ret,b): # (stk,b) -\u003e stk,ret print(b) print(ret,stk) if not stk: retAppend(ret,[b[0],b[2]]) # raise stk.append(b) return [stk,ret] else: now = stk[-1] if b[0] == now[0] and b[1] == now[1]: # same seg if b[2] \u003e now[2]: stk.pop() stk.append(b) return [stk,ret] else: return [stk,ret] elif b[0] \u003c now[1] and b[1] \u003c= now[1]: # whole seg in roof if b[2] \u003e now[2]: retAppend(ret,[b[0],b[2]]) # raise a = stk.pop() stk.append([b[1],a[1],a[2]]) stk.append(b) return [stk,ret] else: return [stk,ret] elif b[0] \u003c now[1] and now[1] \u003c b[1]: # part of seg in roof if b[2] \u003e now[2]: retAppend(ret,[b[0],b[2]]) stk.pop() stk.append(b) return [stk,ret] elif b[2] == now[2]: tmp = stk.pop() stk.append([tmp[0],b[1],b[2]]) return [stk,ret] else: tmp = stk.pop() a = [tmp[1],b[1],b[2]] return fg(stk,ret,a) elif b[0] == now[1]: # touch print(now,b,[now[1],now[2]]) if b[2] \u003e now[2]: retAppend(ret,[b[0],b[2]]) # raise elif b[2] \u003c now[2]: retAppend(ret,[now[1],b[2]]) # fall stk.pop() stk.append(b) return [stk,ret] else: # seperate tmp = stk.pop() retAppend(ret,[tmp[1],0 if not stk else stk[-1][2]]) # fall return fg(stk,ret,b) class Solution: def getSkyline(self, bs: List[List[int]]) -\u003e List[List[int]]: if not bs: return [] stk = [] ret = [] bs.sort(key=lambda b: (b[0],-b[2],b[1])) #print(bs) for b in bs: stk, ret = fg(stk,ret,b) retAppend(ret,[stk[-1][1],0]) return ret Ver2: Divide and Conquer (AC) def div(bs,i,j): if i == j: return [[bs[i][0],bs[i][2]], [bs[i][1],0]] else: mid = (j+i)//2 return merge(div(bs,i,mid), div(bs,mid+1,j)) def merge(a,b): ret = [] i = 0 j = 0 h = 0 h1 = 0 h2 = 0 while i \u003c len(a) or j \u003c len(b): if i \u003c len(a) and j \u003c len(b): cur = None if a[i][0] \u003c b[j][0]: cur = a[i][0] h1 = a[i][1] i+=1 elif a[i][0] \u003e b[j][0]: cur = b[j][0] h2 = b[j][1] j+=1 else: cur = b[j][0] h1 = a[i][1] h2 = b[j][1] i += 1 j += 1 h = max(h1,h2) if not ret or ret[-1][1] != h: ret.append([cur, h]) elif i \u003c len(a): ret += a[i:] break else: ret += b[j:] break return ret class Solution: def getSkyline(self, bs: List[List[int]]) -\u003e List[List[int]]: if not bs: return [] else: return div(bs,0,len(bs)-1) Ver3: heap \u0026 Sweep Line (AC) from heapq import * def f(poses): hq = [] ret = [] for p in poses: if not hq or p[1] \u003c 0: # start seg heappush(hq,p[1]) else: # end seg hq.pop(hq.index(-p[1])) heapify(hq) if not hq: ret.append([p[0],0]) else: if not ret: ret.append([p[0],-hq[0]]) else: if ret[-1][0] == p[0] and p[1] \u003c 0: # tete if ret[-1][1] \u003c -p[1]: ret[-1][1] = -p[1] else: if ret[-1][1] != -hq[0]: # height changed ret.append([p[0],-hq[0]]) else: pass return ret class Solution: def getSkyline(self, bs: List[List[int]]) -\u003e List[List[int]]: if not bs: return [] else: poses = [] for b in bs: poses.append([b[0],-b[2]]) poses.append([b[1],b[2]]) poses.sort(key= lambda p: (p[0],p[1])) return f(poses) from sortedcontainers import SortedList def f(poses): hq = SortedList() ret = [] for p in poses: if not hq or p[1] \u003c 0: # start seg hq.add(p[1]) else: # end seg del hq[hq.bisect_left(-p[1])] if not hq: ret.append([p[0],0]) else: if not ret: ret.append([p[0],-hq[0]]) else: if ret[-1][0] == p[0] and p[1] \u003c 0: # tete if ret[-1][1] \u003c -p[1]: ret[-1][1] = -p[1] else: if ret[-1][1] != -hq[0]: # height changed ret.append([p[0],-hq[0]]) else: pass return ret class Solution: def getSkyline(self, bs: List[List[int]]) -\u003e List[List[int]]: if not bs: return [] else: poses = [] for b in bs: poses.append([b[0],-b[2]]) poses.append([b[1],b[2]]) poses.sort(key= lambda p: (p[0],p[1])) return f(poses) Ref [翻译]扫描线算法(Line Sweep Algorithm)（1） Chapter9 線段樹與相關結構\n","wordCount":"867","inLanguage":"en","datePublished":"2021-07-28T19:27:53Z","dateModified":"2021-07-28T19:27:53Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2021/07/leetcode-218-the-skyline-problem/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">leetcode-218 - The Skyline Problem</h1><div class=post-meta><span title='2021-07-28 19:27:53 +0000 UTC'>July 28, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%8b%95%e6%a9%9f aria-label=動機>動機</a></li><li><a href=#problem aria-label=Problem>Problem</a></li><li><a href=#ver1-stack-many-wa aria-label="Ver1: Stack (many WA)">Ver1: Stack (many WA)</a></li><li><a href=#ver2-divide-and-conquer-ac aria-label="Ver2: Divide and Conquer (AC)">Ver2: Divide and Conquer (AC)</a></li><li><a href=#ver3-heap--sweep-line-ac aria-label="Ver3: heap & Sweep Line (AC)">Ver3: heap & Sweep Line (AC)</a></li><li><a href=#ref aria-label=Ref>Ref</a></li></ul></div></details></div><div class=post-content><h2 id=動機>動機<a hidden class=anchor aria-hidden=true href=#動機>#</a></h2><p>被這題搞了兩天，所以要記錄下來
以前沒有看線段合併的Divide and Conquer，所以要記錄下來 (還債)
以前沒有看Segment tree，所以要記錄下來 (還債)</p><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>A city's <strong>skyline</strong> is the outer contour of the silhouette formed by all the buildings in that city when viewed from a distance. Given the locations and heights of all the buildings, return <em>the <strong>skyline</strong> formed by these buildings collectively</em>.</p><p>The geometric information of each building is given in the array <code>buildings</code> where <code>buildings[i] = [left<sub>i</sub>, right<sub>i</sub>, height<sub>i</sub>]</code>:</p><ul><li><code>left<sub>i</sub></code> is the x coordinate of the left edge of the <code>i<sup>th</sup></code> building.</li><li><code>right<sub>i</sub></code> is the x coordinate of the right edge of the <code>i<sup>th</sup></code> building.</li><li><code>height<sub>i</sub></code> is the height of the <code>i<sup>th</sup></code> building.</li></ul><p>You may assume all buildings are perfect rectangles grounded on an absolutely flat surface at height <code>0</code>.</p><p>The <strong>skyline</strong> should be represented as a list of key points <strong>sorted by their x-coordinate</strong> in the form <code>[[x<sub>1</sub>,y<sub>1</sub>],[x<sub>2</sub>,y<sub>2</sub>],...]</code>. Each key point is the left endpoint of some horizontal segment in the skyline except the last point in the list, which always has a y-coordinate <code>0</code> and is used to mark the skyline's termination where the rightmost building ends. Any ground between the leftmost and rightmost buildings should be part of the skyline's contour.</p><p><b>Note:</b> There must be no consecutive horizontal lines of equal height in the output skyline. For instance, <code>[...,[2 3],[4 5],[7 5],[11 5],[12 7],...]</code> is not acceptable; the three lines of height 5 should be merged into one in the final output as such: <code>[...,[2 3],[4 5],[12 7],...]</code></p><p> </p><p><strong>Example 1:</strong></p><img alt src=https://assets.leetcode.com/uploads/2020/12/01/merged.jpg style=width:800px;height:331px><pre><strong>Input:</strong> buildings = [[2,9,10],[3,7,15],[5,12,12],[15,20,10],[19,24,8]]<strong>Output:</strong> [[2,10],[3,15],[7,12],[12,0],[15,10],[20,8],[24,0]]<strong>Explanation:</strong>Figure A shows the buildings of the input.Figure B shows the skyline formed by those buildings. The red points in figure B represent the key points in the output list.</pre><p><strong>Example 2:</strong></p><pre><strong>Input:</strong> buildings = [[0,2,3],[2,5,3]]<strong>Output:</strong> [[0,3],[5,0]]</pre><p> </p><p><strong>Constraints:</strong></p><ul><li><code>1 <= buildings.length <= 10<sup>4</sup></code></li><li><code>0 <= left<sub>i</sub> < right<sub>i</sub> <= 2<sup>31</sup> - 1</code></li><li><code>1 <= height<sub>i</sub> <= 2<sup>31</sup> - 1</code></li><li><code>buildings</code> is sorted by <code>left<sub>i</sub></code> in non-decreasing order.</li></ul><h2 id=ver1-stack-many-wa>Ver1: Stack (many WA)<a hidden class=anchor aria-hidden=true href=#ver1-stack-many-wa>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,</span><span class=n>p</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1>#if not ret or ret[-1][1] != p[1]:</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fg</span><span class=p>(</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>,</span><span class=n>b</span><span class=p>):</span> <span class=c1># (stk,b) -&gt; stk,ret</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ret</span><span class=p>,</span><span class=n>stk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>stk</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,[</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span> <span class=c1># raise</span>
</span></span><span class=line><span class=cl>        <span class=n>stk</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>now</span> <span class=o>=</span> <span class=n>stk</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>now</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>and</span> <span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=c1># same seg</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>now</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>stk</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>stk</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=ow>and</span> <span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=c1># whole seg in roof</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>now</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,[</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span> <span class=c1># raise</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span> <span class=o>=</span> <span class=n>stk</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>stk</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>a</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                <span class=n>stk</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=ow>and</span> <span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=c1># part of seg in roof</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>now</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,[</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                <span class=n>stk</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>stk</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=n>now</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>stk</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>stk</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>tmp</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>stk</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=n>tmp</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>fg</span><span class=p>(</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>,</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=c1># touch</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>now</span><span class=p>,</span><span class=n>b</span><span class=p>,[</span><span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>now</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>now</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,[</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span> <span class=c1># raise</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>now</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,[</span><span class=n>now</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span> <span class=c1># fall</span>
</span></span><span class=line><span class=cl>            <span class=n>stk</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>stk</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span> <span class=c1># seperate</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>=</span> <span class=n>stk</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,[</span><span class=n>tmp</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=mi>0</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>stk</span> <span class=k>else</span> <span class=n>stk</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>2</span><span class=p>]])</span> <span class=c1># fall</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>fg</span><span class=p>(</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getSkyline</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>bs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>stk</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>ret</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>bs</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>b</span><span class=p>:</span> <span class=p>(</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>-</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=c1>#print(bs)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>bs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>stk</span><span class=p>,</span> <span class=n>ret</span> <span class=o>=</span> <span class=n>fg</span><span class=p>(</span><span class=n>stk</span><span class=p>,</span><span class=n>ret</span><span class=p>,</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>retAppend</span><span class=p>(</span><span class=n>ret</span><span class=p>,[</span><span class=n>stk</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>],</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>ret</span>
</span></span></code></pre></div><h2 id=ver2-divide-and-conquer-ac>Ver2: Divide and Conquer (AC)<a hidden class=anchor aria-hidden=true href=#ver2-divide-and-conquer-ac>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>div</span><span class=p>(</span><span class=n>bs</span><span class=p>,</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span> <span class=o>==</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[[</span><span class=n>bs</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span><span class=n>bs</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>2</span><span class=p>]],</span> <span class=p>[</span><span class=n>bs</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>],</span><span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>j</span><span class=o>+</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>merge</span><span class=p>(</span><span class=n>div</span><span class=p>(</span><span class=n>bs</span><span class=p>,</span><span class=n>i</span><span class=p>,</span><span class=n>mid</span><span class=p>),</span> <span class=n>div</span><span class=p>(</span><span class=n>bs</span><span class=p>,</span><span class=n>mid</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=n>j</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>merge</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>h</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>h1</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>h2</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=ow>or</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>)</span> <span class=ow>and</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>b</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>cur</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>h1</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>cur</span> <span class=o>=</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>h2</span> <span class=o>=</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>cur</span> <span class=o>=</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>h1</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>h2</span> <span class=o>=</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>h</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>h1</span><span class=p>,</span><span class=n>h2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>ret</span> <span class=ow>or</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=n>h</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>cur</span><span class=p>,</span> <span class=n>h</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>a</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span> <span class=o>+=</span> <span class=n>a</span><span class=p>[</span><span class=n>i</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span> <span class=o>+=</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getSkyline</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>bs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>div</span><span class=p>(</span><span class=n>bs</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>bs</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=ver3-heap--sweep-line-ac>Ver3: heap & Sweep Line (AC)<a hidden class=anchor aria-hidden=true href=#ver3-heap--sweep-line-ac>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>heapq</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>poses</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>hq</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>poses</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>hq</span> <span class=ow>or</span> <span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span> <span class=c1># start seg</span>
</span></span><span class=line><span class=cl>            <span class=n>heappush</span><span class=p>(</span><span class=n>hq</span><span class=p>,</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span> <span class=c1># end seg</span>
</span></span><span class=line><span class=cl>            <span class=n>hq</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>hq</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=o>-</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=n>heapify</span><span class=p>(</span><span class=n>hq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>hq</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>ret</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>-</span><span class=n>hq</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>and</span> <span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span> <span class=c1># tete</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=o>-</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                        <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=o>-</span><span class=n>hq</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span> <span class=c1># height changed</span>
</span></span><span class=line><span class=cl>                        <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>-</span><span class=n>hq</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getSkyline</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>bs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>poses</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>bs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>poses</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>-</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                <span class=n>poses</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>            <span class=n>poses</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span> <span class=k>lambda</span> <span class=n>p</span><span class=p>:</span> <span class=p>(</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>poses</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sortedcontainers</span> <span class=kn>import</span> <span class=n>SortedList</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>poses</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>hq</span> <span class=o>=</span> <span class=n>SortedList</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>poses</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>hq</span> <span class=ow>or</span> <span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span> <span class=c1># start seg</span>
</span></span><span class=line><span class=cl>            <span class=n>hq</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span> <span class=c1># end seg</span>
</span></span><span class=line><span class=cl>            <span class=k>del</span> <span class=n>hq</span><span class=p>[</span><span class=n>hq</span><span class=o>.</span><span class=n>bisect_left</span><span class=p>(</span><span class=o>-</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>hq</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>ret</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>-</span><span class=n>hq</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>and</span> <span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span> <span class=c1># tete</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;</span> <span class=o>-</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                        <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>!=</span> <span class=o>-</span><span class=n>hq</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span> <span class=c1># height changed</span>
</span></span><span class=line><span class=cl>                        <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>-</span><span class=n>hq</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>getSkyline</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>bs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>poses</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>bs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>poses</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=o>-</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>                <span class=n>poses</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=n>b</span><span class=p>[</span><span class=mi>2</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>            <span class=n>poses</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span> <span class=k>lambda</span> <span class=n>p</span><span class=p>:</span> <span class=p>(</span><span class=n>p</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>p</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>poses</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=ref>Ref<a hidden class=anchor aria-hidden=true href=#ref>#</a></h2><p><a href=https://blog.csdn.net/LiRewriter/article/details/77512370>[翻译]扫描线算法(Line Sweep Algorithm)（1）</a>
<a href="http://pisces.ck.tp.edu.tw/~peng/index.php?action=showfile&amp;file=f220f2d6b33ae091978ebf59d2af5908bc8190b51">Chapter9 線段樹與相關結構</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/ordered-set/>Ordered Set</a></li><li><a href=https://littlebees.github.io/tags/heap-priority-queue/>Heap (Priority Queue)</a></li><li><a href=https://littlebees.github.io/tags/line-sweep/>Line Sweep</a></li><li><a href=https://littlebees.github.io/tags/segment-tree/>Segment Tree</a></li><li><a href=https://littlebees.github.io/tags/binary-indexed-tree/>Binary Indexed Tree</a></li><li><a href=https://littlebees.github.io/tags/divide-and-conquer/>Divide and Conquer</a></li><li><a href=https://littlebees.github.io/tags/array/>Array</a></li><li><a href=https://littlebees.github.io/tags/top-interview-questions/>Top Interview Questions</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2021/07/leetcode-1091-shortest-path-in-binary-matrix/><span class=title>« Prev</span><br><span>leetcode-1091 - Shortest Path in Binary Matrix</span>
</a><a class=next href=https://littlebees.github.io/2021/07/leetcode-220-contains-duplicate-iii/><span class=title>Next »</span><br><span>leetcode-220 - Contains Duplicate III</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>