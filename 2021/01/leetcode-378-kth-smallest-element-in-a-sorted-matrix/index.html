<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>leetcode-378 - Kth Smallest Element in a Sorted Matrix | 記事本</title>
<meta name=keywords content="Matrix,Heap (Priority Queue),Sorting,Binary Search,Array,Top 100 Liked Questions,Top Interview Questions,seanprashad"><meta name=description content="動機
原來binary search可以這麼用"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2021/01/leetcode-378-kth-smallest-element-in-a-sorted-matrix/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="leetcode-378 - Kth Smallest Element in a Sorted Matrix"><meta property="og:description" content="動機
原來binary search可以這麼用"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2021/01/leetcode-378-kth-smallest-element-in-a-sorted-matrix/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-02T00:25:45+00:00"><meta property="article:modified_time" content="2021-01-02T00:25:45+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="leetcode-378 - Kth Smallest Element in a Sorted Matrix"><meta name=twitter:description content="動機
原來binary search可以這麼用"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"leetcode-378 - Kth Smallest Element in a Sorted Matrix","item":"https://littlebees.github.io/2021/01/leetcode-378-kth-smallest-element-in-a-sorted-matrix/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"leetcode-378 - Kth Smallest Element in a Sorted Matrix","name":"leetcode-378 - Kth Smallest Element in a Sorted Matrix","description":"動機 原來binary search可以這麼用\n","keywords":["Matrix","Heap (Priority Queue)","Sorting","Binary Search","Array","Top 100 Liked Questions","Top Interview Questions","seanprashad"],"articleBody":"動機 原來binary search可以這麼用\nProblem Given an n x n matrix where each of the rows and columns are sorted in ascending order, return the kth smallest element in the matrix.\nNote that it is the kth smallest element in the sorted order, not the kth distinct element.\nExample 1:\nInput: matrix = [[1,5,9],[10,11,13],[12,13,15]], k = 8Output: 13Explanation: The elements in the matrix are [1,5,9,10,11,12,13,13,15], and the 8th smallest number is 13Example 2:\nInput: matrix = [[-5]], k = 1Output: -5 Constraints:\nn == matrix.lengthn == matrix[i].length1 \u003c= n \u003c= 300-109 \u003c= matrix[i][j] \u003c= 109All the rows and columns of matrix are guaranteed to be sorted in non-decreasing order.1 \u003c= k \u003c= n2 Sol1: divide-and-conquer 當初想說對半折就好，但是這會把應該找的也一起砍掉\ndef g(val): return (val+(0 if val % 2 == 0 else 1))//2 def f(ms,k,i,j,li,lj): #print(k,i,j,li,lj) if k \u003c= 1: return ms[i][j] else: if k \u003e= (li*lj)//2: if li \u003e 1 and lj \u003e 1: if ms[i][j+1] \u003c= ms[i+1][j]: tmp = g(li) k -= min(1,li-tmp)*lj return f(ms, k ,i+li//2 ,j , tmp , lj) else: tmp = g(lj) k -= (lj-tmp)*li return f(ms, k ,i ,j+lj//2 , li, tmp) elif li \u003e 1: tmp = g(li) k -= (li-tmp)*lj return f(ms, k ,i+li//2 ,j , tmp , lj) else: tmp = g(lj) k -= (lj-tmp)*li return f(ms, k ,i ,j+lj//2 , li, tmp) else: if li \u003e 1 and lj \u003e 1: if ms[i][j+1] \u003c= ms[i+1][j]: tmp = g(li) return f(ms, k ,i , j, tmp , lj) else: tmp = g(lj) return f(ms, k ,i , j, li, tmp) elif li \u003e 1: tmp = g(li) return f(ms, k ,i , j, tmp , lj) else: tmp = g(lj) return f(ms, k ,i , j, li, tmp) class Solution: def kthSmallest(self, ms: List[List[int]], k: int) -\u003e int: return f(ms,k,0,0,len(ms),len(ms)) Sol2: binary search + binary search 第一個binary search在matrix的最大與最小的範圍中找個數字，依據數字的排名做二分 第二個binary search在每個row找總共有多少數字小於等於(upper bound)現在猜的數字\ndef count(ms,v): ret = 0 exist = False for m in ms: tmp = bisect.bisect(m,v) ret += tmp if tmp \u003e 0: exist = exist or m[tmp-1] == v return [ret, exist] def check(k,n,exist): return n\u003e=k and exist class Solution: def kthSmallest(self, ms: List[List[int]], k: int) -\u003e int: i = ms[0][0] j = ms[-1][-1] exist = False while i \u003c j: mid = i + (j-i)//2 tmp, exist = count(ms,mid) if tmp \u003e= k: j = mid else: i = mid+1 return i Sol3: binary search + saddleback 利用saddleback的想法，從左下走\n如果比猜的數字大，往上以及加總這排的小於等於的總數 如果比猜的數字小，往右走\n不過要注意，不要往右走到超過邊界\ndef count(ms,v): ret = 0 i = len(ms)-1 j = 0 while 0 \u003c= i: if j == len(ms) or ms[i][j] \u003e v: ret += j i -= 1 else: j += 1 return ret def check(k,n,exist): return n\u003e=k and exist class Solution: def kthSmallest(self, ms: List[List[int]], k: int) -\u003e int: i = ms[0][0] j = ms[-1][-1] exist = False while i \u003c j: mid = i + (j-i)//2 tmp = count(ms,mid) if tmp \u003e= k: j = mid else: i = mid+1 return i ","wordCount":"482","inLanguage":"en","datePublished":"2021-01-02T00:25:45Z","dateModified":"2021-01-02T00:25:45Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2021/01/leetcode-378-kth-smallest-element-in-a-sorted-matrix/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">leetcode-378 - Kth Smallest Element in a Sorted Matrix</h1><div class=post-meta><span title='2021-01-02 00:25:45 +0000 UTC'>January 2, 2021</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%8b%95%e6%a9%9f aria-label=動機>動機</a></li><li><a href=#problem aria-label=Problem>Problem</a></li><li><a href=#sol1-divide-and-conquer aria-label="Sol1: divide-and-conquer">Sol1: divide-and-conquer</a></li><li><a href=#sol2-binary-search--binary-search aria-label="Sol2: binary search + binary search">Sol2: binary search + binary search</a></li><li><a href=#sol3-binary-search--saddleback aria-label="Sol3: binary search + saddleback">Sol3: binary search + saddleback</a></li></ul></div></details></div><div class=post-content><h2 id=動機>動機<a hidden class=anchor aria-hidden=true href=#動機>#</a></h2><p>原來binary search可以這麼用</p><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>Given an <code>n x n</code> <code>matrix</code> where each of the rows and columns are sorted in ascending order, return <em>the</em> <code>k<sup>th</sup></code> <em>smallest element in the matrix</em>.</p><p>Note that it is the <code>k<sup>th</sup></code> smallest element <strong>in the sorted order</strong>, not the <code>k<sup>th</sup></code> <strong>distinct</strong> element.</p><p> </p><p><strong>Example 1:</strong></p><pre><strong>Input:</strong> matrix = [[1,5,9],[10,11,13],[12,13,15]], k = 8<strong>Output:</strong> 13<strong>Explanation:</strong> The elements in the matrix are [1,5,9,10,11,12,13,<u><strong>13</strong></u>,15], and the 8<sup>th</sup> smallest number is 13</pre><p><strong>Example 2:</strong></p><pre><strong>Input:</strong> matrix = [[-5]], k = 1<strong>Output:</strong> -5</pre><p> </p><p><strong>Constraints:</strong></p><ul><li><code>n == matrix.length</code></li><li><code>n == matrix[i].length</code></li><li><code>1 <= n <= 300</code></li><li><code>-10<sup>9</sup> <= matrix[i][j] <= 10<sup>9</sup></code></li><li>All the rows and columns of <code>matrix</code> are <strong>guaranteed</strong> to be sorted in <strong>non-decreasing order</strong>.</li><li><code>1 <= k <= n<sup>2</sup></code></li></ul><h2 id=sol1-divide-and-conquer>Sol1: divide-and-conquer<a hidden class=anchor aria-hidden=true href=#sol1-divide-and-conquer>#</a></h2><p>當初想說對半折就好，但是這會把應該找的也一起砍掉</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>g</span><span class=p>(</span><span class=n>val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>val</span><span class=o>+</span><span class=p>(</span><span class=mi>0</span> <span class=k>if</span> <span class=n>val</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>1</span><span class=p>))</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span><span class=n>k</span><span class=p>,</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>,</span><span class=n>li</span><span class=p>,</span><span class=n>lj</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1>#print(k,i,j,li,lj)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>ms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>k</span> <span class=o>&gt;=</span> <span class=p>(</span><span class=n>li</span><span class=o>*</span><span class=n>lj</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>li</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>lj</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>ms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>ms</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>li</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>k</span> <span class=o>-=</span> <span class=nb>min</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>li</span><span class=o>-</span><span class=n>tmp</span><span class=p>)</span><span class=o>*</span><span class=n>lj</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span><span class=o>+</span><span class=n>li</span><span class=o>//</span><span class=mi>2</span> <span class=p>,</span><span class=n>j</span> <span class=p>,</span> <span class=n>tmp</span> <span class=p>,</span> <span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>k</span> <span class=o>-=</span> <span class=p>(</span><span class=n>lj</span><span class=o>-</span><span class=n>tmp</span><span class=p>)</span><span class=o>*</span><span class=n>li</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span> <span class=p>,</span><span class=n>j</span><span class=o>+</span><span class=n>lj</span><span class=o>//</span><span class=mi>2</span> <span class=p>,</span> <span class=n>li</span><span class=p>,</span> <span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>li</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>li</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>k</span> <span class=o>-=</span> <span class=p>(</span><span class=n>li</span><span class=o>-</span><span class=n>tmp</span><span class=p>)</span><span class=o>*</span><span class=n>lj</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span><span class=o>+</span><span class=n>li</span><span class=o>//</span><span class=mi>2</span> <span class=p>,</span><span class=n>j</span> <span class=p>,</span> <span class=n>tmp</span> <span class=p>,</span> <span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>k</span> <span class=o>-=</span> <span class=p>(</span><span class=n>lj</span><span class=o>-</span><span class=n>tmp</span><span class=p>)</span><span class=o>*</span><span class=n>li</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span> <span class=p>,</span><span class=n>j</span><span class=o>+</span><span class=n>lj</span><span class=o>//</span><span class=mi>2</span> <span class=p>,</span> <span class=n>li</span><span class=p>,</span> <span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>li</span> <span class=o>&gt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>lj</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>ms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>ms</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>li</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span> <span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>tmp</span> <span class=p>,</span> <span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span> <span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>li</span><span class=p>,</span> <span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>li</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>li</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span> <span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>tmp</span> <span class=p>,</span> <span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>g</span><span class=p>(</span><span class=n>lj</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span> <span class=n>k</span> <span class=p>,</span><span class=n>i</span> <span class=p>,</span> <span class=n>j</span><span class=p>,</span> <span class=n>li</span><span class=p>,</span> <span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>kthSmallest</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ms</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]],</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span><span class=n>k</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>,</span><span class=nb>len</span><span class=p>(</span><span class=n>ms</span><span class=p>),</span><span class=nb>len</span><span class=p>(</span><span class=n>ms</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=sol2-binary-search--binary-search>Sol2: binary search + binary search<a hidden class=anchor aria-hidden=true href=#sol2-binary-search--binary-search>#</a></h2><p>第一個binary search在matrix的最大與最小的範圍中找個數字，依據數字的排名做二分
第二個binary search在每個row找總共有多少數字小於等於(upper bound)現在猜的數字</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>count</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span><span class=n>v</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>exist</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>ms</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=n>bisect</span><span class=o>.</span><span class=n>bisect</span><span class=p>(</span><span class=n>m</span><span class=p>,</span><span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ret</span> <span class=o>+=</span> <span class=n>tmp</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tmp</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>exist</span> <span class=o>=</span> <span class=n>exist</span> <span class=ow>or</span> <span class=n>m</span><span class=p>[</span><span class=n>tmp</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=n>ret</span><span class=p>,</span> <span class=n>exist</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check</span><span class=p>(</span><span class=n>k</span><span class=p>,</span><span class=n>n</span><span class=p>,</span><span class=n>exist</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>n</span><span class=o>&gt;=</span><span class=n>k</span> <span class=ow>and</span> <span class=n>exist</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>kthSmallest</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ms</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]],</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>ms</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=n>ms</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>exist</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span><span class=p>,</span> <span class=n>exist</span> <span class=o>=</span> <span class=n>count</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tmp</span> <span class=o>&gt;=</span> <span class=n>k</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>=</span> <span class=n>mid</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>i</span>
</span></span></code></pre></div><h2 id=sol3-binary-search--saddleback>Sol3: binary search + saddleback<a hidden class=anchor aria-hidden=true href=#sol3-binary-search--saddleback>#</a></h2><p>利用saddleback的想法，從左下走</p><p>如果比猜的數字大，往上以及加總這排的小於等於的總數
如果比猜的數字小，往右走</p><p>不過要注意，不要往右走到超過邊界</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>count</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span><span class=n>v</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ms</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>i</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>j</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>ms</span><span class=p>)</span> <span class=ow>or</span> <span class=n>ms</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>v</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>j</span> <span class=o>+=</span> <span class=mi>1</span> 
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check</span><span class=p>(</span><span class=n>k</span><span class=p>,</span><span class=n>n</span><span class=p>,</span><span class=n>exist</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>n</span><span class=o>&gt;=</span><span class=n>k</span> <span class=ow>and</span> <span class=n>exist</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>kthSmallest</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ms</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>]],</span> <span class=n>k</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>ms</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=n>ms</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>exist</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>=</span> <span class=n>count</span><span class=p>(</span><span class=n>ms</span><span class=p>,</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tmp</span> <span class=o>&gt;=</span> <span class=n>k</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>=</span> <span class=n>mid</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>i</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/matrix/>Matrix</a></li><li><a href=https://littlebees.github.io/tags/heap-priority-queue/>Heap (Priority Queue)</a></li><li><a href=https://littlebees.github.io/tags/sorting/>Sorting</a></li><li><a href=https://littlebees.github.io/tags/binary-search/>Binary Search</a></li><li><a href=https://littlebees.github.io/tags/array/>Array</a></li><li><a href=https://littlebees.github.io/tags/top-100-liked-questions/>Top 100 Liked Questions</a></li><li><a href=https://littlebees.github.io/tags/top-interview-questions/>Top Interview Questions</a></li><li><a href=https://littlebees.github.io/tags/seanprashad/>seanprashad</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2021/01/leetcode-334-increasing-triplet-subsequence/><span class=title>« Prev</span><br><span>leetcode-334 - Increasing Triplet Subsequence</span>
</a><a class=next href=https://littlebees.github.io/2021/01/leetcode-1261-find-elements-in-a-contaminated-binary-tree/><span class=title>Next »</span><br><span>leetcode-1261 - Find Elements in a Contaminated Binary Tree</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>