<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>leetcode-745 - Prefix and Suffix Search | 記事本</title>
<meta name=keywords content="Trie,Design,String,seanprashad"><meta name=description content="動機
Hard題都是來看創意的

用pair讓兩個dfs整合在一起
把prefix與suffix encode成一個字串
"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2021/08/leetcode-745-prefix-and-suffix-search/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://littlebees.github.io/2021/08/leetcode-745-prefix-and-suffix-search/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="leetcode-745 - Prefix and Suffix Search"><meta property="og:description" content="動機
Hard題都是來看創意的

用pair讓兩個dfs整合在一起
把prefix與suffix encode成一個字串
"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2021/08/leetcode-745-prefix-and-suffix-search/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-05T21:24:32+00:00"><meta property="article:modified_time" content="2021-08-05T21:24:32+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="leetcode-745 - Prefix and Suffix Search"><meta name=twitter:description content="動機
Hard題都是來看創意的

用pair讓兩個dfs整合在一起
把prefix與suffix encode成一個字串
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"leetcode-745 - Prefix and Suffix Search","item":"https://littlebees.github.io/2021/08/leetcode-745-prefix-and-suffix-search/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"leetcode-745 - Prefix and Suffix Search","name":"leetcode-745 - Prefix and Suffix Search","description":"動機 Hard題都是來看創意的\n用pair讓兩個dfs整合在一起 把prefix與suffix encode成一個字串 ","keywords":["Trie","Design","String","seanprashad"],"articleBody":"動機 Hard題都是來看創意的\n用pair讓兩個dfs整合在一起 把prefix與suffix encode成一個字串 Problem Design a special dictionary with some words that searchs the words in it by a prefix and a suffix.\nImplement the WordFilter class:\nWordFilter(string[] words) Initializes the object with the words in the dictionary.f(string prefix, string suffix) Returns the index of the word in the dictionary, which has the prefix prefix and the suffix suffix. If there is more than one valid index, return the largest of them. If there is no such word in the dictionary, return -1. Example 1:\nInput[WordFilter, f][[[apple]], [a, e]]Output[null, 0]ExplanationWordFilter wordFilter = new WordFilter([apple]);wordFilter.f(a, e); // return 0, because the word at index 0 has prefix = a and suffix = 'e. Constraints:\n1 \u003c= words.length \u003c= 150001 \u003c= words[i].length \u003c= 101 \u003c= prefix.length, suffix.length \u003c= 10words[i], prefix and suffix consist of lower-case English letters only.At most 15000 calls will be made to the function f. Sol 兩個Trie配set intersection會超時?\n那就上cache\nclass Trie: def __init__(self): self.next = defaultdict(Trie) self.idxs = set() def add(self,s,i): now = self while s: now = now.next[s[0]] s = s[1:] now.idxs.add(i) @cache def dfs(self,s): if s: if s[0] in self.next: return self.next[s[0]].dfs(s[1:]) else: return set() elif not self.next: return self.idxs else: return self.idxs.union(*[self.next[c].dfs(\"\") for c in self.next]) class WordFilter: def __init__(self, words: List[str]): self.forward = Trie() self.backward = Trie() for (i,s) in enumerate(words): self.forward.add(s,i) self.backward.add(s[::-1],i) @cache def f(self, prefix: str, suffix: str) -\u003e int: #print(self.forward.dfs(prefix) , self.backward.dfs(suffix)) return max(list(self.forward.dfs(prefix) \u0026 self.backward.dfs(suffix[::-1])),default=-1) 或是，把單字與reverse的單字合成pair，就可以同時看了\nTrie = lambda: collections.defaultdict(Trie) WEIGHT = False class WordFilter(object): def __init__(self, words): self.trie = Trie() for weight, word in enumerate(words): cur = self.trie cur[WEIGHT] = weight for i, x in enumerate(word): #Put all prefixes and suffixes tmp = cur for letter in word[i:]: tmp = tmp[letter, None] tmp[WEIGHT] = weight tmp = cur for letter in word[:-i or None][::-1]: tmp = tmp[None, letter] tmp[WEIGHT] = weight #Advance letters cur = cur[x, word[~i]] cur[WEIGHT] = weight def search(self, prefix, suffix): cur = self.trie for a, b in map(None, prefix, suffix[::-1]): if (a, b) not in cur: return -1 cur = cur[a, b] return cur[WEIGHT] 或是，把suffix放前面再把單字放後面，像\n#apple，e#apple，el#apple，ple#apple，pple#apple，apple#apple\nTrie = lambda: collections.defaultdict(Trie) WEIGHT = False class WordFilter(object): def __init__(self, words): self.trie = Trie() for weight, word in enumerate(words): word += '#' for i in xrange(len(word)): cur = self.trie cur[WEIGHT] = weight for j in xrange(i, 2 * len(word) - 1): cur = cur[word[j % len(word)]] cur[WEIGHT] = weight def f(self, prefix, suffix): cur = self.trie for letter in suffix + '#' + prefix: if letter not in cur: return -1 cur = cur[letter] return cur[WEIGHT] ","wordCount":"419","inLanguage":"en","image":"https://littlebees.github.io/images/papermod-cover.png","datePublished":"2021-08-05T21:24:32Z","dateModified":"2021-08-05T21:24:32Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2021/08/leetcode-745-prefix-and-suffix-search/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">leetcode-745 - Prefix and Suffix Search</h1><div class=post-meta><span title='2021-08-05 21:24:32 +0000 UTC'>August 5, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%8b%95%e6%a9%9f aria-label=動機>動機</a></li><li><a href=#problem aria-label=Problem>Problem</a></li><li><a href=#sol aria-label=Sol>Sol</a></li></ul></div></details></div><div class=post-content><h2 id=動機>動機<a hidden class=anchor aria-hidden=true href=#動機>#</a></h2><p>Hard題都是來看創意的</p><ol><li><em>用pair讓兩個dfs整合在一起</em></li><li><em>把prefix與suffix encode成一個字串</em></li></ol><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>Design a special dictionary with some words that searchs the words in it by a prefix and a suffix.</p><p>Implement the <code>WordFilter</code> class:</p><ul><li><code>WordFilter(string[] words)</code> Initializes the object with the <code>words</code> in the dictionary.</li><li><code>f(string prefix, string suffix)</code> Returns <em>the index of the word in the dictionary,</em> which has the prefix <code>prefix</code> and the suffix <code>suffix</code>. If there is more than one valid index, return <strong>the largest</strong> of them. If there is no such word in the dictionary, return <code>-1</code>.</li></ul><p> </p><p><strong>Example 1:</strong></p><pre><strong>Input</strong>[WordFilter, f][[[apple]], [a, e]]<strong>Output</strong>[null, 0]<strong>Explanation</strong>WordFilter wordFilter = new WordFilter([apple]);wordFilter.f(a, e); // return 0, because the word at index 0 has prefix = a and suffix = 'e.</pre><p> </p><p><strong>Constraints:</strong></p><ul><li><code>1 <= words.length <= 15000</code></li><li><code>1 <= words[i].length <= 10</code></li><li><code>1 <= prefix.length, suffix.length <= 10</code></li><li><code>words[i]</code>, <code>prefix</code> and <code>suffix</code> consist of lower-case English letters only.</li><li>At most <code>15000</code> calls will be made to the function <code>f</code>.</li></ul><h2 id=sol>Sol<a hidden class=anchor aria-hidden=true href=#sol>#</a></h2><p>兩個Trie配set intersection會超時?</p><p>那就上cache</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Trie</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>next</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=n>Trie</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>idxs</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>s</span><span class=p>,</span><span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>now</span> <span class=o>=</span> <span class=bp>self</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>now</span> <span class=o>=</span> <span class=n>now</span><span class=o>.</span><span class=n>next</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>            <span class=n>s</span> <span class=o>=</span> <span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>now</span><span class=o>.</span><span class=n>idxs</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@cache</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>dfs</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>s</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>next</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>next</span><span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>dfs</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>next</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>idxs</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>idxs</span><span class=o>.</span><span class=n>union</span><span class=p>(</span><span class=o>*</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>next</span><span class=p>[</span><span class=n>c</span><span class=p>]</span><span class=o>.</span><span class=n>dfs</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>next</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WordFilter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>words</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>forward</span> <span class=o>=</span> <span class=n>Trie</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>backward</span> <span class=o>=</span> <span class=n>Trie</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>s</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>words</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>s</span><span class=p>,</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>backward</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>s</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@cache</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prefix</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>suffix</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1>#print(self.forward.dfs(prefix) , self.backward.dfs(suffix))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>max</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>forward</span><span class=o>.</span><span class=n>dfs</span><span class=p>(</span><span class=n>prefix</span><span class=p>)</span> <span class=o>&amp;</span> <span class=bp>self</span><span class=o>.</span><span class=n>backward</span><span class=o>.</span><span class=n>dfs</span><span class=p>(</span><span class=n>suffix</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>])),</span><span class=n>default</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><p>或是，把單字與reverse的單字合成pair，就可以同時看了</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>Trie</span> <span class=o>=</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=n>Trie</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>WEIGHT</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WordFilter</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>words</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>trie</span> <span class=o>=</span> <span class=n>Trie</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>weight</span><span class=p>,</span> <span class=n>word</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>words</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>trie</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span> <span class=o>=</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>word</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1>#Put all prefixes and suffixes</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>cur</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>letter</span> <span class=ow>in</span> <span class=n>word</span><span class=p>[</span><span class=n>i</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=n>letter</span><span class=p>,</span> <span class=kc>None</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span> <span class=o>=</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>cur</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>letter</span> <span class=ow>in</span> <span class=n>word</span><span class=p>[:</span><span class=o>-</span><span class=n>i</span> <span class=ow>or</span> <span class=kc>None</span><span class=p>][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=n>tmp</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=n>letter</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span> <span class=o>=</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=c1>#Advance letters</span>
</span></span><span class=line><span class=cl>                <span class=n>cur</span> <span class=o>=</span> <span class=n>cur</span><span class=p>[</span><span class=n>x</span><span class=p>,</span> <span class=n>word</span><span class=p>[</span><span class=o>~</span><span class=n>i</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>                <span class=n>cur</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span> <span class=o>=</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prefix</span><span class=p>,</span> <span class=n>suffix</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>cur</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>trie</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span> <span class=ow>in</span> <span class=nb>map</span><span class=p>(</span><span class=kc>None</span><span class=p>,</span> <span class=n>prefix</span><span class=p>,</span> <span class=n>suffix</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>cur</span><span class=p>:</span> <span class=k>return</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span> <span class=o>=</span> <span class=n>cur</span><span class=p>[</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>cur</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span>
</span></span></code></pre></div><p>或是，把suffix放前面再把單字放後面，像</p><p><code>#apple</code>，<code>e#apple</code>，<code>el#apple</code>，<code>ple#apple</code>，<code>pple#apple</code>，<code>apple#apple</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>Trie</span> <span class=o>=</span> <span class=k>lambda</span><span class=p>:</span> <span class=n>collections</span><span class=o>.</span><span class=n>defaultdict</span><span class=p>(</span><span class=n>Trie</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>WEIGHT</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WordFilter</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>words</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>trie</span> <span class=o>=</span> <span class=n>Trie</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>weight</span><span class=p>,</span> <span class=n>word</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>words</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>word</span> <span class=o>+=</span> <span class=s1>&#39;#&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>xrange</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>word</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>                <span class=n>cur</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>trie</span>
</span></span><span class=line><span class=cl>                <span class=n>cur</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span> <span class=o>=</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=n>xrange</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mi>2</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>word</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>cur</span> <span class=o>=</span> <span class=n>cur</span><span class=p>[</span><span class=n>word</span><span class=p>[</span><span class=n>j</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>word</span><span class=p>)]]</span>
</span></span><span class=line><span class=cl>                    <span class=n>cur</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span> <span class=o>=</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>f</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prefix</span><span class=p>,</span> <span class=n>suffix</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>cur</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>trie</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>letter</span> <span class=ow>in</span> <span class=n>suffix</span> <span class=o>+</span> <span class=s1>&#39;#&#39;</span> <span class=o>+</span> <span class=n>prefix</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>letter</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>cur</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span> <span class=o>=</span> <span class=n>cur</span><span class=p>[</span><span class=n>letter</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>cur</span><span class=p>[</span><span class=n>WEIGHT</span><span class=p>]</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/trie/>Trie</a></li><li><a href=https://littlebees.github.io/tags/design/>Design</a></li><li><a href=https://littlebees.github.io/tags/string/>String</a></li><li><a href=https://littlebees.github.io/tags/seanprashad/>Seanprashad</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2021/08/leetcode-632-smallest-range-covering-elements-from-k-lists/><span class=title>« Prev</span><br><span>leetcode-632 - Smallest Range Covering Elements from K Lists</span>
</a><a class=next href=https://littlebees.github.io/2021/08/leetcode-1203-sort-items-by-groups-respecting-dependencies/><span class=title>Next »</span><br><span>leetcode-1203 - Sort Items by Groups Respecting Dependencies</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>