<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>leetcode-1011 - Capacity To Ship Packages Within D Days | 記事本</title>
<meta name=keywords content="Greedy,Binary Search,Array,,60 questions to solve"><meta name=description content="動機

method call的代價會不會太高!?
見到bsearch的範圍的重要性
"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2021/01/leetcode-1011-capacity-to-ship-packages-within-d-days/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://littlebees.github.io/2021/01/leetcode-1011-capacity-to-ship-packages-within-d-days/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="leetcode-1011 - Capacity To Ship Packages Within D Days"><meta property="og:description" content="動機

method call的代價會不會太高!?
見到bsearch的範圍的重要性
"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2021/01/leetcode-1011-capacity-to-ship-packages-within-d-days/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-29T01:32:31+00:00"><meta property="article:modified_time" content="2021-01-29T01:32:31+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="leetcode-1011 - Capacity To Ship Packages Within D Days"><meta name=twitter:description content="動機

method call的代價會不會太高!?
見到bsearch的範圍的重要性
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"leetcode-1011 - Capacity To Ship Packages Within D Days","item":"https://littlebees.github.io/2021/01/leetcode-1011-capacity-to-ship-packages-within-d-days/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"leetcode-1011 - Capacity To Ship Packages Within D Days","name":"leetcode-1011 - Capacity To Ship Packages Within D Days","description":"動機 method call的代價會不會太高!? 見到bsearch的範圍的重要性 ","keywords":["Greedy","Binary Search","Array",null,"60 questions to solve"],"articleBody":"動機 method call的代價會不會太高!? 見到bsearch的範圍的重要性 Problem A conveyor belt has packages that must be shipped from one port to another within days days.\nThe ith package on the conveyor belt has a weight of weights[i]. Each day, we load the ship with packages on the conveyor belt (in the order given by weights). We may not load more weight than the maximum weight capacity of the ship.\nReturn the least weight capacity of the ship that will result in all the packages on the conveyor belt being shipped within days days.\nExample 1:\nInput: weights = [1,2,3,4,5,6,7,8,9,10], days = 5Output: 15Explanation: A ship capacity of 15 is the minimum to ship all the packages in 5 days like this:1st day: 1, 2, 3, 4, 52nd day: 6, 73rd day: 84th day: 95th day: 10Note that the cargo must be shipped in the order given, so using a ship of capacity 14 and splitting the packages into parts like (2, 3, 4, 5), (1, 6, 7), (8), (9), (10) is not allowed.Example 2:\nInput: weights = [3,2,2,4,1,4], days = 3Output: 6Explanation: A ship capacity of 6 is the minimum to ship all the packages in 3 days like this:1st day: 3, 22nd day: 2, 43rd day: 1, 4Example 3:\nInput: weights = [1,2,3,1,1], days = 4Output: 3Explanation:1st day: 12nd day: 23rd day: 34th day: 1, 1 Constraints:\n1 \u003c= days \u003c= weights.length \u003c= 5 * 1041 \u003c= weights[i] \u003c= 500 Sol1 用二分去猜，要裝多少\n但這個解很慢，1948 ms\n後面就是慢慢優化的過程\nclass Solution: def fill(self,mid): tmp = 0 lastIndex = 1 ss = 0 for w in self.ws: if w \u003e mid: return [self.D+1, 0] # force enlarge ss = max(ss,tmp) if tmp + w \u003e mid: tmp = w lastIndex += 1 elif tmp + w == mid: #print(\"HERE\",mid,ss) ss = max(ss,mid) tmp = 0 lastIndex += 1 else: tmp += w #print(\"HERE\",ss,tmp) ss = max(ss,tmp) #print(\"final\",ss) return [lastIndex, ss] def shipWithinDays(self, ws: List[int], D: int) -\u003e int: self.ws = ws self.D = D i = min(sum(ws)//D,max(ws)) j = (sum(ws))+1 limit = 0 while i \u003c j: mid = i + (j-i)//2 print(mid) lastIdx, limit = self.fill(mid) if lastIdx == D: j = mid elif lastIdx \u003c D: j = mid else: i = mid+1 return self.fill(i)[1] Sol2 簡化加總 原本是加總後分成三個case，看小於、等於、大於上限 之後就看每個case的加總之後是要設定成多少\n不過可以在加新重量之前，就看會不會超過就好\n1080 ms\nclass Solution: def fill(self,mid): tmp = 0 lastIndex = 1 ss = 0 for w in self.ws: if tmp + w \u003e mid: lastIndex += 1 tmp = 0 tmp += w ss = max(ss,tmp) return [lastIndex, ss] def shipWithinDays(self, ws: List[int], D: int) -\u003e int: self.ws = ws self.D = D i = 1 j = (sum(ws))+1 limit = 0 while i \u003c j: mid = i + (j-i)//2 #print(mid) lastIdx, limit = self.fill(mid) if lastIdx == D: j = mid elif lastIdx \u003c D: j = mid else: i = mid+1 return self.fill(i)[1] Sol3: 縮小範圍 考慮到 D 等於 weights 長度的case，這會發生什麼事?\n[407,59,416,189,326,109,399,404,181,275,135,57,147,7,158,201,218,111,56,9,149,231,186,293,187,395,75,100,334,23,327,434] 32 每一次加總都會小於或等於D，這樣bsearch會出事，算出來的答案會一直降下去!! 這樣算出來的答案不會是容量，導致要另外紀錄目前加出來的的最大值(fill的ss)\n所以要把範圍縮小，最小至少要是所有重量的最大值，讓容量不會無下限的往下，這樣就可以直接把bsearch到的東西直接丟回去\n976 ms\nclass Solution: def fill(self,mid): tmp = 0 lastIndex = 1 ss = 0 for w in self.ws: if tmp + w \u003e mid: lastIndex += 1 tmp = 0 tmp += w ss = max(ss,tmp) return [lastIndex, ss] def shipWithinDays(self, ws: List[int], D: int) -\u003e int: self.ws = ws self.D = D j = (sum(ws)) i = max(ws) limit = 0 while i \u003c j: mid = i + (j-i)//2 #print(mid) lastIdx, limit = self.fill(mid) if lastIdx == D: j = mid elif lastIdx \u003c D: j = mid else: i = mid+1 return i Sol4: remove method call 還是很慢，如果把method call去掉的話\n560 ms\nclass Solution: def shipWithinDays(self, ws: List[int], D: int) -\u003e int: j = sum(ws) i = max(j//D, max(ws)) limit = 0 while i \u003c j: mid = i + (j-i)//2 tmp = 0 lastIndex = 1 #print(mid) for w in ws: if tmp + w \u003e mid: lastIndex += 1 tmp = 0 tmp += w if lastIndex \u003c= D: j = mid else: i = mid+1 return i Sol Final: 再縮小範圍 從Sol3，我們知道 最小至少要是所有重量的最大值\n那最大值應該是多少?\n總重量平均? 會太小，像是 [1,2,3,4,5,6,7,8,9,10], 5 就直接死亡 總重量? 太大了，所以前面的解才都那麼慢 平均會太小是因為有一些重量特別小，導致平均變小，所以可以 把每一個貨物當成最重的重量，去算平均\nclass Solution: def shipWithinDays(self, ws: List[int], D: int) -\u003e int: i = max(ws) j = len(ws)*i //D + 1 limit = 0 while i \u003c j: mid = i + (j-i)//2 tmp = 0 lastIndex = 1 for w in ws: if tmp + w \u003e mid: lastIndex += 1 tmp = 0 tmp += w if lastIndex \u003c= D: j = mid else: i = mid+1 return i ","wordCount":"741","inLanguage":"en","image":"https://littlebees.github.io/images/papermod-cover.png","datePublished":"2021-01-29T01:32:31Z","dateModified":"2021-01-29T01:32:31Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2021/01/leetcode-1011-capacity-to-ship-packages-within-d-days/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">leetcode-1011 - Capacity To Ship Packages Within D Days</h1><div class=post-meta><span title='2021-01-29 01:32:31 +0000 UTC'>January 29, 2021</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%8b%95%e6%a9%9f aria-label=動機>動機</a></li><li><a href=#problem aria-label=Problem>Problem</a></li><li><a href=#sol1 aria-label=Sol1>Sol1</a></li><li><a href=#sol2-%e7%b0%a1%e5%8c%96%e5%8a%a0%e7%b8%bd aria-label="Sol2 簡化加總">Sol2 簡化加總</a></li><li><a href=#sol3-%e7%b8%ae%e5%b0%8f%e7%af%84%e5%9c%8d aria-label="Sol3: 縮小範圍">Sol3: 縮小範圍</a></li><li><a href=#sol4-remove-method-call aria-label="Sol4: remove method call">Sol4: remove method call</a></li><li><a href=#sol-final-%e5%86%8d%e7%b8%ae%e5%b0%8f%e7%af%84%e5%9c%8d aria-label="Sol Final: 再縮小範圍">Sol Final: 再縮小範圍</a></li></ul></div></details></div><div class=post-content><h2 id=動機>動機<a hidden class=anchor aria-hidden=true href=#動機>#</a></h2><ol><li>method call的代價會不會太高!?</li><li>見到bsearch的範圍的重要性</li></ol><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>A conveyor belt has packages that must be shipped from one port to another within <code>days</code> days.</p><p>The <code>i<sup>th</sup></code> package on the conveyor belt has a weight of <code>weights[i]</code>. Each day, we load the ship with packages on the conveyor belt (in the order given by <code>weights</code>). We may not load more weight than the maximum weight capacity of the ship.</p><p>Return the least weight capacity of the ship that will result in all the packages on the conveyor belt being shipped within <code>days</code> days.</p><p> </p><p><strong>Example 1:</strong></p><pre><strong>Input:</strong> weights = [1,2,3,4,5,6,7,8,9,10], days = 5<strong>Output:</strong> 15<strong>Explanation:</strong> A ship capacity of 15 is the minimum to ship all the packages in 5 days like this:1st day: 1, 2, 3, 4, 52nd day: 6, 73rd day: 84th day: 95th day: 10Note that the cargo must be shipped in the order given, so using a ship of capacity 14 and splitting the packages into parts like (2, 3, 4, 5), (1, 6, 7), (8), (9), (10) is not allowed.</pre><p><strong>Example 2:</strong></p><pre><strong>Input:</strong> weights = [3,2,2,4,1,4], days = 3<strong>Output:</strong> 6<strong>Explanation:</strong> A ship capacity of 6 is the minimum to ship all the packages in 3 days like this:1st day: 3, 22nd day: 2, 43rd day: 1, 4</pre><p><strong>Example 3:</strong></p><pre><strong>Input:</strong> weights = [1,2,3,1,1], days = 4<strong>Output:</strong> 3<strong>Explanation:</strong>1st day: 12nd day: 23rd day: 34th day: 1, 1</pre><p> </p><p><strong>Constraints:</strong></p><ul><li><code>1 <= days <= weights.length <= 5 * 10<sup>4</sup></code></li><li><code>1 <= weights[i] <= 500</code></li></ul><h2 id=sol1>Sol1<a hidden class=anchor aria-hidden=true href=#sol1>#</a></h2><p>用二分去猜，要裝多少</p><p>但這個解很慢，1948 ms</p><p>後面就是慢慢優化的過程</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>fill</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>mid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>lastIndex</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ss</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>ws</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>w</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>D</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span> <span class=c1># force enlarge</span>
</span></span><span class=line><span class=cl>            <span class=n>ss</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>ss</span><span class=p>,</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tmp</span> <span class=o>+</span> <span class=n>w</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>                <span class=n>lastIndex</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>tmp</span> <span class=o>+</span> <span class=n>w</span> <span class=o>==</span> <span class=n>mid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1>#print(&#34;HERE&#34;,mid,ss)</span>
</span></span><span class=line><span class=cl>                <span class=n>ss</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>ss</span><span class=p>,</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                <span class=n>lastIndex</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>+=</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>                <span class=c1>#print(&#34;HERE&#34;,ss,tmp)</span>
</span></span><span class=line><span class=cl>            <span class=n>ss</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>ss</span><span class=p>,</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>#print(&#34;final&#34;,ss)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>lastIndex</span><span class=p>,</span> <span class=n>ss</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>shipWithinDays</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ws</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>D</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ws</span> <span class=o>=</span> <span class=n>ws</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>D</span> <span class=o>=</span> <span class=n>D</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=n>ws</span><span class=p>)</span><span class=o>//</span><span class=n>D</span><span class=p>,</span><span class=nb>max</span><span class=p>(</span><span class=n>ws</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=n>ws</span><span class=p>))</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>limit</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>lastIdx</span><span class=p>,</span> <span class=n>limit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>lastIdx</span> <span class=o>==</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>lastIdx</span> <span class=o>&lt;</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>=</span> <span class=n>mid</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>i</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></div><h2 id=sol2-簡化加總>Sol2 簡化加總<a hidden class=anchor aria-hidden=true href=#sol2-簡化加總>#</a></h2><p>原本是加總後分成三個case，看小於、等於、大於上限
之後就看每個case的加總之後是要設定成多少</p><p>不過可以在加新重量之前，就看會不會超過就好</p><p>1080 ms</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>fill</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>mid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>lastIndex</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ss</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>ws</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tmp</span> <span class=o>+</span> <span class=n>w</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>lastIndex</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>+=</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>            <span class=n>ss</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>ss</span><span class=p>,</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>lastIndex</span><span class=p>,</span> <span class=n>ss</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>shipWithinDays</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ws</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>D</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ws</span> <span class=o>=</span> <span class=n>ws</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>D</span> <span class=o>=</span> <span class=n>D</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=n>ws</span><span class=p>))</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>limit</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=c1>#print(mid)</span>
</span></span><span class=line><span class=cl>            <span class=n>lastIdx</span><span class=p>,</span> <span class=n>limit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>lastIdx</span> <span class=o>==</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>lastIdx</span> <span class=o>&lt;</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>=</span> <span class=n>mid</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>i</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></div><h2 id=sol3-縮小範圍>Sol3: 縮小範圍<a hidden class=anchor aria-hidden=true href=#sol3-縮小範圍>#</a></h2><p>考慮到 D 等於 weights 長度的case，這會發生什麼事?</p><pre tabindex=0><code>[407,59,416,189,326,109,399,404,181,275,135,57,147,7,158,201,218,111,56,9,149,231,186,293,187,395,75,100,334,23,327,434]
32
</code></pre><p>每一次加總都會小於或等於D，這樣bsearch會出事，算出來的答案會一直降下去!!
這樣算出來的答案不會是容量，導致要另外紀錄目前加出來的的最大值(fill的ss)</p><p>所以要把範圍縮小，<strong>最小至少要是所有重量的最大值</strong>，讓容量不會無下限的往下，這樣就可以直接把bsearch到的東西直接丟回去</p><p>976 ms</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>fill</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span><span class=n>mid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>lastIndex</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ss</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>ws</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>tmp</span> <span class=o>+</span> <span class=n>w</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>lastIndex</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>+=</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>            <span class=n>ss</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>ss</span><span class=p>,</span><span class=n>tmp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>lastIndex</span><span class=p>,</span> <span class=n>ss</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>shipWithinDays</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ws</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>D</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ws</span> <span class=o>=</span> <span class=n>ws</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>D</span> <span class=o>=</span> <span class=n>D</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=p>(</span><span class=nb>sum</span><span class=p>(</span><span class=n>ws</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>ws</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>limit</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=c1>#print(mid)</span>
</span></span><span class=line><span class=cl>            <span class=n>lastIdx</span><span class=p>,</span> <span class=n>limit</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fill</span><span class=p>(</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>lastIdx</span> <span class=o>==</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>lastIdx</span> <span class=o>&lt;</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>=</span> <span class=n>mid</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>i</span>
</span></span></code></pre></div><h2 id=sol4-remove-method-call>Sol4: remove method call<a hidden class=anchor aria-hidden=true href=#sol4-remove-method-call>#</a></h2><p>還是很慢，如果把method call去掉的話</p><p>560 ms</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>shipWithinDays</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ws</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>D</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>ws</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>j</span><span class=o>//</span><span class=n>D</span><span class=p>,</span> <span class=nb>max</span><span class=p>(</span><span class=n>ws</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>limit</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>lastIndex</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=c1>#print(mid)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>ws</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>tmp</span> <span class=o>+</span> <span class=n>w</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>lastIndex</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>+=</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>lastIndex</span> <span class=o>&lt;=</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>=</span> <span class=n>mid</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>i</span>
</span></span></code></pre></div><h2 id=sol-final-再縮小範圍>Sol Final: 再縮小範圍<a hidden class=anchor aria-hidden=true href=#sol-final-再縮小範圍>#</a></h2><p>從Sol3，我們知道 最小至少要是所有重量的最大值</p><p>那最大值應該是多少?</p><ul><li>總重量平均?<ul><li>會太小，像是 <code>[1,2,3,4,5,6,7,8,9,10], 5</code> 就直接死亡</li></ul></li><li>總重量?<ul><li>太大了，所以前面的解才都那麼慢</li></ul></li></ul><p>平均會太小是因為有一些重量特別小，導致平均變小，所以可以
<strong>把每一個貨物當成最重的重量，去算平均</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>shipWithinDays</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ws</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> <span class=n>D</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>ws</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>j</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>ws</span><span class=p>)</span><span class=o>*</span><span class=n>i</span> <span class=o>//</span><span class=n>D</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>limit</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>j</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=p>(</span><span class=n>j</span><span class=o>-</span><span class=n>i</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>lastIndex</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>ws</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>tmp</span> <span class=o>+</span> <span class=n>w</span> <span class=o>&gt;</span> <span class=n>mid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>lastIndex</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=n>tmp</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                <span class=n>tmp</span> <span class=o>+=</span> <span class=n>w</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>lastIndex</span> <span class=o>&lt;=</span> <span class=n>D</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>=</span> <span class=n>mid</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>i</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/greedy/>Greedy</a></li><li><a href=https://littlebees.github.io/tags/binary-search/>Binary Search</a></li><li><a href=https://littlebees.github.io/tags/array/>Array</a></li><li><a href=https://littlebees.github.io/tags/60-questions-to-solve/>60 Questions to Solve</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2021/01/leetcode-315-count-of-smaller-numbers-after-self/><span class=title>« Prev</span><br><span>leetcode-315 - Count of Smaller Numbers After Self</span>
</a><a class=next href=https://littlebees.github.io/2021/01/leetcode-289-game-of-life/><span class=title>Next »</span><br><span>leetcode-289 - Game of Life</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>