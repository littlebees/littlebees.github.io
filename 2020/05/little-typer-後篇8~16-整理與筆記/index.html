<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>little typer 後篇(8~16) 整理與筆記 | 記事本</title>
<meta name=keywords content="Lisp"><meta name=description content="來證明啦
ch8 & ch9 & ch10 & ch11 現在說用type證明，但實際上怎麼做?
在claim寫下想證的東西，在define證出來
incr & + (claim incr (-> Nat Nat)) (define incr (λ (n) (iter-Nat n 1 (+ 1)))) (claim + (-> Nat Nat Nat)) (define + (λ (a b) (iter-Nat a b (λ (ret) (add1 ret))))) +1=add1 證對於任何整數，add1等於+1
(claim +1=add1 (Pi ((n Nat)) (= Nat (+ 1 n) (add1 n)))) 所以我們需要一個value的type是(= Nat (+ 1 n) (add1 n))) 先把1帶入+中，會發現根本就是(add1 n)
也就是兩邊都一樣，same!!
(define +1=add1 (λ (n) (same (+ 1 n)))) incr=add1 同樣的來試試incr=add1"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2020/05/little-typer-%E5%BE%8C%E7%AF%878~16-%E6%95%B4%E7%90%86%E8%88%87%E7%AD%86%E8%A8%98/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="little typer 後篇(8~16) 整理與筆記"><meta property="og:description" content="來證明啦
ch8 & ch9 & ch10 & ch11 現在說用type證明，但實際上怎麼做?
在claim寫下想證的東西，在define證出來
incr & + (claim incr (-> Nat Nat)) (define incr (λ (n) (iter-Nat n 1 (+ 1)))) (claim + (-> Nat Nat Nat)) (define + (λ (a b) (iter-Nat a b (λ (ret) (add1 ret))))) +1=add1 證對於任何整數，add1等於+1
(claim +1=add1 (Pi ((n Nat)) (= Nat (+ 1 n) (add1 n)))) 所以我們需要一個value的type是(= Nat (+ 1 n) (add1 n))) 先把1帶入+中，會發現根本就是(add1 n)
也就是兩邊都一樣，same!!
(define +1=add1 (λ (n) (same (+ 1 n)))) incr=add1 同樣的來試試incr=add1"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2020/05/little-typer-%E5%BE%8C%E7%AF%878~16-%E6%95%B4%E7%90%86%E8%88%87%E7%AD%86%E8%A8%98/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-16T17:34:32+00:00"><meta property="article:modified_time" content="2020-05-16T17:34:32+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="little typer 後篇(8~16) 整理與筆記"><meta name=twitter:description content="來證明啦
ch8 & ch9 & ch10 & ch11 現在說用type證明，但實際上怎麼做?
在claim寫下想證的東西，在define證出來
incr & + (claim incr (-> Nat Nat)) (define incr (λ (n) (iter-Nat n 1 (+ 1)))) (claim + (-> Nat Nat Nat)) (define + (λ (a b) (iter-Nat a b (λ (ret) (add1 ret))))) +1=add1 證對於任何整數，add1等於+1
(claim +1=add1 (Pi ((n Nat)) (= Nat (+ 1 n) (add1 n)))) 所以我們需要一個value的type是(= Nat (+ 1 n) (add1 n))) 先把1帶入+中，會發現根本就是(add1 n)
也就是兩邊都一樣，same!!
(define +1=add1 (λ (n) (same (+ 1 n)))) incr=add1 同樣的來試試incr=add1"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"little typer 後篇(8~16) 整理與筆記","item":"https://littlebees.github.io/2020/05/little-typer-%E5%BE%8C%E7%AF%878~16-%E6%95%B4%E7%90%86%E8%88%87%E7%AD%86%E8%A8%98/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"little typer 後篇(8~16) 整理與筆記","name":"little typer 後篇(8~16) 整理與筆記","description":"來證明啦\nch8 \u0026amp; ch9 \u0026amp; ch10 \u0026amp; ch11 現在說用type證明，但實際上怎麼做?\n在claim寫下想證的東西，在define證出來\nincr \u0026amp; + (claim incr (-\u0026gt; Nat Nat)) (define incr (λ (n) (iter-Nat n 1 (+ 1)))) (claim + (-\u0026gt; Nat Nat Nat)) (define + (λ (a b) (iter-Nat a b (λ (ret) (add1 ret))))) +1=add1 證對於任何整數，add1等於+1\n(claim +1=add1 (Pi ((n Nat)) (= Nat (+ 1 n) (add1 n)))) 所以我們需要一個value的type是(= Nat (+ 1 n) (add1 n))) 先把1帶入+中，會發現根本就是(add1 n)\n也就是兩邊都一樣，same!!\n(define +1=add1 (λ (n) (same (+ 1 n)))) incr=add1 同樣的來試試incr=add1","keywords":["Lisp"],"articleBody":"來證明啦\nch8 \u0026 ch9 \u0026 ch10 \u0026 ch11 現在說用type證明，但實際上怎麼做?\n在claim寫下想證的東西，在define證出來\nincr \u0026 + (claim incr (-\u003e Nat Nat)) (define incr (λ (n) (iter-Nat n 1 (+ 1)))) (claim + (-\u003e Nat Nat Nat)) (define + (λ (a b) (iter-Nat a b (λ (ret) (add1 ret))))) +1=add1 證對於任何整數，add1等於+1\n(claim +1=add1 (Pi ((n Nat)) (= Nat (+ 1 n) (add1 n)))) 所以我們需要一個value的type是(= Nat (+ 1 n) (add1 n))) 先把1帶入+中，會發現根本就是(add1 n)\n也就是兩邊都一樣，same!!\n(define +1=add1 (λ (n) (same (+ 1 n)))) incr=add1 同樣的來試試incr=add1\n(claim incr=add1 (Pi ((a Nat)) (= Nat (incr a) (add1 a)))) 直接帶入沒有像+1=add1之類的好事，只能用歸納法了 這裡對n做歸納\n這裡motive與base都很好懂，那step呢? 同樣展開incr，會發現(incr n) =\u003e (+ 1 n-1) 而另一邊是add1，其實就是(+ 1 n-1)\n歸納法會回傳n-1的證明，那我們只要把它擴充成n的就好了 把n-1的兩邊同時(+ 1)，cong\n(define incr=add1 (λ (n) (ind-Nat n (λ (a) (= Nat (incr a) (add1 a))) (same 1) (λ (n-1) (λ (prev) (cong prev (+ 1))))))) replace 雖然說incr=add1證好了，但這邊要介紹另一個工具來改寫一部份的type\n歸納法會回傳n-1的證明(prev,(= (incr n-1) (add1 n-1)))，而我們要的證明是(= (add1 (incr n-1)) (add1 (add1 n-1)))，那利用prev去改寫 嗎?\n把prev看成(incr n-1)可以變成(add1 n-1)，就可以用replace把出現(incr n-1)換成(add1 n-1)\n所以用(same (add1 (incr n-1)))，就有空間去換!!\n(define incr=add1 (λ (n) (ind-Nat n (λ (a) (= Nat (incr a) (add1 a))) (same 1) (λ (n-1) (λ (prev) (replace prev (λ (k) (= Nat (add1 (incr n-1)) (add1 k))) ;; 這裡k就是要換的部分，當成挖空 (same (add1 (incr n-1))))))))) twice=double (claim twice (-\u003e Nat Nat)) (define twice (λ (n) (+ n n))) (claim double (-\u003e Nat Nat)) (define double (λ (n) (iter-Nat n 0 (λ (ret) (+ 2 ret))))) (claim twice=double (Pi ((n Nat)) (= Nat (twice n) (double n)))) (define twice=double (λ (n) (ind-Nat n (λ (k) (= Nat (twice k) (double k))) (same 0) (λ (n-1) (λ (prev) ;; (= Nat (twice n-1) (double n-1)) TODO))))) 在Pie可以用TODO去看現在Pie想要什麼type，會噴 整理一下，其實就是\n(= Nat (add1 (+ n-1 (add1 n-1))) (add1 (add1 (double n-1)))) wow，我們有prev，(= Nat (+ n-1 n-1) (double n-1))，如果兩邊都變成(add1 (add1 …))的話，就能用cong了\n所以要證+add1=add1+\n+add1=add1+ 直接帶(add1 n-1)，到motive中 (= Nat (+ (add1 (add1 n-1)) b) (+ (add1 n-1) (add1 b)))\n而我們有prev，(= Nat (+ (add1 n-1) b) (+ n-1 (add1 b)))\n把(= Nat (+ (add1 (add1 n-1)) b) (+ (add1 n-1) (add1 b)))的add1拉出來變成(= Nat (add1 (+ (add1 n-1)) b)) (add1 (+ n-1 (add1 b))))\n只與prev差add1，用cong\n(claim add1+=+add1 (Pi ((n Nat) (b Nat)) (= Nat (+ (add1 n) b) (+ n (add1 b))))) (define add1+=+add1 (λ (n b) (ind-Nat n (λ (x) (= Nat (+ (add1 x) b) (+ x (add1 b)))) (same (add1 b)) (λ (n-1 prev) (cong prev (+ 1)))))) twice=double with +add1=add1+ 可以回來證twice=double\n用replace把位置換過來就可以cong了\n(define twice=double (λ (n) (ind-Nat n (λ (k) (= Nat (twice k) (double k))) (same 0) (λ (n-1) (λ (prev) (replace (add1+=+add1 n-1 n-1) (λ (k) (= Nat (add1 k) (+ 2 (double n-1)))) (cong prev (+ 2)))))))) 這裡也告訴我們位置不對是會影響證明的，下面的就是一個例子\ndouble-vec \u0026 twice-vec (claim double-vec (Pi ((A U) (n Nat)) (-\u003e (Vec A n) (Vec A (double n))))) (claim mot-double-vec (Pi ((A U) (n Nat)) U)) (define mot-double-vec (λ (A x) (-\u003e (Vec A x) (Vec A (double x))))) (define double-vec (λ (A n) (ind-Nat n (mot-double-vec A) (λ (v) (the (Vec A 0) vecnil)) (λ (n-1 f v) (vec:: (head v) (vec:: (head v) (f (tail v)))))))) 直接寫寫看twice-vec，但會發現ind-Nat沒辦法用，要注意到twice-vec要求的base是n!! 用TODO會看到\ndouble-vec twice-vec 所以要寫twice-vec，可以 用replace把double-Vec的double換成twice\n(claim twice-vec (Pi ((A U) (n Nat)) (-\u003e (Vec A n) (Vec A (twice n))))) (define twice-vec (λ (A n v) (replace (symm (twice=double n)) (λ (x) (Vec A x)) ;; 把要抽換的部分，抽象出來回傳type的函數 (double-vec A n v)))) ;; base是值!! 用type去擋掉一些奇怪的實作 List-\u003eVec 看宣告好像很合理，但實作可以亂搞\n(claim List-\u003eVec (Pi ((A U)) (-\u003e (List A) (Sigma ((l Nat)) ;; Sigma是有一個的意思，所以這裡的意思是有一個nat可以滿足(vec A l) (Vec A l))))) (define List-\u003eVec (λ (E) (λ (es) ;; Sigma的實體是list (cons 0 vecnil)))) ;; WTF 所以幫他加個條件，生出來的長度要與原本的一樣\n(claim List-\u003eVec (Pi ((A U) (l (List A))) (Vec A (len A l)))) ;; i am better (define List-\u003eVec (λ (A) (λ (x) (ind-List x (λ (x) (Vec A (len A x))) (the (Vec A 0) vecnil) (λ (a x-1) (λ (ret) (vec:: a ret))))))) 內容物不用一樣嗎? (書上其實有一個可以重複atom的function) 所以可以再寫證明\n用證明去擋一些奇怪的實作 這裡是用Vec-\u003eList去寫一個證明，Vec-\u003eList與List-\u003eVec的內容物實一樣的\n(claim Vec-\u003eList (Pi ((A U) (n Nat)) (-\u003e (Vec A n) (List A)))) (define Vec-\u003eList (λ (A n v) (ind-Vec n v (λ (n v) (List A)) (the (List A) nil) (λ (n-1 a v-1 ret) (:: a ret))))) (claim Vec-\u003eList=List-\u003eVec (Pi ((A U) (l (List A))) (= (List A) l (Vec-\u003eList A (len A l) (List-\u003eVec A l))))) (define Vec-\u003eList=List-\u003eVec (λ (A l) (ind-List l (λ (x) (= (List A) x (Vec-\u003eList A (len A x) (List-\u003eVec A x)))) (same nil) (λ (a l-1 ret) (cong ret (the (-\u003e (List A) (List A)) (λ (x) (:: a x)))))))) ch12 \u0026 ch13 數學套餐開始啦\nodd \u0026 even (claim Even (Pi ((n Nat)) U)) (define Even (λ (n) (Sigma ((x Nat)) (= Nat n (double x))))) (claim Odd (Pi ((n Nat)) U)) (define Odd (λ (n) (Sigma ((x Nat)) (= Nat n (add1 (double x)))))) +2=even (claim +2=even (Pi ((n Nat)) (-\u003e (Even n) (Even (+ 2 n))))) (define +2=even (λ (n eve) (cons (+ 1 (car eve)) (cong (cdr eve) (+ 2))))) ;;這邊不用用到歸納法，因為我們已經有 (Even n) 了!! add1-even-\u003eodd (claim add1-even-\u003eodd (Pi ((n Nat)) (-\u003e (Even n) (Odd (add1 n))))) (define add1-even-\u003eodd (λ (n eve) ;; (Even 10) =\u003e (5 (same 10)) ;; (Odd 11) =\u003e (5 (same 11)) (cons (car eve) (cong (cdr eve) (+ 1))))) add1-odd-\u003eeven (claim add1-odd-\u003eeven (Pi ((n Nat)) (-\u003e (Odd n) (Even (add1 n))))) (define add1-odd-\u003eeven (λ (n eve) ;; (Odd 11) =\u003e (5 (same 11)) ;; (Even 12) =\u003e (6 (same 12)) (cons (add1 (car eve)) (cong (cdr eve) (+ 1))))) ackermann function (claim rep (-\u003e (-\u003e Nat Nat) Nat Nat)) (define rep (λ (f n) (iter-Nat n (f 1) (λ (ret) (f ret))))) ;; (rep f 5) =\u003e (f (f (f (f (f 1))))) (claim ackermann (-\u003e Nat Nat Nat)) (define ackermann (λ (n) (iter-Nat n (+ 1) (λ (ret) (rep ret))))) Even-or-Odd 這裡用到ind-Either，Either是一種type，它只有兩種constructor，left與right\nind-Either，就只處理兩種case，left與right剩下就是motive\n(claim Even-or-Odd (Pi ((n Nat)) (Either (Even n) (Odd n)))) (define Even-or-Odd (λ (n) (ind-Nat n (λ (x) (Either (Even x) (Odd x))) (left (the (Even 0) (cons 0 (same 0)))) (λ (n-1) (λ (ret) (ind-Either ret (λ (e) (Either (Even (add1 n-1)) (Odd (add1 n-1)))) (λ (left-val) (right (add1-even-\u003eodd n-1 left-val))) (λ (right-val) (left (add1-odd-\u003eeven n-1 right-val))))))))) ch14 \u0026 ch15 \u0026 ch16 也有數學套餐，但多Absurd與bem與deciable了!!\nMaybe (claim Maybe (-\u003e U U)) (define Maybe (-\u003e A (Either A Trivial))) (claim Nothing (Pi ((A U)) (Maybe A))) (define Nothing (λ (A) (right sole))) (claim Just (Pi ((A U) (a A)) (Maybe A))) (define Just (λ (A a) (left a))) maybe-head \u0026 maybe-tail (claim maybe-head (Pi ((A U) (l (List A))) (Maybe A))) (define maybe-head (λ (A l) (rec-List l (Nothing A) (λ (a l-1 ret) (Just A a))))) (claim maybe-tail (Pi ((A U) (l (List A))) (Maybe (List A)))) (define maybe-tail (λ (A l) (rec-List l (Nothing (List A)) (λ (a l-1 ret) (Just (List A) l-1))))) list-ref (claim list-ref (Pi ((A U) (i Nat) (l (List A))) (Maybe A))) (define list-ref (λ (A i) (rec-Nat i (maybe-head A) (λ (i-1) (λ (ret) (λ (l) (ind-Either (maybe-tail A l) (λ (x) (Maybe A)) (λ (lhs) (ret lhs)) (λ (rhs) (Nothing A))))))))) Absurd!! 這個要給多一點尊重\nAbsurd是type但沒有任何值 (WTF)\n但是有eliminator (WTF) eliminate後可以生出任何值 (WTF)\nIf a false statement were true, then we might as well say anything at all. (the Principle of Explosion or ex falso quodlibet, which means “from false, anything.”)\nQ: 如果沒有值怎麼eliminate? A: 假裝有 (從lambda的參數來)\n(λ (1=6) ;; WTF (ind-Absurd 1=6 {return type})) 所以Not就是(-\u003e X Absurd)，也就是X只能推出Absurd，什麼都沒有，也就是沒有證明\nvec-ref 這個十分複雜，看不懂沒差，但說說大該是怎麼做的\n用Fin去控制vec要不要繼續往下走，看ind-Ether 如果真的走到空(base case)，用ind-Absurd把Absurd劃掉(這樣就是total function了)\n(vec-ref Nat 4 (fzero 3) (vec:: 1 (vec:: 2 (vec:: 3 (vec:: 4 vecnil))))) ;; (the Nat 1) (vec-ref Nat 4 (fadd1 3 (fzero 2)) (vec:: 1 (vec:: 2 (vec:: 3 (vec:: 4 vecnil))))) ;; (the Nat 2) (vec-ref Nat 4 (fadd1 3 (fadd1 2 (fzero 1))) (vec:: 1 (vec:: 2 (vec:: 3 (vec:: 4 vecnil))))) ;; (the Nat 3) 把fadd1與fzero看成tail與head，所以vec-ref的任務是把一連串fadd1與fzero用成tail與head在Vec上跑\n(claim Fin (-\u003e Nat U)) (define Fin (λ (n) (iter-Nat n Absurd (λ (ret) (Maybe ret))))) ;; 每一個Maybe會分岔出Nothing，所以在iter時都有機會可以到base case (claim fzero (Pi ((n Nat)) (Fin (add1 n)))) (define fzero (λ (n) (Nothing (Fin n)))) (claim fadd1 (Pi ((n Nat)) (-\u003e (Fin n) (Fin (add1 n))))) (define fadd1 (λ (n fin) (Just (Fin n) fin))) (define vec-ref (λ (A i) (ind-Nat i (λ (k) (-\u003e (Fin k) (Vec A k) A)) (λ (fin v) (ind-Absurd fin A)) (λ (i-1) (λ (ret) (λ (fin v) (ind-Either fin (λ (k) A) (λ (lhs) (ret lhs (tail v))) (λ (rhs) (head v))))))))) =consequence 0 (add1 j-1) 0 Trivial Absurd (add1 n-1) Absurd (= Nat (add1 n-1) (add1 j-1)) (claim =cases (-\u003e Nat Nat U)) ;; U 就是兩個比較後，可以知道什麼 (define =cases (λ (a b) (which-Nat a (which-Nat b Trivial ;; 0 = 0 is trivial (λ (b-1) Absurd)) ;; 0 = other Nat is Absurd (λ (a-1) (which-Nat b Absurd ;; other = 0 Nat is Absurd (λ (b-1) (= Nat a-1 b-1))))))) ;; (claim =cases-same (Pi ((a Nat)) (=cases a a))) (define =cases-same (λ (a) (ind-Nat a (λ (x) (=cases x x)) sole (λ (a-1) (λ (ret) (same a-1)))))) use-Nat= : 生 Not 的函數 (claim use-Nat= (Pi ((a Nat) (b Nat)) (-\u003e (= Nat a b) (=cases a b)))) (define use-Nat= (λ (a b) (λ (a=b) (replace a=b ;; 不管是不是真的有就先replace =cases出來的值就對了， (λ (x) (=cases a x)) (=cases-same a))))) (claim 0!=n+1 (Pi ((n Nat)) (-\u003e (= Nat 0 (add1 n)) Absurd))) (define 0!=n+1 (λ (n) (use-Nat= 0 (add1 n)))) 1-!=-6 (claim dount-absurdity (-\u003e (= Nat 0 6) (= Atom 'hi 'wow))) (define dount-absurdity (λ (0=6) (ind-Absurd (0!=n+1 5 0=6) (= Atom 'hi 'wow)))) (claim sub1= (Pi ((n Nat) (j Nat)) (-\u003e (= Nat (add1 n) (add1 j)) (= Nat n j)))) (define sub1= (λ (n j) ;; (= Nat (add1 n) (add1 j)) 在 =cases 有!! ;; 而 use-Nat= 可以生出 =cases (use-Nat= (add1 n) (add1 j)))) (claim 1-!=-6 (-\u003e (= Nat 1 6) Absurd)) (define 1-!=-6 (λ (1=6) ;; 這裡就是假設有1=6這東西的地方(歸謬法) ((use-Nat= 0 5) ((sub1= 0 5) 1=6)))) front (claim front (Pi ((A U) (n Nat)) (-\u003e (Vec A (add1 n)) A))) ;; 這邊無法寫成(-\u003e (Vec A n) A))，因為有要求證明(= Nat n (add1 l))，會強迫把claim改成(-\u003e (Vec A (add1 n)) A))) (define front (λ (A n) (λ (v) ((ind-Vec (add1 n) v (λ (n v) (Pi ((l Nat)) (-\u003e (= Nat n (add1 l)) A))) ;; 要求當前的n必須至少大於1(是某個有1的數字) (λ (l) (λ (0=otherNat) (ind-Absurd (0!=n+1 l 0=otherNat) ;; 假設有0=otherNat的proof，來拉出Absurd A))) (λ (n a v-1) (λ (ret) (λ (l proofWhichWeDontNeed) a)))) n (same (add1 n)))))) 排中律(pem，principle excluded middle) 沒有直接的proof說他是對的或錯的 但我們可證明pem不是不對的\n當初用natural deduction在那邊想很久也沒寫出來，看了解答也是wtf(疑惑) 如今看這個也是wtf(讚嘆)\n(claim pem-not-false (Pi ((A U)) (-\u003e (-\u003e (Either A (-\u003e A Absurd)) Absurd) Absurd))) (define pem-not-false (λ (A) (λ (!PEM) (!PEM (right ;; (1) ?? (λ (a) ;; WTF 幹，我們有A的value了 ;; 教訓: 要有function type才有相對應的值 ;; 值的產生方式: 1. 直接造 2. 從function拉出來 (而function也是值，所以也可以直接造或從function拉出來) (!PEM (left a)))))))) decidable : function that decides whether they are true or false (claim Dec (-\u003e U U)) (define Dec (λ (X) (Either X (-\u003e X Absurd)))) (claim zero? (Pi ((n Nat)) (Dec (= Nat 0 n)))) (define zero? (λ (n) (ind-Nat n (λ (x) (Dec (= Nat 0 x))) (left (same 0)) (λ (n-1) (λ (ret) (right (0!=n+1 n-1))))))) nat=? (claim ?orez (Pi ((n Nat)) (Dec (= Nat n 0)))) (define ?orez (λ (n) (ind-Nat n (λ (x) (Dec (= Nat x 0))) (left (same 0)) (λ (n-1) (λ (ret) (right (n+1!=0 n-1))))))) (claim nat=? (Pi ((a Nat) (b Nat)) (Dec (= Nat a b)))) (define nat=? (λ (a b) ((ind-Nat a (λ (k) (Pi ((x Nat)) (Dec (= Nat k x)))) (λ (j) (zero? j)) (λ (a-1) (λ (ret) (λ (j) (ind-Nat j (λ (k) (Dec (= Nat (add1 a-1) k))) (?orez (add1 a-1)) (λ (j-1) (λ (ret2) (ind-Either (ret j-1) (λ (x) (Dec (= Nat (add1 a-1) (add1 j-1)))) (λ (lhs) (left (cong lhs (+ 1)))) (λ (rhs) (right (λ (a=j) (rhs (sub1= a-1 j-1 a=j))))))))))))) b))) TODO The Way Forward Rules are made to be spoken 等看過了\nPractical Foundations for Programming Languages, Types and Programming Languages, Semantics Engineering with PLT Redex. \u003c= Prefer this\n其中一本再說\n","wordCount":"1933","inLanguage":"en","datePublished":"2020-05-16T17:34:32Z","dateModified":"2020-05-16T17:34:32Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2020/05/little-typer-%E5%BE%8C%E7%AF%878~16-%E6%95%B4%E7%90%86%E8%88%87%E7%AD%86%E8%A8%98/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">little typer 後篇(8~16) 整理與筆記</h1><div class=post-meta><span title='2020-05-16 17:34:32 +0000 UTC'>May 16, 2020</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#ch8--ch9--ch10--ch11 aria-label="ch8 & ch9 & ch10 & ch11">ch8 & ch9 & ch10 & ch11</a><ul><li><a href=#incr-- aria-label="incr & +">incr & +</a></li><li><a href=#1add1 aria-label="+1=add1">+1=add1</a></li><li><a href=#incradd1 aria-label="incr=add1">incr=add1</a><ul><li><a href=#replace aria-label=replace>replace</a></li></ul></li><li><a href=#twicedouble aria-label="twice=double">twice=double</a><ul><li><a href=#add1add1 aria-label="+add1=add1+">+add1=add1+</a></li><li><a href=#twicedouble-with-add1add1 aria-label="twice=double with +add1=add1+">twice=double with +add1=add1+</a></li></ul></li><li><a href=#double-vec--twice-vec aria-label="double-vec & twice-vec">double-vec & twice-vec</a></li><li><a href=#%e7%94%a8type%e5%8e%bb%e6%93%8b%e6%8e%89%e4%b8%80%e4%ba%9b%e5%a5%87%e6%80%aa%e7%9a%84%e5%af%a6%e4%bd%9c aria-label=用type去擋掉一些奇怪的實作>用type去擋掉一些奇怪的實作</a><ul><li><a href=#list-vec aria-label="List->Vec">List->Vec</a></li></ul></li><li><a href=#%e7%94%a8%e8%ad%89%e6%98%8e%e5%8e%bb%e6%93%8b%e4%b8%80%e4%ba%9b%e5%a5%87%e6%80%aa%e7%9a%84%e5%af%a6%e4%bd%9c aria-label=用證明去擋一些奇怪的實作>用證明去擋一些奇怪的實作</a></li></ul></li><li><a href=#ch12--ch13 aria-label="ch12 & ch13">ch12 & ch13</a><ul><li><a href=#odd--even aria-label="odd & even">odd & even</a></li><li><a href=#2even aria-label="+2=even">+2=even</a></li><li><a href=#add1-even-odd aria-label="add1-even->odd">add1-even->odd</a></li><li><a href=#add1-odd-even aria-label="add1-odd->even">add1-odd->even</a></li><li><a href=#ackermann-function aria-label="ackermann function">ackermann function</a></li><li><a href=#even-or-odd aria-label=Even-or-Odd>Even-or-Odd</a></li></ul></li><li><a href=#ch14--ch15--ch16 aria-label="ch14 & ch15 & ch16">ch14 & ch15 & ch16</a><ul><li><a href=#maybe aria-label=Maybe>Maybe</a></li><li><a href=#maybe-head--maybe-tail aria-label="maybe-head & maybe-tail">maybe-head & maybe-tail</a></li><li><a href=#list-ref aria-label=list-ref>list-ref</a></li><li><a href=#absurd aria-label=Absurd!!>Absurd!!</a></li><li><a href=#vec-ref aria-label=vec-ref>vec-ref</a></li><li><a href=#consequence aria-label="=consequence">=consequence</a></li><li><a href=#use-nat--%e7%94%9f-not-%e7%9a%84%e5%87%bd%e6%95%b8 aria-label="use-Nat= : 生 Not 的函數">use-Nat= : 生 Not 的函數</a></li><li><a href=#1--6 aria-label="1-!=-6">1-!=-6</a></li><li><a href=#front aria-label=front>front</a></li><li><a href=#%e6%8e%92%e4%b8%ad%e5%be%8bpemprinciple-excluded-middle aria-label="排中律(pem，principle excluded middle)">排中律(pem，principle excluded middle)</a></li><li><a href=#decidable--function-that-decides-whether-they-are-true-or-false aria-label="decidable : function that decides whether they are true or false">decidable : function that decides whether they are true or false</a></li><li><a href=#nat aria-label="nat=?">nat=?</a></li></ul></li><li><a href=#todo aria-label=TODO>TODO</a></li></ul></div></details></div><div class=post-content><p>來證明啦</p><h2 id=ch8--ch9--ch10--ch11>ch8 & ch9 & ch10 & ch11<a hidden class=anchor aria-hidden=true href=#ch8--ch9--ch10--ch11>#</a></h2><p>現在說用type證明，但實際上怎麼做?</p><p>在claim寫下想證的東西，在define證出來</p><h3 id=incr-->incr & +<a hidden class=anchor aria-hidden=true href=#incr-->#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>incr</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>incr</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>iter-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nf>+</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>Nat</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nf>+</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>iter-Nat</span> <span class=nv>a</span>
</span></span><span class=line><span class=cl>      <span class=nv>b</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>add1</span> <span class=nv>ret</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=1add1>+1=add1<a hidden class=anchor aria-hidden=true href=#1add1>#</a></h3><p>證對於任何整數，add1等於+1</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>+1=add1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>))))</span>
</span></span></code></pre></div><p>所以我們需要一個value的type是<code>(= Nat (+ 1 n) (add1 n)))</code>
先把1帶入+中，會發現根本就是<code>(add1 n)</code></p><p>也就是兩邊都一樣，same!!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>+1=add1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>same</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span> <span class=nv>n</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=incradd1>incr=add1<a hidden class=anchor aria-hidden=true href=#incradd1>#</a></h3><p>同樣的來試試incr=add1</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>incr=add1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>a</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>incr</span> <span class=nv>a</span><span class=p>)</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>a</span><span class=p>))))</span>
</span></span></code></pre></div><p>直接帶入沒有像<code>+1=add1</code>之類的好事，只能用歸納法了
這裡對n做歸納</p><p>這裡motive與base都很好懂，那step呢?
同樣展開incr，會發現<code>(incr n) => (+ 1 n-1)</code>
而另一邊是add1，其實就是<code>(+ 1 n-1)</code></p><p>歸納法會回傳n-1的證明，那我們只要把它擴充成n的就好了
把n-1的兩邊同時<code>(+ 1)</code>，cong</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>incr=add1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>incr</span> <span class=nv>a</span><span class=p>)</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>a</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>same</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>prev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>cong</span> <span class=nv>prev</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span><span class=p>)))))))</span>
</span></span></code></pre></div><h4 id=replace>replace<a hidden class=anchor aria-hidden=true href=#replace>#</a></h4><p>雖然說incr=add1證好了，但這邊要介紹另一個工具來改寫一部份的type</p><p>歸納法會回傳n-1的證明(prev,<code>(= (incr n-1) (add1 n-1))</code>)，而我們要的證明是<code>(= (add1 (incr n-1)) (add1 (add1 n-1)))</code>，那利用prev去改寫
嗎?</p><p>把prev看成<code>(incr n-1)</code>可以變成<code>(add1 n-1)</code>，就可以用replace把出現<code>(incr n-1)</code>換成<code>(add1 n-1)</code></p><p>所以用<code>(same (add1 (incr n-1)))</code>，就有空間去換!!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>incr=add1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>incr</span> <span class=nv>a</span><span class=p>)</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>a</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>same</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>prev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>replace</span> <span class=nv>prev</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>add1</span> <span class=p>(</span><span class=nv>incr</span> <span class=nv>n-1</span><span class=p>))</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>k</span><span class=p>)))</span> <span class=c1>;; 這裡k就是要換的部分，當成挖空</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>same</span> <span class=p>(</span><span class=nv>add1</span> <span class=p>(</span><span class=nv>incr</span> <span class=nv>n-1</span><span class=p>)))))))))</span>
</span></span></code></pre></div><h3 id=twicedouble>twice=double<a hidden class=anchor aria-hidden=true href=#twicedouble>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>twice</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>twice</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>+</span> <span class=nv>n</span> <span class=nv>n</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>double</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>double</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>iter-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=mi>0</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>+</span> <span class=mi>2</span> <span class=nv>ret</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>twice=double</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>twice</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>n</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>twice=double</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>twice</span> <span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>k</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>same</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>prev</span><span class=p>)</span> <span class=c1>;; (= Nat (twice n-1) (double n-1))</span>
</span></span><span class=line><span class=cl>          <span class=nv>TODO</span><span class=p>)))))</span> 
</span></span></code></pre></div><p>在Pie可以用TODO去看現在Pie想要什麼type，會噴
<img loading=lazy src=https://i.imgur.com/hBo4ue9.png alt=TODO></p><p>整理一下，其實就是</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>add1</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>n-1</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n-1</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>add1</span> <span class=p>(</span><span class=nv>add1</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>n-1</span><span class=p>))))</span>
</span></span></code></pre></div><p>wow，我們有prev，<code>(= Nat (+ n-1 n-1) (double n-1))</code>，如果兩邊都變成(add1 (add1 &mldr;))的話，就能用cong了</p><p>所以要證<code>+add1=add1+</code></p><h4 id=add1add1>+add1=add1+<a hidden class=anchor aria-hidden=true href=#add1add1>#</a></h4><p>直接帶<code>(add1 n-1)</code>，到motive中
<code>(= Nat (+ (add1 (add1 n-1)) b) (+ (add1 n-1) (add1 b)))</code></p><p>而我們有prev，<code>(= Nat (+ (add1 n-1) b) (+ n-1 (add1 b)))</code></p><p>把<code>(= Nat (+ (add1 (add1 n-1)) b) (+ (add1 n-1) (add1 b)))</code>的add1拉出來變成<code>(= Nat (add1 (+ (add1 n-1)) b)) (add1 (+ n-1 (add1 b))))</code></p><p>只與prev差add1，用cong</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>add1+=+add1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>b</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>)</span> <span class=nv>b</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>n</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>b</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>add1+=+add1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>b</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>x</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>b</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>same</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>b</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span> <span class=nv>prev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>cong</span> <span class=nv>prev</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span><span class=p>))))))</span>
</span></span></code></pre></div><h4 id=twicedouble-with-add1add1>twice=double with +add1=add1+<a hidden class=anchor aria-hidden=true href=#twicedouble-with-add1add1>#</a></h4><p>可以回來證twice=double</p><p>用replace把位置換過來就可以cong了</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>twice=double</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>twice</span> <span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>k</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>same</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>prev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>replace</span> <span class=p>(</span><span class=nv>add1+=+add1</span> <span class=nv>n-1</span> <span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>n-1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>cong</span> <span class=nv>prev</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>2</span><span class=p>))))))))</span>
</span></span></code></pre></div><p>這裡也告訴我們位置不對是會影響證明的，下面的就是一個例子</p><h3 id=double-vec--twice-vec>double-vec & twice-vec<a hidden class=anchor aria-hidden=true href=#double-vec--twice-vec>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>double-vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>n</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>mot-double-vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>mot-double-vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>double-vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>mot-double-vec</span> <span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>v</span><span class=p>)</span> <span class=p>(</span><span class=k>the</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=mi>0</span><span class=p>)</span> <span class=nv>vecnil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span> <span class=nv>f</span> <span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>vec::</span> <span class=p>(</span><span class=nv>head</span> <span class=nv>v</span><span class=p>)</span> <span class=p>(</span><span class=nv>vec::</span> <span class=p>(</span><span class=nv>head</span> <span class=nv>v</span><span class=p>)</span> <span class=p>(</span><span class=nv>f</span> <span class=p>(</span><span class=nv>tail</span> <span class=nv>v</span><span class=p>))))))))</span>
</span></span></code></pre></div><p>直接寫寫看twice-vec，但會發現ind-Nat沒辦法用，要注意到twice-vec要求的base是n!!
用TODO會看到</p><p>double-vec
<img loading=lazy src=https://i.imgur.com/loc7tYG.png alt></p><p>twice-vec
<img loading=lazy src=https://i.imgur.com/tmgov7V.png alt></p><p>所以要寫twice-vec，可以
用replace把double-Vec的double換成twice</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>twice-vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>twice</span> <span class=nv>n</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>twice-vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>n</span> <span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>replace</span> <span class=p>(</span><span class=nv>symm</span> <span class=p>(</span><span class=nv>twice=double</span> <span class=nv>n</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=nv>x</span><span class=p>))</span> <span class=c1>;; 把要抽換的部分，抽象出來回傳type的函數</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>double-vec</span> <span class=nv>A</span> <span class=nv>n</span> <span class=nv>v</span><span class=p>))))</span> <span class=c1>;; base是值!!</span>
</span></span></code></pre></div><h3 id=用type去擋掉一些奇怪的實作>用type去擋掉一些奇怪的實作<a hidden class=anchor aria-hidden=true href=#用type去擋掉一些奇怪的實作>#</a></h3><h4 id=list-vec>List->Vec<a hidden class=anchor aria-hidden=true href=#list-vec>#</a></h4><p>看宣告好像很合理，但實作可以亂搞</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>List-&gt;Vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>Sigma</span> <span class=p>((</span><span class=nv>l</span> <span class=nv>Nat</span><span class=p>))</span> <span class=c1>;; Sigma是有一個的意思，所以這裡的意思是有一個nat可以滿足(vec A l)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=nv>l</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>List-&gt;Vec</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>E</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>es</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1>;; Sigma的實體是list</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nc>cons</span> <span class=mi>0</span> <span class=nv>vecnil</span><span class=p>))))</span> <span class=c1>;; WTF</span>
</span></span></code></pre></div><p>所以幫他加個條件，生出來的長度要與原本的一樣</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>List-&gt;Vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>l</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>len</span> <span class=nv>A</span> <span class=nv>l</span><span class=p>))))</span> <span class=c1>;; i am better</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>List-&gt;Vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>ind-List</span> <span class=nv>x</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>len</span> <span class=nv>A</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>the</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=mi>0</span><span class=p>)</span> <span class=nv>vecnil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>x-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>vec::</span> <span class=nv>a</span> <span class=nv>ret</span><span class=p>)))))))</span>
</span></span></code></pre></div><p>內容物不用一樣嗎? (書上其實有一個可以重複atom的function)
所以可以再寫證明</p><h3 id=用證明去擋一些奇怪的實作>用證明去擋一些奇怪的實作<a hidden class=anchor aria-hidden=true href=#用證明去擋一些奇怪的實作>#</a></h3><p>這裡是用Vec->List去寫一個證明，Vec->List與List->Vec的內容物實一樣的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Vec-&gt;List</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Vec-&gt;List</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>n</span> <span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Vec</span> <span class=nv>n</span> <span class=nv>v</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>v</span><span class=p>)</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>the</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span> <span class=nv>a</span> <span class=nv>v-1</span> <span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=err>::</span> <span class=nv>a</span> <span class=nv>ret</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Vec-&gt;List=List-&gt;Vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>l</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>=</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)</span> <span class=nv>l</span> <span class=p>(</span><span class=nv>Vec-&gt;List</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>len</span> <span class=nv>A</span> <span class=nv>l</span><span class=p>)</span> <span class=p>(</span><span class=nv>List-&gt;Vec</span> <span class=nv>A</span> <span class=nv>l</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Vec-&gt;List=List-&gt;Vec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-List</span> <span class=nv>l</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)</span> <span class=nv>x</span> <span class=p>(</span><span class=nv>Vec-&gt;List</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>len</span> <span class=nv>A</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>List-&gt;Vec</span> <span class=nv>A</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>same</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>l-1</span> <span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>cong</span> <span class=nv>ret</span> <span class=p>(</span><span class=k>the</span> <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>))</span> <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=err>::</span> <span class=nv>a</span> <span class=nv>x</span><span class=p>))))))))</span>
</span></span></code></pre></div><h2 id=ch12--ch13>ch12 & ch13<a hidden class=anchor aria-hidden=true href=#ch12--ch13>#</a></h2><p>數學套餐開始啦</p><h3 id=odd--even>odd & even<a hidden class=anchor aria-hidden=true href=#odd--even>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Even</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Even</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Sigma</span> <span class=p>((</span><span class=nv>x</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>n</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Odd</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Odd</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Sigma</span> <span class=p>((</span><span class=nv>x</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>n</span> <span class=p>(</span><span class=nv>add1</span> <span class=p>(</span><span class=nv>double</span> <span class=nv>x</span><span class=p>))))))</span>
</span></span></code></pre></div><h3 id=2even>+2=even<a hidden class=anchor aria-hidden=true href=#2even>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>+2=even</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Even</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>Even</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>2</span> <span class=nv>n</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>+2=even</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>eve</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>eve</span><span class=p>))</span> <span class=p>(</span><span class=nv>cong</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>eve</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>2</span><span class=p>)))))</span> <span class=c1>;;這邊不用用到歸納法，因為我們已經有 (Even n) 了!!</span>
</span></span></code></pre></div><h3 id=add1-even-odd>add1-even->odd<a hidden class=anchor aria-hidden=true href=#add1-even-odd>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>add1-even-&gt;odd</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Even</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>Odd</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>add1-even-&gt;odd</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>eve</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; (Even 10) =&gt; (5 (same 10))</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; (Odd 11)  =&gt; (5 (same 11))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>eve</span><span class=p>)</span> <span class=p>(</span><span class=nv>cong</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>eve</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=add1-odd-even>add1-odd->even<a hidden class=anchor aria-hidden=true href=#add1-odd-even>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>add1-odd-&gt;even</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Odd</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>Even</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>add1-odd-&gt;even</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>eve</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; (Odd 11)  =&gt; (5 (same 11))</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; (Even 12) =&gt; (6 (same 12))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nv>add1</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>eve</span><span class=p>))</span> <span class=p>(</span><span class=nv>cong</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>eve</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=ackermann-function>ackermann function<a hidden class=anchor aria-hidden=true href=#ackermann-function>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>rep</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>Nat</span><span class=p>)</span> <span class=nv>Nat</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>rep</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>f</span> <span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>iter-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>f</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>f</span> <span class=nv>ret</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=c1>;; (rep f 5) =&gt; (f (f (f (f (f 1)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>ackermann</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>Nat</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>ackermann</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>iter-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>rep</span> <span class=nv>ret</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=even-or-odd>Even-or-Odd<a hidden class=anchor aria-hidden=true href=#even-or-odd>#</a></h3><p>這裡用到ind-Either，Either是一種type，它只有兩種constructor，left與right</p><p>ind-Either，就只處理兩種case，left與right剩下就是motive</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Even-or-Odd</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Either</span> <span class=p>(</span><span class=nv>Even</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>Odd</span> <span class=nv>n</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Even-or-Odd</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Either</span> <span class=p>(</span><span class=nv>Even</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Odd</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>left</span> <span class=p>(</span><span class=k>the</span> <span class=p>(</span><span class=nv>Even</span> <span class=mi>0</span><span class=p>)</span> <span class=p>(</span><span class=nc>cons</span> <span class=mi>0</span> <span class=p>(</span><span class=nv>same</span> <span class=mi>0</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>ind-Either</span> <span class=nv>ret</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>e</span><span class=p>)</span> <span class=p>(</span><span class=nv>Either</span> <span class=p>(</span><span class=nv>Even</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n-1</span><span class=p>))</span> <span class=p>(</span><span class=nv>Odd</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n-1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>left-val</span><span class=p>)</span>  <span class=p>(</span><span class=nv>right</span> <span class=p>(</span><span class=nv>add1-even-&gt;odd</span> <span class=nv>n-1</span> <span class=nv>left-val</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>right-val</span><span class=p>)</span> <span class=p>(</span><span class=nv>left</span>  <span class=p>(</span><span class=nv>add1-odd-&gt;even</span> <span class=nv>n-1</span> <span class=nv>right-val</span><span class=p>)))))))))</span>
</span></span></code></pre></div><h2 id=ch14--ch15--ch16>ch14 & ch15 & ch16<a hidden class=anchor aria-hidden=true href=#ch14--ch15--ch16>#</a></h2><p>也有數學套餐，但多Absurd與bem與deciable了!!</p><h3 id=maybe>Maybe<a hidden class=anchor aria-hidden=true href=#maybe>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Maybe</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>U</span> <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Maybe</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>Either</span> <span class=nv>A</span> <span class=nv>Trivial</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Nothing</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Maybe</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Nothing</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>right</span> <span class=nv>sole</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Just</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>a</span> <span class=nv>A</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Maybe</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Just</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>left</span> <span class=nv>a</span><span class=p>)))</span>
</span></span></code></pre></div><h3 id=maybe-head--maybe-tail>maybe-head & maybe-tail<a hidden class=anchor aria-hidden=true href=#maybe-head--maybe-tail>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>maybe-head</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>l</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Maybe</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>maybe-head</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>rec-List</span> <span class=nv>l</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>Nothing</span> <span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>l-1</span> <span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>Just</span> <span class=nv>A</span> <span class=nv>a</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>maybe-tail</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>l</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Maybe</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>maybe-tail</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>rec-List</span> <span class=nv>l</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>Nothing</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>l-1</span> <span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>Just</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)</span> <span class=nv>l-1</span><span class=p>)))))</span>
</span></span></code></pre></div><h3 id=list-ref>list-ref<a hidden class=anchor aria-hidden=true href=#list-ref>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>list-ref</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>i</span> <span class=nv>Nat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>l</span> <span class=p>(</span><span class=nv>List</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Maybe</span> <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>list-ref</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>rec-Nat</span> <span class=nv>i</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>maybe-head</span> <span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>i-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>ind-Either</span> <span class=p>(</span><span class=nv>maybe-tail</span> <span class=nv>A</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Maybe</span> <span class=nv>A</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>lhs</span><span class=p>)</span> <span class=p>(</span><span class=nv>ret</span> <span class=nv>lhs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>rhs</span><span class=p>)</span> <span class=p>(</span><span class=nv>Nothing</span> <span class=nv>A</span><span class=p>)))))))))</span>
</span></span></code></pre></div><h3 id=absurd>Absurd!!<a hidden class=anchor aria-hidden=true href=#absurd>#</a></h3><p>這個要給多一點尊重</p><p>Absurd是type但沒有<em>任何值</em> (WTF)</p><p>但是有eliminator (WTF)
eliminate後可以生出任何值 (WTF)</p><blockquote><p>If a false statement were true, then we might as well say anything at all.
(the Principle of Explosion or ex falso quodlibet, which means “from false, anything.”)</p></blockquote><p>Q: 如果沒有值怎麼eliminate?
A: 假裝有 (從lambda的參數來)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>1=6</span><span class=p>)</span> <span class=c1>;; WTF</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Absurd</span> <span class=nv>1=6</span>
</span></span><span class=line><span class=cl>        <span class=nv>{return</span> <span class=nv>type}</span><span class=p>))</span>
</span></span></code></pre></div><p>所以Not就是<code>(-> X Absurd)</code>，也就是X只能推出Absurd，什麼都沒有，也就是沒有證明</p><h3 id=vec-ref>vec-ref<a hidden class=anchor aria-hidden=true href=#vec-ref>#</a></h3><p>這個十分複雜，看不懂沒差，但說說大該是怎麼做的</p><p>用Fin去控制vec要不要繼續往下走，看ind-Ether
如果真的走到空(base case)，用ind-Absurd把Absurd劃掉(這樣就是total function了)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>vec-ref</span> <span class=nv>Nat</span> <span class=mi>4</span> <span class=p>(</span><span class=nv>fzero</span> <span class=mi>3</span><span class=p>)</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>1</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>3</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>4</span> <span class=nv>vecnil</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=c1>;; (the Nat 1)</span>
</span></span><span class=line><span class=cl> <span class=p>(</span><span class=nv>vec-ref</span> <span class=nv>Nat</span> <span class=mi>4</span> <span class=p>(</span><span class=nv>fadd1</span> <span class=mi>3</span> <span class=p>(</span><span class=nv>fzero</span> <span class=mi>2</span><span class=p>))</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>1</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>3</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>4</span> <span class=nv>vecnil</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=c1>;; (the Nat 2)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>vec-ref</span> <span class=nv>Nat</span> <span class=mi>4</span> <span class=p>(</span><span class=nv>fadd1</span> <span class=mi>3</span> <span class=p>(</span><span class=nv>fadd1</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>fzero</span> <span class=mi>1</span><span class=p>)))</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>1</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>2</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>3</span> <span class=p>(</span><span class=nv>vec::</span> <span class=mi>4</span> <span class=nv>vecnil</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=c1>;; (the Nat 3)</span>
</span></span></code></pre></div><p>把<code>fadd1</code>與<code>fzero</code>看成<code>tail</code>與<code>head</code>，所以<code>vec-ref</code>的任務是把一連串<code>fadd1</code>與<code>fzero</code>用成<code>tail</code>與<code>head</code>在Vec上跑</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Fin</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Fin</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>iter-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=nv>Absurd</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>Maybe</span> <span class=nv>ret</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=c1>;; 每一個Maybe會分岔出Nothing，所以在iter時都有機會可以到base case</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>fzero</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Fin</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>fzero</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Nothing</span> <span class=p>(</span><span class=nv>Fin</span> <span class=nv>n</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>fadd1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Fin</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>Fin</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>fadd1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>fin</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Just</span> <span class=p>(</span><span class=nv>Fin</span> <span class=nv>n</span><span class=p>)</span> <span class=nv>fin</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>vec-ref</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>i</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Fin</span> <span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=nv>k</span><span class=p>)</span> <span class=nv>A</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>fin</span> <span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>ind-Absurd</span> <span class=nv>fin</span>
</span></span><span class=line><span class=cl>          <span class=nv>A</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>i-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>fin</span> <span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>ind-Either</span> <span class=nv>fin</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span> <span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>lhs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>ret</span> <span class=nv>lhs</span> <span class=p>(</span><span class=nv>tail</span> <span class=nv>v</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>rhs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>head</span> <span class=nv>v</span><span class=p>)))))))))</span>
</span></span></code></pre></div><h3 id=consequence>=consequence<a hidden class=anchor aria-hidden=true href=#consequence>#</a></h3><table><thead><tr><th></th><th>0</th><th>(add1 j-1)</th></tr></thead><tbody><tr><td>0</td><td>Trivial</td><td>Absurd</td></tr><tr><td>(add1 n-1)</td><td>Absurd</td><td>(= Nat (add1 n-1) (add1 j-1))</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>=cases</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>Nat</span> <span class=nv>Nat</span> <span class=nv>U</span><span class=p>))</span> <span class=c1>;; U 就是兩個比較後，可以知道什麼</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>=cases</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>which-Nat</span> <span class=nv>a</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>which-Nat</span> <span class=nv>b</span>
</span></span><span class=line><span class=cl>        <span class=nv>Trivial</span>           <span class=c1>;; 0 = 0 is trivial</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>b-1</span><span class=p>)</span> <span class=nv>Absurd</span><span class=p>))</span> <span class=c1>;; 0 = other Nat is Absurd</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>which-Nat</span> <span class=nv>b</span>
</span></span><span class=line><span class=cl>          <span class=nv>Absurd</span>          <span class=c1>;; other = 0 Nat is Absurd</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>b-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>a-1</span> <span class=nv>b-1</span><span class=p>)))))))</span> <span class=c1>;;</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>=cases-same</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>a</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>=cases</span> <span class=nv>a</span> <span class=nv>a</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>=cases-same</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>a</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>=cases</span> <span class=nv>x</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=nv>sole</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>same</span> <span class=nv>a-1</span><span class=p>))))))</span>
</span></span></code></pre></div><h3 id=use-nat--生-not-的函數>use-Nat= : 生 Not 的函數<a hidden class=anchor aria-hidden=true href=#use-nat--生-not-的函數>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>use-Nat=</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>a</span> <span class=nv>Nat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>b</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>a</span> <span class=nv>b</span><span class=p>)</span> <span class=p>(</span><span class=nv>=cases</span> <span class=nv>a</span> <span class=nv>b</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>use-Nat=</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a=b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>replace</span> <span class=nv>a=b</span> <span class=c1>;; 不管是不是真的有就先replace =cases出來的值就對了，</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>=cases</span> <span class=nv>a</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>=cases-same</span> <span class=nv>a</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>0!=n+1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=mi>0</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>))</span> <span class=nv>Absurd</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>0!=n+1</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>use-Nat=</span> <span class=mi>0</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>))))</span>
</span></span></code></pre></div><p><img loading=lazy src=https://i.imgur.com/H2s7xPC.png alt></p><h3 id=1--6>1-!=-6<a hidden class=anchor aria-hidden=true href=#1--6>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>dount-absurdity</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=mi>0</span> <span class=mi>6</span><span class=p>)</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Atom</span> <span class=ss>&#39;hi</span> <span class=ss>&#39;wow</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>dount-absurdity</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>0=6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Absurd</span> <span class=p>(</span><span class=nv>0!=n+1</span> <span class=mi>5</span> <span class=nv>0=6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>=</span> <span class=nv>Atom</span> <span class=ss>&#39;hi</span> <span class=ss>&#39;wow</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>sub1=</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>j</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>j</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>n</span> <span class=nv>j</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>sub1=</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; (= Nat (add1 n) (add1 j)) 在 =cases 有!!</span>
</span></span><span class=line><span class=cl>    <span class=c1>;; 而 use-Nat= 可以生出 =cases</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>use-Nat=</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>)</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>j</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>1-!=-6</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=mi>1</span> <span class=mi>6</span><span class=p>)</span> <span class=nv>Absurd</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>1-!=-6</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>1=6</span><span class=p>)</span> <span class=c1>;; 這裡就是假設有1=6這東西的地方(歸謬法)</span>
</span></span><span class=line><span class=cl>    <span class=p>((</span><span class=nv>use-Nat=</span> <span class=mi>0</span> <span class=mi>5</span><span class=p>)</span> <span class=p>((</span><span class=nv>sub1=</span> <span class=mi>0</span> <span class=mi>5</span><span class=p>)</span> <span class=nv>1=6</span><span class=p>))))</span>
</span></span></code></pre></div><h3 id=front>front<a hidden class=anchor aria-hidden=true href=#front>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>front</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Vec</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>))</span> <span class=nv>A</span><span class=p>)))</span> <span class=c1>;; 這邊無法寫成(-&gt; (Vec A n) A))，因為有要求證明(= Nat n (add1 l))，會強迫把claim改成(-&gt; (Vec A (add1 n)) A)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>front</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nv>ind-Vec</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>)</span> <span class=nv>v</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>l</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>n</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>l</span><span class=p>))</span> <span class=nv>A</span><span class=p>)))</span> <span class=c1>;; 要求當前的n必須至少大於1(是某個有1的數字)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>0=otherNat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>ind-Absurd</span> <span class=p>(</span><span class=nv>0!=n+1</span> <span class=nv>l</span> <span class=nv>0=otherNat</span><span class=p>)</span> <span class=c1>;; 假設有0=otherNat的proof，來拉出Absurd</span>
</span></span><span class=line><span class=cl>                 <span class=nv>A</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span> <span class=nv>a</span> <span class=nv>v-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>l</span> <span class=nv>proofWhichWeDontNeed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=nv>a</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>        <span class=nv>n</span> <span class=p>(</span><span class=nv>same</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>n</span><span class=p>))))))</span>
</span></span></code></pre></div><h3 id=排中律pemprinciple-excluded-middle>排中律(pem，principle excluded middle)<a hidden class=anchor aria-hidden=true href=#排中律pemprinciple-excluded-middle>#</a></h3><p><img loading=lazy src=https://i.imgur.com/e9MCa5M.png alt></p><p>沒有直接的proof說他是對的或錯的
但我們可證明pem不是不對的</p><p>當初用natural deduction在那邊想很久也沒寫出來，看了解答也是wtf(疑惑)
如今看這個也是wtf(讚嘆)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>pem-not-false</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>A</span> <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>-&gt;</span> <span class=p>(</span><span class=nv>Either</span> <span class=nv>A</span> <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>A</span> <span class=nv>Absurd</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=nv>Absurd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>Absurd</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>pem-not-false</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>A</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>!PEM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>!PEM</span> <span class=p>(</span><span class=nv>right</span> <span class=c1>;; (1) ??</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span><span class=p>)</span> <span class=c1>;; WTF 幹，我們有A的value了</span>
</span></span><span class=line><span class=cl>                <span class=c1>;; 教訓: 要有function type才有相對應的值</span>
</span></span><span class=line><span class=cl>                <span class=c1>;; 值的產生方式: 1. 直接造 2. 從function拉出來 (而function也是值，所以也可以直接造或從function拉出來)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>!PEM</span> <span class=p>(</span><span class=nv>left</span> <span class=nv>a</span><span class=p>))))))))</span>
</span></span></code></pre></div><h3 id=decidable--function-that-decides-whether-they-are-true-or-false>decidable : function that decides whether they are true or false<a hidden class=anchor aria-hidden=true href=#decidable--function-that-decides-whether-they-are-true-or-false>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>Dec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>U</span> <span class=nv>U</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>Dec</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>X</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Either</span> <span class=nv>X</span> <span class=p>(</span><span class=nv>-&gt;</span> <span class=nv>X</span> <span class=nv>Absurd</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>zero?</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=mi>0</span> <span class=nv>n</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>zero?</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=mi>0</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>left</span> <span class=p>(</span><span class=nv>same</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>right</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>0!=n+1</span> <span class=nv>n-1</span><span class=p>)))))))</span>
</span></span></code></pre></div><h3 id=nat>nat=?<a hidden class=anchor aria-hidden=true href=#nat>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>?orez</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>n</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>n</span> <span class=mi>0</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>?orez</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>n</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>x</span> <span class=mi>0</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>left</span> <span class=p>(</span><span class=nv>same</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>n-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>right</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>n+1!=0</span> <span class=nv>n-1</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>claim</span> <span class=nv>nat=?</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>a</span> <span class=nv>Nat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>b</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>a</span> <span class=nv>b</span><span class=p>))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span> <span class=nv>nat=?</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a</span> <span class=nv>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>((</span><span class=nv>ind-Nat</span> <span class=nv>a</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nv>Pi</span> <span class=p>((</span><span class=nv>x</span> <span class=nv>Nat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=nv>k</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>j</span><span class=p>)</span> <span class=p>(</span><span class=nv>zero?</span> <span class=nv>j</span><span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>             <span class=p>(</span><span class=nv>ind-Nat</span> <span class=nv>j</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>k</span><span class=p>)</span> <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>a-1</span><span class=p>)</span> <span class=nv>k</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>?orez</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>a-1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>j-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                 <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>ret2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                   <span class=p>(</span><span class=nv>ind-Either</span> <span class=p>(</span><span class=nv>ret</span> <span class=nv>j-1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>Dec</span> <span class=p>(</span><span class=nf>=</span> <span class=nv>Nat</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>a-1</span><span class=p>)</span> <span class=p>(</span><span class=nv>add1</span> <span class=nv>j-1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>lhs</span><span class=p>)</span> <span class=p>(</span><span class=nv>left</span> <span class=p>(</span><span class=nv>cong</span> <span class=nv>lhs</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>1</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                     <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>rhs</span><span class=p>)</span> <span class=p>(</span><span class=nv>right</span> <span class=p>(</span><span class=nv>λ</span> <span class=p>(</span><span class=nv>a=j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                       <span class=p>(</span><span class=nv>rhs</span> <span class=p>(</span><span class=nv>sub1=</span> <span class=nv>a-1</span> <span class=nv>j-1</span> <span class=nv>a=j</span><span class=p>)))))))))))))</span>
</span></span><span class=line><span class=cl>      <span class=nv>b</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=todo>TODO<a hidden class=anchor aria-hidden=true href=#todo>#</a></h2><ul><li>The Way Forward</li><li>Rules are made to be spoken</li></ul><p>等看過了</p><p>Practical Foundations for Programming Languages,
Types and Programming Languages,
Semantics Engineering with PLT Redex. &lt;= Prefer this</p><p>其中一本再說</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/lisp/>Lisp</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2020/05/the-little-mler-%E7%AD%86%E8%A8%98/><span class=title>« Prev</span><br><span>The Little MLer 筆記</span>
</a><a class=next href=https://littlebees.github.io/2020/05/little-typer-%E5%89%8D%E7%AF%871~7-%E6%95%B4%E7%90%86%E8%88%87%E7%AD%86%E8%A8%98/><span class=title>Next »</span><br><span>little typer 前篇(1~7) 整理與筆記</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>