<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>The little prover 筆記 | 記事本</title>
<meta name=keywords content="Lisp"><meta name=description content="動機
久遠筆記搬到github這裡，不過也是改寫超多東西的"><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2021/07/the-little-prover-%E7%AD%86%E8%A8%98/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="The little prover 筆記"><meta property="og:description" content="動機
久遠筆記搬到github這裡，不過也是改寫超多東西的"><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2021/07/the-little-prover-%E7%AD%86%E8%A8%98/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-14T00:30:09+00:00"><meta property="article:modified_time" content="2021-07-14T00:30:09+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="The little prover 筆記"><meta name=twitter:description content="動機
久遠筆記搬到github這裡，不過也是改寫超多東西的"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"The little prover 筆記","item":"https://littlebees.github.io/2021/07/the-little-prover-%E7%AD%86%E8%A8%98/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"The little prover 筆記","name":"The little prover 筆記","description":"動機 久遠筆記搬到github這裡，不過也是改寫超多東西的\n","keywords":["Lisp"],"articleBody":"動機 久遠筆記搬到github這裡，不過也是改寫超多東西的\nkeyword premise，在if的條件有可以用在想改寫的東西\ntheorem，永遠為true的expression (要證過)\naxiom，不用證明的theorem\nclaim，還沒證的theorem\ndefun，函數，但應該當成類似macro的東西\ntotal，不論什麼參數都會有值的函數\naxioms (dethm equal-same (x) (equal (equal x x) 't)) (dethm equal-swap (x y) (equal (equal x y) (equal y x))) (dethm equal-if (x y) (if (equal x y) (equal x y) 't)) (dethm if-true (x y) (equal (if 't x y) x)) (dethm if-false (x y) (equal (if 'nil x y) y)) (dethm if-same (x y) (equal (if x y y) y)) (dethm if-nest-A (x y z) (if x (equal (if x y z) y) 't)) (dethm if-nest-E (x y z) (if x 't (equal (if x y z) z))) (dethm atom/cons (x y) (equal (atom (cons x y)) 'nil)) (dethm car/cons (x y) (equal (car (cons x y)) x)) (dethm cons/car+cdr (x) (if (atom x) 't (equal (cons (car x) (cdr x)) x))) (dethm cdr/cons (x y) (equal (cdr (cons x y)) y)) (dethm natp/size (x) (equal (natp (size x)) 't)) (dethm size/car (x) (if (atom x) 't (equal (\u003c (size (car x)) (size x)) 't))) (dethm size/cdr (x) (if (atom x) 't (equal (\u003c (size (cdr x)) (size x)) 't))) (dethm identity-+ (x) (if (natp x) (equal (+ 0 x) x) ‘t)) (dethm commute-+ (x y) (equal (+ x y) (+ y x))) (dethm associate+ (x y z) (equal (+ (+ x y) z) (+ x (+ y z)))) (dethm positives+ (x y) (if (\u003c 0 x) (if (\u003c 0 y) (equal (\u003c 0 (+ x y)) ‘t) ‘t) ‘t)) (dethm natp+ (x y) (if (natp x) (if (natp y) (equal (natp (+ x y)) ‘t) ‘t) ‘t)) (dethm common-addends-\u003c (x y z) (equal (\u003c (+ x z) (+ y z)) (\u003c x y))) 怎麼用theorem 要改寫用的equal只能在if-answer或if-else，同時該equal不能出現在if-question或function call的參數中．\n(dethm ?? (x) (if (A x) (if (B x) (equal (F1 x) '1) (equal (F2 x) '2)) (if (C x) (equal (F3 x) '3) (equal (F4 x) '4)))) (cons 'gyre (if (C '(callooh callay)) (cons 'gimble (if (A '(callooh callay)) (cons '1 '(outgrabe)) (cons '3 '(wabe)))) (cons (F4 '(callooh callay)) '(vorpal)))) 試著用??來改寫這個式子．\n(F4 '(callooh callay))能被改寫成’4嗎？\n有C的前提，同時該位置也在if-else，但是沒有A的前提，所以不行．\n那1與3可以改寫成(F1 …)與(F2 …)嗎？\n可以！！\nA與C的前提都有，同時都在相對應的位置上，所以可以．\n要total才行，partial function (defun partial (x) (if (partial x) 'nil 't)) (dethm contradiction () 'nil)\n‘nil -\u003e if-same\n(if (partial x) nil nil) -\u003e if-nest-A (enlarge\n(if (partial x) (if (partial x) nil t) ‘nil) -\u003e if-nest-E (enlarge\n(if (partial x) (if (partial x) nil t) (if (partial x) t nil)) -\u003e expand(use) (partial x) (self-reference)\n(if (partial x) (if (if (partial x) nil t) nil t) (if (if (partial x) nil t) t nil)) -\u003e if-nest-A \u0026 if-nest-E (shrink\n(if (....) (if nil nil t) (if t t nil)) -\u003e t\nmeasure measure，追蹤某個參數的長度 (證明遞迴會收斂)\n(defun sub (x y) (if (atom y) (if (equal y '?) x y) (cons (sub x (car y)) (sub x (cdr y))))) measure: (size y) totality claim\n(if (natp (size x)) (if (atom x) 't (\u003c (size (cdr x)) (size x))) 'nil) If Lifting (A (if x y z)) -\u003e (if x (A y) (A z))\n(ctx (focus (if Q A E))) =\u003e if-same\n(ctx (if Q (focus (if Q A E)) (focus (if Q A E)))) =\u003e if-next-A\u0026E\n(ctx (if Q (focus A) (focus E))) 做Totality Claims (defun add-atoms (x ys) (if (atom x) (if (member? x ys) ys (cons x ys)) (add-atoms (car x) (add-atoms (cdr x) ys)))) 基本上就是把每一次遞迴所apply的參數，apply到measure去，同時寫下這次遞迴比原本的measure小\n針對每個case建分支 (if (atom x) ... ...) 找自己的遞迴，沒有的直接換成’t (if (atom x) 't ...) 從第一個遞迴開始轉成measure，measure參數代此遞迴的參數，如果不只一個就用if包起來 (if (atom x) 't (if (\u003c (size (car x)) (size x)) (\u003c (size (cdr x)) (size x)) nil)) 最後用natp包起來(證明size是自然數) (if (natp (size x)) (if (atom x) 't (if (\u003c (size (car x)) (size x)) (\u003c (size (cdr x)) (size x)) 'nil)) 'nil) 做induction template (defun set? (xs) (if (atom xs) 't (if (member? (car xs) (cdr xs)) 'nil (set? (cdr xs))))) (defun add-atoms (x ys) (if (atom x) (if (member? x ys) ys (cons x ys)) (add-atoms (car x) (add-atoms (cdr x) ys)))) (dethm set?/add-atoms (a) (equal (set? (add-atoms a '())) 't)) 把所有東西參數化 (equal (set? (add-atoms a bs)) 't) 分析裡面的參數，讓他在所有情況下都會成立 先從bs開始，因為在add-atoms裡面他沒有涉及到遞迴的部分，比較簡單\n要怎麼讓(equal (set? (add-atoms a bs)) 't)成立? bs要讓set?為’t\n讓主體的前提滿足 (if (set? bs) (equal (set? (add-atoms a bs)) 't) 't)) 只要有bs都會有這一段，等一下還會看到很多次\n接著是a，他有兩個case\natom，沒有遞迴，直接抄前面的\n(if (atom a) (if (set? bs) (equal (set? (add-atoms a bs)) 't) 't)) ...) list，有遞迴裡面有遞迴!! (add-atoms (car x) (add-atoms (cdr x) ys))\n先處理最外面的add-atoms，直接把(car x)與(add-atoms (cdr x) ys)當成input，試著讓我們要證的東西成立\n(if (set? (add-atoms (cdr x) ys)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) ys))) 't) 't)) 剛剛是第一個前提，接著是(add-atoms (cdr x) ys)，用同樣的方法\n(if (set? (cdr x)) (equal (set? (add-atoms (cdr x) ys) 't) 't)) 這是第二個前提，我們把所有前依據以順序組合在一起(用if)\n(if (atom a) (if (set? bs) (equal (set? (add-atoms a bs)) 't) 't) (if (if (set? (add-atoms (cdr x) ys)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) ys))) 't) 't) (if (if (set? (cdr x)) (equal (set? (add-atoms (cdr x) ys) 't) 't)) ... 't))) 最後的…，就是我們在這個case原本想證的東西\n(if (atom a) (if (set? bs) (equal (set? (add-atoms a bs)) 't) 't) (if (if (set? (add-atoms (cdr x) ys)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) ys))) 't) 't) (if (if (set? (cdr x)) (equal (set? (add-atoms (cdr x) ys) 't) 't)) (if (set? bs) (equal (set? (add-atoms a bs)) 't) 't)) 't))) 等等，有些變數對不上啊 其實變數就依據case的變數去改就好，alpha reduction\n(if (atom x) (if (set? ys) (equal (set? (add-atoms a ys)) 't) 't) (if (if (set? (add-atoms (cdr x) ys)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) ys))) 't) 't) (if (if (set? (cdr x)) (equal (set? (add-atoms (cdr x) ys) 't) 't)) (if (set? ys) (equal (set? (add-atoms x ys)) 't) 't)) 't))) 看到這裡，會發現totality claim與induction template的做法其實很像\n分析case 從被遞迴的input開始，切case 沒遞迴的case就是滿足其他參數的條件，包好就完成沒遞迴的case 遞迴的case要從最外層的遞迴一層一層建，建法與沒遞迴的case的結果很像，不過參數要代成遞迴時代入的參數 把所有前提寫完，就把要證的帶進去，當然要注意其他參數的條件要滿足!! 這邊附上兩個常見template\nProof by List Induction measure: (size x)\n(if (atom x) C (if Ccdr C 't)) Proof by Star Induction measure: (size x)\n(if (atom x) C (if Ccar (if Ccdr C t) 't)) Insights 選好做的 But some approaches will find a proof faster than others.\n(equal (if (equal (first-of (cons a (cons '? '()))) '?) 't (equal (second-of (cons a (cons '? '()))) ?)) ‘t) 如果從second-of開始改寫，會變成’t，就可以if-same再改成’t\n這樣就不用管first-of如何．\nInsight: Rewrite from the Inside Out 從if-ans,if-else, arg來改寫，再apply func，如果真的不行了，再改寫外部．\nInsight: Pull Ifs Outward 當if被func或其他if包起來時，用if lifting把if拉出來．\nInsight: Keep Theorems in Mind 看到可以用的就用，看到很像的，想辦法改寫到可以用．\nInsight: Don’t Touch Inductive Premises 歸納前提就是重點，不要動\n如果不能用，也許是\n用錯歸納法template了 需要其他lemma Insight: Combine Ifs 用if lifting把if條件中的if拿出來\nInsight: Create Helpers for Induction To rewrite the application of a recursive function, prove a separate theorem about the recursive function using induction. Do this if the current proof either does not use induction, or uses induction for a different kind of recursion from the function, or uses induction on different arguments from the application.\nInsight: Create Helpers for Repetition If a proof performs similar sequences of steps over and over, state a theorem that can perform the same rewrite as those steps via the Law of Dethm. Use that theorem in place of the sequence of steps to shorten the proof.\nproof for memb?/remb (defun remb (xs) (if (atom xs) '() (if (equal (car xs) '?) (remb (cdr xs)) (cons (car xs) (remb (cdr xs)))))) (defun memb? (xs) (if (atom xs) 'nil (if (equal (car xs) '?) 't (memb? (cdr xs))))) (dethm memb?/remb (xs) (equal (memb? (remb xs)) 'nil)) the inductive claim\n(if (atom xs) (equal (memb? (remb xs)) 'nil) (if (equal (memb? (remb (cdr xs))) 'nil) (equal (memb? (remb xs)) 'nil) 't)) 先從(atom xs)的if-ans開始\n(if (atom xs) (equal (memb? (if (atom xs) ‘() (if (equal (car xs) ‘?) (remb (cdr xs)) (cons (car xs) (remb (cdr xs)))))) nil) ...) -\u003e if-nest-A\n(if (atom xs) (equal (memb? ‘()) nil) ...) -\u003e expand memb? \u0026 atom \u0026 if-true\n(if (atom xs) 't ...) 接著是not (atom xs)與(equal (memb? (remb (cdr xs))) nil)\n(equal (memb? (remb xs)) nil)\n-\u003e remb\n(equal (memb? (if (atom xs) ‘() (if (equal (car xs) ‘?) (remb (cdr xs) (cons (car xs) (remb (cdr xs))))) nil) -\u003e if-nest-E \u0026 if lifting for memb?\n(equal (if (equal (car xs) ‘?) (memb? (remb (cdr xs)) (memb? (cons (car xs) (remb (cdr xs))))) nil) -\u003e inductive premise\n(equal (if (equal (car xs) ‘?) nil (memb? (cons (car xs) (remb (cdr xs))))) nil) -\u003e memb?\n(equal (if (equal (car xs) ‘?) nil (if (atom (cons (car xs) (remb (cdr xs)))) ‘nil (if (equal (car (cons (car xs) (remb (cdr xs)))) ‘?) ‘t (memb? (cdr (cons (car xs) (remb (cdr xs))))))) nil) -\u003e atom/cons \u0026 if-false\n(equal (if (equal (car xs) ‘?) nil (if (equal (car (cons (car xs) (remb (cdr xs)))) ‘?) ‘t (memb? (cdr (cons (car xs) (remb (cdr xs)))))) nil) -\u003e car/cons \u0026 if-false \u0026 cdr/cons \u0026 inductive premise\n(equal (if (...) nil nil) nil) -\u003e if-same \u0026 equal-same\nt proof for ctx?/sub (defun ctx? (x) (if (atom x) (equal x '?) (if (ctx? (car x)) 't (ctx? (cdr x))))) (defun sub (x y) (if (atom y) (if (equal y '?) x y) (cons (sub x (car y)) (sub x (cdr y))))) 證\n(dethm ctx?/sub (x y) (if (ctx? x) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) 't)) 把body填入templete(有夠噁心的\n(if (atom y) (if (ctx? x) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) 't) (if (if (ctx? x) (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) 't) (if (if (ctx? x) (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) ‘t) (if (ctx? x) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) 't) 't) ‘t)) 先看到有一堆(if (ctx? x)，用if lifting抽出來(這裡就不好用(A (if …)) -\u003e (if (A ….))來理解，要用if-same來做就很直覺)\n同時把if-else的部分用if-same去掉\n(if (ctx? x) (if (atom y) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) (if (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) 't) ‘t)) 't) 對sub用if-nest-A\n(if (ctx? x) (if (atom y) (if (ctx? y) (equal (ctx? (if (equal y '?) x y)) 't) 't) (if (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) 't) ‘t)) 't) if lifting\n(if (ctx? x) ;; 可以用這個改寫成’t嗎 (if (atom y) (if (ctx? y) (if (equal y '?) (equal (ctx? x) 't) ;; 不行，(ctx? x)可以是’t以外的東西(total)，也沒定理 (equal (ctx? y) 't)) 't) (if (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) 't) ‘t)) 't) 但ctx?只會回傳’t或’nil而且如果我們有這種定理的話？\n(dethm ctx?/t (x) (if (ctx? x) (equal (ctx? x) ‘t) ‘t)) 那就可以改寫了\n(if (ctx? x) (if (atom y) (if (ctx? y) (if (equal y '?) ‘t ‘t)) 't) (if (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? y) (equal (ctx? (sub x y)) 't) 't) 't) ‘t)) 't) if-same*2\n(if (ctx? x) (if (atom y) ‘t (if (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? y) (equal (ctx? (sub x y) 't) 't) 't) ‘t)) 't) atom與if-nest-E\n(if (ctx? x) (if (atom y) ‘t (if (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? y) (equal (ctx? (cons (sub x (car y)) (sub (cdr y)))) 't) 't) 't) ‘t)) 't) ctx?\n(if (ctx? x) (if (atom y) ‘t (if (if (ctx? (car y)) (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? y) (equal (if (ctx? (sub x (car y))) ‘t (ctx? (sub x (cdr y)))) 't) 't) 't) ‘t)) 't) ctx?\n(if (ctx? x) (if (atom y) ‘t (if (if (ctx? (car y)) ;; here (equal (ctx? (sub x (car y))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (if (ctx? (car y)) ;; here ‘t (ctx? (cdr y))) (equal (if (ctx? (sub x (car y))) ‘t (ctx? (sub x (cdr y)))) 't) 't) 't) ‘t)) 't) if lifting\n(if (ctx? x) (if (atom y) ‘t (if (ctx? (car y)) (if (equal (ctx? (sub x (car y))) 't);; inductive promsing!! (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (equal (if (ctx? (sub x (car y))) ‘t (ctx? (sub x (cdr y)))) 't) 't) (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? (cdr y)) (equal (if (ctx? (sub x (car y))) ‘t (ctx? (sub x (cdr y)))) 't) 't) ‘t)))) 't) inductive promsing\n(if (ctx? x) (if (atom y) ‘t (if (ctx? (car y)) t (if (if (ctx? (cdr y)) (equal (ctx? (sub x (cdr y))) 't) 't) (if (ctx? (cdr y)) (equal (if (ctx? (sub x (car y))) ‘t (ctx? (sub x (cdr y)))) 't) 't) ‘t))) 't) if lifting\n(if (ctx? x) (if (atom y) ‘t (if (ctx? (car y)) t (if (ctx? (cdr y)) (if (equal (ctx? (sub x (cdr y))) 't) ;; inductive promsing!! (equal (if (ctx? (sub x (car y))) ‘t (ctx? (sub x (cdr y)))) ‘t) 't) ‘t))) 't) inductive promsing \u0026 if-same \u0026 if-true\nt (剩下的那一個，就pass，打這個好累)\n發現有許多差不多的前提，用if-nest-A/E或if lifting把他們化簡\n把inductive promise湊出來\n一次化簡或處理一個case\nproof for set?/add-atoms if lifting is our friend.\n(atom case) add-atoms, if-nest-A, (atom a)\n(if (atom a) (if (set? bs) (equal (set? (if (member? a bs) bs (cons a bs))) ‘t) ‘t) (if (if (set? (add-atoms (cdr x) bs)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) ‘t) (if (if (set? bs) (equal (set? (add-atoms (cdr x) bs)) ‘t) ‘t) (if (set? bs) (equal (set? (add-atoms a bs)) ‘t) ‘t) ‘t) ‘t)) if lifting, promise (another claim)\n(if (atom a) (if (set? bs) (equal (if (member? a bs) (set? bs) (set? (cons a bs))) ‘t) ‘t) (if (if (set? (add-atoms (cdr x) bs)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) ‘t) (if (if (set? bs) (equal (set? (add-atoms (cdr x) bs)) ‘t) ‘t) (if (set? bs) (equal (set? (add-atoms a bs)) ‘t) ‘t) ‘t) ‘t)) set?, member?, if-nest-E, if-same, equal, if-same\n(if (atom a) 't (if (if (set? (add-atoms (cdr x) bs)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) ‘t) (if (if (set? bs) (equal (set? (add-atoms (cdr x) bs)) ‘t) ‘t) (if (set? bs) (equal (set? (add-atoms a bs)) ‘t) ‘t) ‘t) ‘t)) if lifting\n(if (atom a) 't (if (if (set? (add-atoms (cdr x) bs)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) ‘t) (if (set? bs) (if (equal (set? (add-atoms (cdr x) bs)) ‘t) (equal (set? (add-atoms a bs)) ‘t) ‘t) 't) ‘t)) if lifting again!!\n(if (atom a) 't (if (set? bs) (if (if (set? (add-atoms (cdr x) bs)) (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) ‘t) (if (equal (set? (add-atoms (cdr x) bs)) ‘t) (equal (set? (add-atoms a bs)) ‘t) ‘t) ‘t) 't)) if lifting\n(if (atom a) 't (if (set? bs) (if (set? (add-atoms (cdr x) bs)) ;;可以用嗎？ (if (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) (if (equal (set? (add-atoms (cdr x) bs)) ‘t) (equal (set? (add-atoms a bs)) ‘t) ‘t) ‘t) (if (equal (set? (add-atoms (cdr x) bs)) ‘t) ;; need a new claim (equal (set? (add-atoms a bs)) ‘t) ‘t)) 't)) (dethm set?/nil (xs) (if (set? xs) ‘t (equal (set? xs) ‘nil))) set?/nil \u0026 set?/t\n(if (atom a) 't (if (set? bs) (if (set? (add-atoms (cdr x) bs)) ;;用!! (if (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) (if (equal ‘t ‘t) (equal (set? (add-atoms a bs)) ‘t) ‘t) ‘t) (if (equal ‘nil ‘t) (equal (set? (add-atoms a bs)) ‘t) ‘t)) 't)) equal\n(if (atom a) 't (if (set? bs) (if (set? (add-atoms (cdr x) bs)) (if (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) (equal (set? (add-atoms a bs)) ‘t) ‘t) t) 't)) add-atoms \u0026 if-nest-E\n(if (atom a) 't (if (set? bs) (if (set? (add-atoms (cdr x) bs)) ;;用!! (if (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) (equal (set? (add-atoms (car x) (add-atoms (cdr x) bs))) ‘t) ‘t) t) 't)) promise\nt 證原本要證的\n(dethm set?/atoms (a) (equal (set? (atoms a)) 't)) 先把(atoms a)換成(add-atoms a ‘())\n(equal (set? (dad-atoms a ‘())) 't)\n要有(set? xs)，才能用set?/add-atoms\nif-true\n(if t (equal (set? (add-atoms a ‘())) 't) t) if-true\n(if (if t t (if (member? (car ‘()) (cdr ‘())) nil (set? (cdr ‘())))) (equal (set? (add-atoms a ‘())) 't) t) (equal t (atom ())\n(if (if (atom ()) t (if (member? (car ‘()) (cdr ‘())) nil (set? (cdr ‘())))) (equal (set? (add-atoms a ‘())) 't) t) set?\n(if (set? ()) (equal (set? (add-atoms a ‘())) 't) t) set?/add-atoms\nt Ch10 different measure \u0026 change the promise (defun rotate (x) (cons (car (car x)) (cons (cdr (car x)) (cdr x)))) (defun align (x) (if (atom x) x (if (atom (car x)) (cons (car x) (align (cdr x))) (align (rotate x))))) (size x) ?? align的長度都一樣，需要別的measure\n(defun wt (x) (if (atom x) '1 (+ (+ (wt (car x)) (wt (car x))) (wt (cdr x))))) measure: (size x) totality claim是\n(if (natp (wt x)) (if (atom x) 't (if (atom (car x)) (\u003c (wt (cdr x)) (wt x)) (\u003c (wt (rotate x)) (wt x)))) 'nil) (dethm natp/wt (x) (equal (natp (wt x)) 't)) (if (natp (size x)) (if (atom x) 't (if (atom (car x)) (\u003c (wt (cdr x)) (wt x)) (\u003c (wt (rotate x)) (wt x)))) 'nil) =\u003e natp/wt\n(if (atom x) 't (if (atom (car x)) (\u003c (wt (cdr x)) (wt x)) (\u003c (wt (rotate x)) (wt x)))) =\u003e wt\n(if (atom x) 't (if (atom (car x)) (\u003c (wt (cdr x)) (+ (+ (wt (car x)) (wt (car x))) (wt (cdr x)))) (\u003c (wt (rotate x)) (wt x)))) =\u003e if-true, natp/wt\n(if (atom x) 't (if (atom (car x)) (if (natp (wt (cdr x))) (\u003c (wt (cdr x)) (+ (+ (wt (car x)) (wt (car x))) (wt (cdr x)))) t) (\u003c (wt (rotate x)) (wt x)))) =\u003e identity-+, common-addends-\u003c\n(if (atom x) 't (if (atom (car x)) (if (natp (wt (cdr x))) (\u003c 0 (+ (wt (car x)) (wt (car x))))) t) (\u003c (wt (rotate x)) (wt x)))) =\u003e change promise (natp (wt (cdr x))) -\u003e t -\u003e (equal (\u003c ‘0 (wt x))) t)\n(if (atom x) 't (if (atom (car x)) (if (\u003c ‘0 (wt (car x)))) (\u003c 0 (+ (wt (car x)) (wt (car x))))) t) (\u003c (wt (rotate x)) (wt x)))) =\u003e positive-+\n(e04, 後面的很長，pass)\n最後還有一個align/align，但就是之前的綜合體，不過歸納template要自己生，至於證明就不展開了太長了!!\n(defun align (x) (if (atom x) x (if (atom (car x)) (cons (car x) (align (cdr x))) (align (rotate x))))) (dethm align/align (x) (equal (align (align x)) (align x))) (if (atom x) (equal (align (align x)) (align x)) (if (atom (car x)) (if (equal (align (align (cdr x))) (align (cdr x))) (equal (align (align x)) (align x)) 't) (if (equal (align (align (rotate x))) (align (rotate x))) (equal (align (align x)) (align x)) 't))) J-Bob TODO\n有時間會補!!\n","wordCount":"3157","inLanguage":"en","datePublished":"2021-07-14T00:30:09Z","dateModified":"2021-07-14T00:30:09Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2021/07/the-little-prover-%E7%AD%86%E8%A8%98/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">The little prover 筆記</h1><div class=post-meta><span title='2021-07-14 00:30:09 +0000 UTC'>July 14, 2021</span>&nbsp;·&nbsp;15 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%8b%95%e6%a9%9f aria-label=動機>動機</a></li><li><a href=#keyword aria-label=keyword>keyword</a></li><li><a href=#axioms aria-label=axioms>axioms</a></li><li><a href=#%e6%80%8e%e9%ba%bc%e7%94%a8theorem aria-label=怎麼用theorem>怎麼用theorem</a></li><li><a href=#%e8%a6%81total%e6%89%8d%e8%a1%8cpartial-function aria-label="要total才行，partial function">要total才行，partial function</a></li><li><a href=#measure aria-label=measure>measure</a></li><li><a href=#if-lifting aria-label="If Lifting">If Lifting</a></li><li><a href=#%e5%81%9atotality-claims aria-label="做Totality Claims">做Totality Claims</a></li><li><a href=#%e5%81%9ainduction-template aria-label="做induction template">做induction template</a><ul><li><a href=#proof-by-list-induction aria-label="Proof by List Induction">Proof by List Induction</a></li><li><a href=#proof-by-star-induction aria-label="Proof by Star Induction">Proof by Star Induction</a></li></ul></li><li><a href=#insights aria-label=Insights>Insights</a><ul><li><a href=#%e9%81%b8%e5%a5%bd%e5%81%9a%e7%9a%84 aria-label=選好做的>選好做的</a></li><li><a href=#insight-rewrite-from-the-inside-out aria-label="Insight: Rewrite from the Inside Out">Insight: Rewrite from the Inside Out</a></li><li><a href=#insight-pull-ifs-outward aria-label="Insight: Pull Ifs Outward">Insight: Pull Ifs Outward</a></li><li><a href=#insight-keep-theorems-in-mind aria-label="Insight: Keep Theorems in Mind">Insight: Keep Theorems in Mind</a></li><li><a href=#insight-dont-touch-inductive-premises aria-label="Insight: Don’t Touch Inductive Premises">Insight: Don’t Touch Inductive Premises</a></li><li><a href=#insight-combine-ifs aria-label="Insight: Combine Ifs">Insight: Combine Ifs</a></li><li><a href=#insight-create-helpers-for-induction aria-label="Insight: Create Helpers for Induction">Insight: Create Helpers for Induction</a></li><li><a href=#insight-create-helpers-for-repetition aria-label="Insight: Create Helpers for Repetition">Insight: Create Helpers for Repetition</a></li></ul></li><li><a href=#proof-for-membremb aria-label="proof for memb?/remb">proof for memb?/remb</a></li><li><a href=#proof-for-ctxsub aria-label="proof for ctx?/sub">proof for ctx?/sub</a></li><li><a href=#proof-for-setadd-atoms aria-label="proof for set?/add-atoms">proof for set?/add-atoms</a></li><li><a href=#ch10-different-measure--change-the-promise aria-label="Ch10 different measure & change the promise">Ch10 different measure & change the promise</a></li><li><a href=#j-bob aria-label=J-Bob>J-Bob</a></li></ul></div></details></div><div class=post-content><h2 id=動機>動機<a hidden class=anchor aria-hidden=true href=#動機>#</a></h2><p>久遠筆記搬到github這裡，不過也是改寫超多東西的</p><h2 id=keyword>keyword<a hidden class=anchor aria-hidden=true href=#keyword>#</a></h2><p>premise，在if的條件有可以用在想改寫的東西</p><p>theorem，永遠為true的expression (要證過)</p><p>axiom，不用證明的theorem</p><p>claim，還沒證的theorem</p><p>defun，函數，但應該當成類似macro的東西</p><p>total，不論什麼參數都會有值的函數</p><h2 id=axioms>axioms<a hidden class=anchor aria-hidden=true href=#axioms>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>equal-same</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>x</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>equal-swap</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>y</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>equal-if</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>if-true</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=ss>&#39;t</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>if-false</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=ss>&#39;nil</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>if-same</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=nv>x</span> <span class=nv>y</span> <span class=nv>y</span><span class=p>)</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>if-nest-A</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=nv>x</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>)</span> <span class=nv>y</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>if-nest-E</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=nv>x</span> <span class=ss>&#39;t</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=nv>x</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>)</span> <span class=nv>z</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>atom/cons</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nc>cons</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>car/cons</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nc>cons</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>cons/car+cdr</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;t</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>cdr/cons</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>cdr</span> <span class=p>(</span><span class=nc>cons</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=nv>y</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>natp/size</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>size/car</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;t</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>size</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>size/cdr</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;t</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>size</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>identity-+</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>+</span> <span class=mi>0</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>x</span><span class=p>)</span> <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>commute-+</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>y</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>associate+</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=nv>z</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>positives+</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=mi>0</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=mi>0</span> <span class=nv>y</span><span class=p>)</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=mi>0</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span> <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>natp+</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=nv>y</span><span class=p>)</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span> <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span>  <span class=nv>common-addends-&lt;</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>x</span> <span class=nv>z</span><span class=p>)</span> <span class=p>(</span><span class=nf>+</span> <span class=nv>y</span> <span class=nv>z</span><span class=p>))</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=怎麼用theorem>怎麼用theorem<a hidden class=anchor aria-hidden=true href=#怎麼用theorem>#</a></h2><p>要改寫用的equal只能在if-answer或if-else，同時該equal不能出現在if-question或function call的參數中．</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>??</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>A</span> <span class=nv>x</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>B</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>F1</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>F2</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;2</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>C</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>F3</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>F4</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;4</span><span class=p>))))</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nc>cons</span> <span class=ss>&#39;gyre</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>C</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>callooh</span> <span class=nv>callay</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nc>cons</span> <span class=ss>&#39;gimble</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>A</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>callooh</span> <span class=nv>callay</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nc>cons</span> <span class=ss>&#39;1</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>outgrabe</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nc>cons</span> <span class=ss>&#39;3</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>wabe</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nv>F4</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>callooh</span> <span class=nv>callay</span><span class=p>))</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>vorpal</span><span class=p>))))</span>
</span></span></code></pre></div><p>試著用??來改寫這個式子．</p><p><code>(F4 '(callooh callay))</code>能被改寫成’4嗎？</p><p>有C的前提，同時該位置也在if-else，但是沒有A的前提，所以不行．</p><p>那1與3可以改寫成(F1 …)與(F2 …)嗎？</p><p>可以！！</p><p>A與C的前提都有，同時都在相對應的位置上，所以可以．</p><h2 id=要total才行partial-function>要total才行，partial function<a hidden class=anchor aria-hidden=true href=#要total才行partial-function>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>partial</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>         <span class=ss>&#39;nil</span>
</span></span><span class=line><span class=cl>         <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p><code>(dethm contradiction () 'nil)</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=err>‘</span><span class=no>nil</span>
</span></span></code></pre></div><p>-> if-same</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span> <span class=no>nil</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> if-nest-A (enlarge</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=err>‘</span><span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> if-nest-E (enlarge</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span> <span class=no>t</span> <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><p>-> expand(use) (partial x) (self-reference)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>partial</span> <span class=nv>x</span><span class=p>)</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span> <span class=no>t</span> <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><p>-> if-nest-A & if-nest-E (shrink</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=o>....</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=no>nil</span> <span class=no>nil</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=no>t</span> <span class=no>t</span> <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><p>-> t</p><h2 id=measure>measure<a hidden class=anchor aria-hidden=true href=#measure>#</a></h2><p>measure，追蹤某個參數的長度 (證明遞迴會收斂)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sub</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>y</span> <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>x</span>
</span></span><span class=line><span class=cl>        <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=nv>measure:</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>y</span><span class=p>)</span>
</span></span></code></pre></div><p>totality claim</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>size</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=if-lifting>If Lifting<a hidden class=anchor aria-hidden=true href=#if-lifting>#</a></h2><p><code>(A (if x y z)) -> (if x (A y) (A z))</code></p><pre tabindex=0><code>(ctx
    (focus
      (if Q A E)))
</code></pre><p>=> if-same</p><pre tabindex=0><code>(ctx
  (if Q
    (focus
        (if Q A E))
    (focus
        (if Q A E))))
</code></pre><p>=> if-next-A&amp;E</p><pre tabindex=0><code>(ctx
  (if Q
    (focus
         A)
    (focus
         E)))
</code></pre><h2 id=做totality-claims>做Totality Claims<a hidden class=anchor aria-hidden=true href=#做totality-claims>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>add-atoms</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>ys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>member?</span> <span class=nv>x</span> <span class=nv>ys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nv>ys</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nc>cons</span> <span class=nv>x</span> <span class=nv>ys</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>))))</span>
</span></span></code></pre></div><p>基本上就是把每一次遞迴所apply的參數，apply到measure去，同時寫下這次遞迴比原本的measure小</p><ol><li>針對每個case建分支</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span><span class=p>)</span>
</span></span></code></pre></div><ol start=2><li>找自己的遞迴，沒有的直接換成&rsquo;t</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>        <span class=o>...</span><span class=p>)</span>
</span></span></code></pre></div><ol start=3><li>從第一個遞迴開始轉成measure，measure參數代此遞迴的參數，如果不只一個就用if包起來</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>size</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>size</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=no>nil</span><span class=p>))</span>
</span></span></code></pre></div><ol start=4><li>最後用natp包起來(證明size是自然數)</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>size</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>size</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;nil</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=做induction-template>做induction template<a hidden class=anchor aria-hidden=true href=#做induction-template>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>set?</span> <span class=p>(</span><span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>member?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;nil</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>add-atoms</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>ys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>member?</span> <span class=nv>x</span> <span class=nv>ys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nv>ys</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nc>cons</span> <span class=nv>x</span> <span class=nv>ys</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>set?/add-atoms</span> <span class=p>(</span><span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=o>&#39;</span><span class=p>()))</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><ol><li>把所有東西參數化</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><ol start=2><li>分析裡面的參數，讓他在所有情況下都會成立</li></ol><p>先從bs開始，因為在add-atoms裡面他沒有涉及到遞迴的部分，比較簡單</p><p>要怎麼讓<code>(equal (set? (add-atoms a bs)) 't)</code>成立?
bs要讓set?為&rsquo;t</p><ol start=2><li>讓主體的前提滿足</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>只要有bs都會有這一段，等一下還會看到很多次</p><p>接著是a，他有兩個case</p><p>atom，沒有遞迴，直接抄前面的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span><span class=p>)</span>
</span></span></code></pre></div><p>list，有遞迴裡面有遞迴!!
<code>(add-atoms (car x) (add-atoms (cdr x) ys))</code></p><p>先處理最外面的add-atoms，直接把<code>(car x)</code>與<code>(add-atoms (cdr x) ys)</code>當成input，試著讓我們要證的東西成立</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>剛剛是第一個前提，接著是<code>(add-atoms (cdr x) ys)</code>，用同樣的方法</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>這是第二個前提，我們把所有前依據以順序組合在一起(用if)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=o>...</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>)))</span>
</span></span></code></pre></div><p>最後的&mldr;，就是我們在這個case原本想證的東西</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>)))</span>
</span></span></code></pre></div><p>等等，有些變數對不上啊
其實變數就依據case的變數去改就好，alpha reduction</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>ys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>ys</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>ys</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>ys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>x</span> <span class=nv>ys</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>)))</span>
</span></span></code></pre></div><p>看到這裡，會發現totality claim與induction template的做法其實很像</p><ol><li>分析case</li><li>從被遞迴的input開始，切case</li><li>沒遞迴的case就是滿足其他參數的條件，包好就完成沒遞迴的case</li><li>遞迴的case要從最外層的遞迴一層一層建，建法與沒遞迴的case的結果很像，不過參數要代成遞迴時代入的參數</li><li>把所有前提寫完，就把要證的帶進去，當然要注意其他參數的條件要滿足!!</li></ol><p>這邊附上兩個常見template</p><h3 id=proof-by-list-induction>Proof by List Induction<a hidden class=anchor aria-hidden=true href=#proof-by-list-induction>#</a></h3><p>measure: (size x)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>C</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=nv>Ccdr</span>
</span></span><span class=line><span class=cl>        <span class=nv>C</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=proof-by-star-induction>Proof by Star Induction<a hidden class=anchor aria-hidden=true href=#proof-by-star-induction>#</a></h3><p>measure: (size x)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>C</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=nv>Ccar</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=nv>Ccdr</span>
</span></span><span class=line><span class=cl>            <span class=nv>C</span> 
</span></span><span class=line><span class=cl>            <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><h2 id=insights>Insights<a hidden class=anchor aria-hidden=true href=#insights>#</a></h2><h3 id=選好做的>選好做的<a hidden class=anchor aria-hidden=true href=#選好做的>#</a></h3><p>But some approaches will find a proof faster than others.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>first-of</span> <span class=p>(</span><span class=nc>cons</span> <span class=nv>a</span> <span class=p>(</span><span class=nc>cons</span> <span class=ss>&#39;?</span> <span class=o>&#39;</span><span class=p>())))</span> 
</span></span><span class=line><span class=cl>                  <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>second-of</span> <span class=p>(</span><span class=nc>cons</span> <span class=nv>a</span> <span class=p>(</span><span class=nc>cons</span> <span class=ss>&#39;?</span> <span class=o>&#39;</span><span class=p>())))</span> <span class=nv>?</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><p>如果從second-of開始改寫，會變成’t，就可以if-same再改成’t</p><p>這樣就不用管first-of如何．</p><h3 id=insight-rewrite-from-the-inside-out>Insight: Rewrite from the Inside Out<a hidden class=anchor aria-hidden=true href=#insight-rewrite-from-the-inside-out>#</a></h3><p>從if-ans,if-else, arg來改寫，再apply func，如果真的不行了，再改寫外部．</p><h3 id=insight-pull-ifs-outward>Insight: Pull Ifs Outward<a hidden class=anchor aria-hidden=true href=#insight-pull-ifs-outward>#</a></h3><p>當if被func或其他if包起來時，用if lifting把if拉出來．</p><h3 id=insight-keep-theorems-in-mind>Insight: Keep Theorems in Mind<a hidden class=anchor aria-hidden=true href=#insight-keep-theorems-in-mind>#</a></h3><p>看到可以用的就用，看到很像的，想辦法改寫到可以用．</p><h3 id=insight-dont-touch-inductive-premises>Insight: Don’t Touch Inductive Premises<a hidden class=anchor aria-hidden=true href=#insight-dont-touch-inductive-premises>#</a></h3><p>歸納前提就是重點，不要動</p><p>如果不能用，也許是</p><ol><li>用錯歸納法template了</li><li>需要其他lemma</li></ol><h3 id=insight-combine-ifs>Insight: Combine Ifs<a hidden class=anchor aria-hidden=true href=#insight-combine-ifs>#</a></h3><p>用if lifting把if條件中的if拿出來</p><h3 id=insight-create-helpers-for-induction>Insight: Create Helpers for Induction<a hidden class=anchor aria-hidden=true href=#insight-create-helpers-for-induction>#</a></h3><p>To rewrite the application of a recursive function, prove a separate theorem about the recursive function using induction. Do this if the current proof either does not use induction, or uses induction for a different kind of recursion from the function, or uses induction on different arguments from the application.</p><h3 id=insight-create-helpers-for-repetition>Insight: Create Helpers for Repetition<a hidden class=anchor aria-hidden=true href=#insight-create-helpers-for-repetition>#</a></h3><p>If a proof performs similar sequences of steps over and over, state a theorem that can perform the same rewrite as those steps via the Law of Dethm. Use that theorem in place of the sequence of steps to shorten the proof.</p><h2 id=proof-for-membremb>proof for memb?/remb<a hidden class=anchor aria-hidden=true href=#proof-for-membremb>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>remb</span> <span class=p>(</span><span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=o>&#39;</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>memb?</span> <span class=p>(</span><span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;nil</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>memb?/remb</span> <span class=p>(</span><span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nv>remb</span> <span class=nv>xs</span><span class=p>))</span> <span class=ss>&#39;nil</span><span class=p>))</span>
</span></span></code></pre></div><p>the inductive claim</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nv>remb</span> <span class=nv>xs</span><span class=p>))</span> <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)))</span> <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nv>remb</span> <span class=nv>xs</span><span class=p>))</span> <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>先從(atom xs)的if-ans開始</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>memb?</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=err>‘</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>            <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span><span class=p>)</span>
</span></span></code></pre></div><p>-> if-nest-A</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>memb?</span> <span class=err>‘</span><span class=p>())</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span><span class=p>)</span>
</span></span></code></pre></div><p>-> expand memb? & atom & if-true</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span><span class=p>)</span>
</span></span></code></pre></div><p>接著是not (atom xs)與(equal (memb? (remb (cdr xs))) nil)</p><p>(equal (memb? (remb xs)) nil)</p><p>-> remb</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>memb?</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>      <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> if-nest-E & if lifting for memb?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>      <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> inductive premise</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=no>nil</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>      <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> memb?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=no>nil</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>nil</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))))</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>)))))))</span>
</span></span><span class=line><span class=cl>      <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> atom/cons & if-false</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=no>nil</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))))</span> <span class=err>‘</span><span class=nv>?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nv>memb?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>xs</span><span class=p>)</span> <span class=p>(</span><span class=nv>remb</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>xs</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>	    <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> car/cons & if-false & cdr/cons & inductive premise</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=o>...</span><span class=p>)</span> <span class=no>nil</span> <span class=no>nil</span><span class=p>)</span> <span class=no>nil</span><span class=p>)</span>
</span></span></code></pre></div><p>-> if-same & equal-same</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=no>t</span>
</span></span></code></pre></div><h2 id=proof-for-ctxsub>proof for ctx?/sub<a hidden class=anchor aria-hidden=true href=#proof-for-ctxsub>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>ctx?</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=nv>x</span> <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>      <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>sub</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>y</span> <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>x</span>
</span></span><span class=line><span class=cl>      <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))))</span>
</span></span></code></pre></div><p>證</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>ctx?/sub</span> <span class=p>(</span><span class=nv>x</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>把body填入templete(有夠噁心的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>先看到有一堆(if (ctx? x)，用if lifting抽出來(這裡就不好用(A (if …)) -> (if (A ….))來理解，要用if-same來做就很直覺)</p><p>同時把if-else的部分用if-same去掉</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>對sub用if-nest-A</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>y</span> <span class=ss>&#39;?</span><span class=p>)</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>if lifting</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span> <span class=c1>;; 可以用這個改寫成’t嗎</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>y</span> <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      	    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>)</span> <span class=c1>;; 不行，(ctx? x)可以是’t以外的東西(total)，也沒定理</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>但ctx?只會回傳’t或’nil而且如果我們有這種定理的話？</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>ctx?/t</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>那就可以改寫了</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=nv>y</span> <span class=ss>&#39;?</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      	    <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>            <span class=err>‘</span><span class=no>t</span><span class=p>))</span> 
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>if-same*2</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=nv>y</span><span class=p>)</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>atom與if-nest-E</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span> <span class=p>(</span><span class=nv>sub</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>ctx?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                              <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                              <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>ctx?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span> <span class=c1>;; here</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span> <span class=c1>;; here</span>
</span></span><span class=line><span class=cl>                      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                      <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                            <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                            <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>if lifting</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span><span class=c1>;; inductive promsing!!</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                                <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                                <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                                    <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                                <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=err>‘</span><span class=no>t</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>inductive promsing</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=no>t</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                                    <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                                    <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                                <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=err>‘</span><span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>if lifting</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=no>t</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>)))</span> <span class=ss>&#39;t</span><span class=p>)</span> <span class=c1>;; inductive promsing!!</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>                                <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>                                <span class=p>(</span><span class=nv>ctx?</span> <span class=p>(</span><span class=nv>sub</span> <span class=nv>x</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>y</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>                          <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=err>‘</span><span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=ss>&#39;t</span><span class=p>)</span>
</span></span></code></pre></div><p>inductive promsing & if-same & if-true</p><pre tabindex=0><code>t
</code></pre><p>(剩下的那一個，就pass，打這個好累)</p><p>發現有許多差不多的前提，用if-nest-A/E或if lifting把他們化簡</p><p>把inductive promise湊出來</p><p>一次化簡或處理一個case</p><h2 id=proof-for-setadd-atoms>proof for set?/add-atoms<a hidden class=anchor aria-hidden=true href=#proof-for-setadd-atoms>#</a></h2><p>if lifting is our friend.</p><p>(atom case) add-atoms, if-nest-A, (atom a)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      	<span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>member?</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                          <span class=nv>bs</span>
</span></span><span class=line><span class=cl>                          <span class=p>(</span><span class=nc>cons</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	      <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	          <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	              <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>if lifting, promise (another claim)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      	<span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>member?</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nc>cons</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	      <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	          <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	              <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>set?, member?, if-nest-E, if-same, equal, if-same</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	          <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	              <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>if lifting</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	          <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	          <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span></code></pre></div><p>if lifting again!!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>if lifting</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=c1>;;可以用嗎？</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span> <span class=c1>;; need a new claim</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>set?/nil</span> <span class=p>(</span><span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>xs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=err>‘</span><span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>xs</span><span class=p>)</span> <span class=err>‘</span><span class=no>nil</span><span class=p>)))</span>
</span></span></code></pre></div><p>set?/nil & set?/t</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=c1>;;用!!</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=err>‘</span><span class=no>t</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=err>‘</span><span class=no>nil</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=err>‘</span><span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>equal</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=nv>bs</span><span class=p>))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>add-atoms & if-nest-E</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=nv>bs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>))</span> <span class=c1>;;用!!</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>               <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>bs</span><span class=p>)))</span> <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=err>‘</span><span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>promise</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=no>t</span>
</span></span></code></pre></div><p>證原本要證的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>set?/atoms</span> <span class=p>(</span><span class=nv>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>atoms</span> <span class=nv>a</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><p>先把<code>(atoms a)</code>換成<code>(add-atoms a ‘())</code></p><p><code>(equal (set? (dad-atoms a ‘())) 't)</code></p><p>要有<code>(set? xs)</code>，才能用set?/add-atoms</p><p>if-true</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=err>‘</span><span class=p>()))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><p>if-true</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>member?</span> <span class=p>(</span><span class=nf>car</span> <span class=err>‘</span><span class=p>())</span> <span class=p>(</span><span class=nf>cdr</span> <span class=err>‘</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>            <span class=no>nil</span>
</span></span><span class=line><span class=cl>	          <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=err>‘</span><span class=p>()))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=err>‘</span><span class=p>()))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><p><code>(equal t (atom ())</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=no>t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>member?</span> <span class=p>(</span><span class=nf>car</span> <span class=err>‘</span><span class=p>())</span> <span class=p>(</span><span class=nf>cdr</span> <span class=err>‘</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>            <span class=no>nil</span>
</span></span><span class=line><span class=cl>	          <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nf>cdr</span> <span class=err>‘</span><span class=p>()))))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=err>‘</span><span class=p>()))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><p>set?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>set?</span> <span class=p>(</span><span class=nv>add-atoms</span> <span class=nv>a</span> <span class=err>‘</span><span class=p>()))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=no>t</span><span class=p>)</span>
</span></span></code></pre></div><p>set?/add-atoms</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=no>t</span>
</span></span></code></pre></div><h2 id=ch10-different-measure--change-the-promise>Ch10 different measure & change the promise<a hidden class=anchor aria-hidden=true href=#ch10-different-measure--change-the-promise>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>rotate</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>cdr</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>align</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>x</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>)</span> <span class=nv>??</span>
</span></span></code></pre></div><p>align的長度都一樣，需要別的measure</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>wt</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=ss>&#39;1</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>measure:</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>)</span>
</span></span></code></pre></div><p>totality claim是</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>natp/wt</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>     <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>size</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;nil</span><span class=p>)</span>
</span></span></code></pre></div><p>=> natp/wt</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))))</span>
</span></span></code></pre></div><p>=> wt</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)))</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))))</span>
</span></span></code></pre></div><p>=> if-true, natp/wt</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)))</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>            <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))))</span>
</span></span></code></pre></div><p>=> identity-+, common-addends-&lt;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nv>natp</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=mi>0</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>            <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))))</span>
</span></span></code></pre></div><p>=> change promise (natp (wt (cdr x))) -> t -> (equal (&lt; ‘0 (wt x))) t)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=ss>&#39;t</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>&lt;</span> <span class=err>‘</span><span class=mi>0</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>&lt;</span> <span class=mi>0</span> <span class=p>(</span><span class=nf>+</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>            <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>&lt;</span> <span class=p>(</span><span class=nv>wt</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>wt</span> <span class=nv>x</span><span class=p>))))</span>
</span></span></code></pre></div><p>=> positive-+</p><p>(e04, 後面的很長，pass)</p><p>最後還有一個align/align，但就是之前的綜合體，不過歸納template要自己生，至於證明就不展開了太長了!!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>align</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>x</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nc>cons</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>)</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dethm</span> <span class=nv>align/align</span> <span class=p>(</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=kt>atom</span> <span class=p>(</span><span class=nf>car</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nf>cdr</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>))</span> <span class=ss>&#39;t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>if</span> <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>)))</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>rotate</span> <span class=nv>x</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>equal</span> <span class=p>(</span><span class=nv>align</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>))</span> <span class=p>(</span><span class=nv>align</span> <span class=nv>x</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=ss>&#39;t</span><span class=p>)))</span>
</span></span></code></pre></div><h2 id=j-bob>J-Bob<a hidden class=anchor aria-hidden=true href=#j-bob>#</a></h2><p>TODO</p><p>有時間會補!!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://littlebees.github.io/tags/lisp/>Lisp</a></li></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2021/07/leetcode-1-two-sum/><span class=title>« Prev</span><br><span>leetcode-1 - Two Sum</span>
</a><a class=next href=https://littlebees.github.io/2021/07/kmp-algorithm/><span class=title>Next »</span><br><span>kmp-algorithm</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>