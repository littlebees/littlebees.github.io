<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>monad推導，主要是cont monad | 記事本</title>
<meta name=keywords content><meta name=description content="把參數藏起來 把acc藏起來看看
(define (sum l acc) (if (null? l) acc (sum (cdr l) (+ acc (car l))))) delay 要藏的變數 (define (sum1 l) (lambda (acc) (if (null? l) acc ((sum2 (cdr l)) (+ (car l) acc))))) 把lambda推到if的兩項 (define (sum2 l) (if (null? l) (lambda (acc) acc) (lambda (acc) ((sum2 (cdr l)) (+ (car l) acc))))) 抽出遞迴的part (define (sum3 l) (if (null? l) (lambda (acc) acc) (let ((m (sum3 (cdr l)))) (lambda (acc) (m (+ (car l) acc)))))) 把運算抽出來，並把delay的變數塞回去 (define (sum4."><meta name=author content="zhengcf"><link rel=canonical href=https://littlebees.github.io/2020/05/monad%E6%8E%A8%E5%B0%8E%E4%B8%BB%E8%A6%81%E6%98%AFcont-monad/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://littlebees.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://littlebees.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://littlebees.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://littlebees.github.io/apple-touch-icon.png><link rel=mask-icon href=https://littlebees.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="monad推導，主要是cont monad"><meta property="og:description" content="把參數藏起來 把acc藏起來看看
(define (sum l acc) (if (null? l) acc (sum (cdr l) (+ acc (car l))))) delay 要藏的變數 (define (sum1 l) (lambda (acc) (if (null? l) acc ((sum2 (cdr l)) (+ (car l) acc))))) 把lambda推到if的兩項 (define (sum2 l) (if (null? l) (lambda (acc) acc) (lambda (acc) ((sum2 (cdr l)) (+ (car l) acc))))) 抽出遞迴的part (define (sum3 l) (if (null? l) (lambda (acc) acc) (let ((m (sum3 (cdr l)))) (lambda (acc) (m (+ (car l) acc)))))) 把運算抽出來，並把delay的變數塞回去 (define (sum4."><meta property="og:type" content="article"><meta property="og:url" content="https://littlebees.github.io/2020/05/monad%E6%8E%A8%E5%B0%8E%E4%B8%BB%E8%A6%81%E6%98%AFcont-monad/"><meta property="og:image" content="https://littlebees.github.io/images/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-04T23:53:58+00:00"><meta property="article:modified_time" content="2020-05-04T23:53:58+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://littlebees.github.io/images/papermod-cover.png"><meta name=twitter:title content="monad推導，主要是cont monad"><meta name=twitter:description content="把參數藏起來 把acc藏起來看看
(define (sum l acc) (if (null? l) acc (sum (cdr l) (+ acc (car l))))) delay 要藏的變數 (define (sum1 l) (lambda (acc) (if (null? l) acc ((sum2 (cdr l)) (+ (car l) acc))))) 把lambda推到if的兩項 (define (sum2 l) (if (null? l) (lambda (acc) acc) (lambda (acc) ((sum2 (cdr l)) (+ (car l) acc))))) 抽出遞迴的part (define (sum3 l) (if (null? l) (lambda (acc) acc) (let ((m (sum3 (cdr l)))) (lambda (acc) (m (+ (car l) acc)))))) 把運算抽出來，並把delay的變數塞回去 (define (sum4."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://littlebees.github.io/posts/"},{"@type":"ListItem","position":2,"name":"monad推導，主要是cont monad","item":"https://littlebees.github.io/2020/05/monad%E6%8E%A8%E5%B0%8E%E4%B8%BB%E8%A6%81%E6%98%AFcont-monad/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"monad推導，主要是cont monad","name":"monad推導，主要是cont monad","description":"把參數藏起來 把acc藏起來看看\n(define (sum l acc) (if (null? l) acc (sum (cdr l) (+ acc (car l))))) delay 要藏的變數 (define (sum1 l) (lambda (acc) (if (null? l) acc ((sum2 (cdr l)) (+ (car l) acc))))) 把lambda推到if的兩項 (define (sum2 l) (if (null? l) (lambda (acc) acc) (lambda (acc) ((sum2 (cdr l)) (+ (car l) acc))))) 抽出遞迴的part (define (sum3 l) (if (null? l) (lambda (acc) acc) (let ((m (sum3 (cdr l)))) (lambda (acc) (m (+ (car l) acc)))))) 把運算抽出來，並把delay的變數塞回去 (define (sum4.","keywords":[],"articleBody":"把參數藏起來 把acc藏起來看看\n(define (sum l acc) (if (null? l) acc (sum (cdr l) (+ acc (car l))))) delay 要藏的變數 (define (sum1 l) (lambda (acc) (if (null? l) acc ((sum2 (cdr l)) (+ (car l) acc))))) 把lambda推到if的兩項 (define (sum2 l) (if (null? l) (lambda (acc) acc) (lambda (acc) ((sum2 (cdr l)) (+ (car l) acc))))) 抽出遞迴的part (define (sum3 l) (if (null? l) (lambda (acc) acc) (let ((m (sum3 (cdr l)))) (lambda (acc) (m (+ (car l) acc)))))) 把運算抽出來，並把delay的變數塞回去 (define (sum4.5 l) (if (null? l) (lambda (acc) acc) (let ((m (sum4 (cdr l))) (f (lambda (acc) (+ (car l) acc)))) ;; maybe use -(minus), i could spot out this error (lambda (acc) (f (m acc)))))) ;; recursive ;; 這邊變成了先遞迴，等回來再做f ;; 當初自己推導是先寫出這個的!! WHYYYYY (define (sum4 l) (if (null? l) (lambda (acc) acc) (let ((m (sum4 (cdr l))) (f (lambda (acc) (+ (car l) acc)))) (lambda (acc) (m (f acc)))))) ;; iterative 番外篇: 左右遞迴 (define (sub4 l) (if (null? l) (lambda (acc) acc) (let ((m (sub4 (cdr l))) (f (lambda (acc) (- (car l) acc)))) (lambda (acc) (m (f acc)))))) ;; iterative, foldl (define (sub5 l) (if (null? l) (lambda (acc) acc) (let ((m (sub5 (cdr l))) (f (lambda (acc) (- (car l) acc)))) (lambda (acc) (f (m acc)))))) ;; recursive, foldr ((sub4 '(2 3 1 4)) 6) =\u003e 10 2 - 6 = -4 3 - -4 = 7 1 - 7 = -6 4 - -6 = 10 ((sub5 '(2 3 1 4)) 6) =\u003e 2 4 - 6 = -2 1 - -2 = 3 3 - 3 = 0 2 - 0 = 2 藏 continuation 現在用同樣的方式藏continuation\n(define (sum-k l k) (if (null? l) (k 0) (sum-k (cdr l) (lambda (ret) (k (+ (car l) ret)))))) (define (sum-k2 l) (if (null? l) (lambda (k) (k 0)) (lambda (k) ((sum-k2 (cdr l)) (lambda (ret) (k (+ (car l) ret))))))) (define (sum-k3 l) (if (null? l) (lambda (k) (k 0)) (let ((m (sum-k3 (cdr l)))) (lambda (k) (m (lambda (ret) (k (+ (car l) ret)))))))) (define (sum-k4 l) (if (null? l) (lambda (k) (k 0)) (let ((m (sum-k3 (cdr l))) (f (lambda (ret) (lambda (k) (k (+ (car l) ret)))))) (lambda (k) ((m f) k))))) ;; NOOOOO!!! f should contains k before m (define (sum-k4 l) (if (null? l) (lambda (k) (k 0)) (let ((m (sum-k4 (cdr l))) (f (lambda (ret) (lambda (k) (k (+ (car l) ret)))))) (lambda (k) (m (lambda (v) ((f v) k)))))) cont monad (define (bind m f) (lambda (k) (m (lambda (v) ((f v) k))))) (define (return v) (lambda (k) (k v))) (define (sum' l) (callcc (lambda (exit) (cond ((null? l) (return 0)) (else (bind (sum' (cdr l)) (lambda (ret) (lambda (k) (k (+ ret (car l))))))))))) callcc (define (callcc f) (λ (k) ((f (λ (ret) ;; 要跳出去時，會先收到值 (λ (_) ;; 原本接下來要做的事 (k ret)))) ;; 直接用之前的 k))) ;; 用之前的 ","wordCount":"472","inLanguage":"en","datePublished":"2020-05-04T23:53:58Z","dateModified":"2020-05-04T23:53:58Z","author":{"@type":"Person","name":"zhengcf"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://littlebees.github.io/2020/05/monad%E6%8E%A8%E5%B0%8E%E4%B8%BB%E8%A6%81%E6%98%AFcont-monad/"},"publisher":{"@type":"Organization","name":"記事本","logo":{"@type":"ImageObject","url":"https://littlebees.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://littlebees.github.io/ accesskey=h title="記事本 (Alt + H)">記事本</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://littlebees.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://littlebees.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://littlebees.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://littlebees.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://littlebees.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">monad推導，主要是cont monad</h1><div class=post-meta><span title='2020-05-04 23:53:58 +0000 UTC'>May 4, 2020</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;zhengcf</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e6%8a%8a%e5%8f%83%e6%95%b8%e8%97%8f%e8%b5%b7%e4%be%86 aria-label=把參數藏起來>把參數藏起來</a><ul><li><a href=#%e7%95%aa%e5%a4%96%e7%af%87-%e5%b7%a6%e5%8f%b3%e9%81%9e%e8%bf%b4 aria-label="番外篇: 左右遞迴">番外篇: 左右遞迴</a></li></ul></li><li><a href=#%e8%97%8f-continuation aria-label="藏 continuation">藏 continuation</a></li><li><a href=#cont-monad aria-label="cont monad">cont monad</a><ul><li><a href=#callcc aria-label=callcc>callcc</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=把參數藏起來>把參數藏起來<a hidden class=anchor aria-hidden=true href=#把參數藏起來>#</a></h2><p>把acc藏起來看看</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum</span> <span class=nv>l</span> <span class=nv>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>acc</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>sum</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)</span> <span class=p>(</span><span class=nb>+ </span><span class=nv>acc</span> <span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)))))</span>
</span></span></code></pre></div><ol start=0><li>delay 要藏的變數</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum1</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=nv>acc</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nf>sum2</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)))))</span>
</span></span></code></pre></div><ol><li>把lambda推到if的兩項</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum2</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nf>sum2</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)))))</span>
</span></span></code></pre></div><ol start=2><li>抽出遞迴的part</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum3</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sum3</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>m</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>acc</span><span class=p>))))))</span>
</span></span></code></pre></div><ol start=3><li>把運算抽出來，並把delay的變數塞回去</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum4</span><span class=o>.</span><span class=mi>5</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sum4</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>acc</span><span class=p>))))</span> <span class=c1>;; maybe use -(minus), i could spot out this error</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=nf>m</span> <span class=nv>acc</span><span class=p>))))))</span>   <span class=c1>;; recursive</span>
</span></span><span class=line><span class=cl><span class=c1>;; 這邊變成了先遞迴，等回來再做f</span>
</span></span><span class=line><span class=cl><span class=c1>;; 當初自己推導是先寫出這個的!! WHYYYYY</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum4</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sum4</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>acc</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>m</span> <span class=p>(</span><span class=nf>f</span> <span class=nv>acc</span><span class=p>))))))</span> <span class=c1>;; iterative</span>
</span></span></code></pre></div><h3 id=番外篇-左右遞迴>番外篇: 左右遞迴<a hidden class=anchor aria-hidden=true href=#番外篇-左右遞迴>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sub4</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sub4</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=p>(</span><span class=nb>- </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>acc</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>m</span> <span class=p>(</span><span class=nf>f</span> <span class=nv>acc</span><span class=p>))))))</span> <span class=c1>;; iterative, foldl</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sub5</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=nv>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sub5</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span> <span class=p>(</span><span class=nb>- </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>acc</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>acc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=nf>m</span> <span class=nv>acc</span><span class=p>))))))</span> <span class=c1>;; recursive, foldr </span>
</span></span></code></pre></div><pre tabindex=0><code>((sub4 &#39;(2 3 1 4)) 6)
=&gt; 10
2 - 6 = -4
3 - -4 = 7
1 - 7 = -6
4 - -6 = 10

((sub5 &#39;(2 3 1 4)) 6)
=&gt; 2
4 - 6 = -2
1 - -2 = 3
3 - 3 = 0
2 - 0 = 2
</code></pre><h2 id=藏-continuation>藏 continuation<a hidden class=anchor aria-hidden=true href=#藏-continuation>#</a></h2><p>現在用同樣的方式藏continuation</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum-k</span> <span class=nv>l</span> <span class=nv>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>k</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nf>sum-k</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>           <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>k</span> <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>ret</span><span class=p>))))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum-k2</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>k</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>((</span><span class=nf>sum-k2</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>              <span class=p>(</span><span class=nf>k</span> <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>ret</span><span class=p>)))))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum-k3</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>k</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sum-k3</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>m</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>k</span> <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>ret</span><span class=p>))))))))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum-k4</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>k</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sum-k3</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>k</span> <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>ret</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>((</span><span class=nf>m</span> <span class=nv>f</span><span class=p>)</span> <span class=nv>k</span><span class=p>)))))</span> <span class=c1>;; NOOOOO!!! f should contains k before m</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum-k4</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=k>if </span><span class=p>(</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>k</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>let </span><span class=p>((</span><span class=nf>m</span> <span class=p>(</span><span class=nf>sum-k4</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>f</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=nf>k</span> <span class=p>(</span><span class=nb>+ </span><span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)</span> <span class=nv>ret</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>m</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>v</span><span class=p>)</span> <span class=p>((</span><span class=nf>f</span> <span class=nv>v</span><span class=p>)</span> <span class=nv>k</span><span class=p>))))))</span>
</span></span></code></pre></div><h2 id=cont-monad>cont monad<a hidden class=anchor aria-hidden=true href=#cont-monad>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>bind</span> <span class=nv>m</span> <span class=nv>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nf>m</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>v</span><span class=p>)</span> <span class=p>((</span><span class=nf>f</span> <span class=nv>v</span><span class=p>)</span> <span class=nv>k</span><span class=p>)))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>return</span> <span class=nv>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span> <span class=p>(</span><span class=nf>k</span> <span class=nv>v</span><span class=p>)))</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>sum</span><span class=o>&#39;</span> <span class=nv>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>callcc</span> <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>exit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nf>cond</span>
</span></span><span class=line><span class=cl>        <span class=p>((</span><span class=nb>null? </span><span class=nv>l</span><span class=p>)</span> <span class=p>(</span><span class=nf>return</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=k>else </span><span class=p>(</span><span class=nf>bind</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=nf>sum</span><span class=o>&#39;</span> <span class=p>(</span><span class=nb>cdr </span><span class=nv>l</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=k>lambda </span><span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=p>(</span><span class=nf>k</span> <span class=p>(</span><span class=nb>+ </span><span class=nv>ret</span> <span class=p>(</span><span class=nb>car </span><span class=nv>l</span><span class=p>)))))))))))</span>
</span></span></code></pre></div><h3 id=callcc>callcc<a hidden class=anchor aria-hidden=true href=#callcc>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=k>define </span><span class=p>(</span><span class=nf>callcc</span> <span class=nv>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>λ</span> <span class=p>(</span><span class=nf>k</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>((</span><span class=nf>f</span> <span class=p>(</span><span class=nf>λ</span> <span class=p>(</span><span class=nf>ret</span><span class=p>)</span> <span class=c1>;; 要跳出去時，會先收到值</span>
</span></span><span class=line><span class=cl>          <span class=p>(</span><span class=nf>λ</span> <span class=p>(</span><span class=nf>_</span><span class=p>)</span> <span class=c1>;; 原本接下來要做的事</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=nf>k</span> <span class=nv>ret</span><span class=p>))))</span> <span class=c1>;; 直接用之前的</span>
</span></span><span class=line><span class=cl>     <span class=nv>k</span><span class=p>)))</span> <span class=c1>;; 用之前的</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://littlebees.github.io/2020/05/%E6%9C%89%E8%B6%A3%E8%88%87%E6%9C%89%E7%94%A8%E7%9A%84es6%E7%89%B9%E6%80%A7/><span class=title>« Prev</span><br><span>有趣與有用的es6特性</span>
</a><a class=next href=https://littlebees.github.io/2020/04/js%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5%E7%9A%84%E6%95%B4%E7%90%86/><span class=title>Next »</span><br><span>JS一些概念的整理</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://littlebees.github.io/>記事本</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>